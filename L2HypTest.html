

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hypothesis testing on one population &#8212; Statistics II</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'L2HypTest';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Statistical inference: Confidence intervals" href="L1ConfInt.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="L0Intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo_uc3m_banner.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo_uc3m_banner.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="L1ConfInt.html">Confidence intervals</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Hypothesis testing for one population</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><span style="color:brown">Hypothesis testing on one population</span></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-contents-span"><span style="color:brown;">Contents</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-introduction-span"><span style="color:brown;">Introduction</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-goals-i-span"><span style="color:brown;">Goals (i)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-goals-ii-span"><span style="color:brown;">Goals (ii)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-hypothesis-tests-span"><span style="color:brown">Hypothesis tests</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-step-1-defining-the-null-and-alternative-hypotheses-span"><span style="color:brown">Step 1. Defining the null and alternative hypotheses</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-green-questions-span"><span style="color:green;">Questions</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-selecting-a-null-hypothesis-for-the-test-span"><span style="color:brown">Selecting a null hypothesis for the test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-red-exercise-span"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-red-exercise-solution-span"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-step-2-comparing-the-evidence-and-the-reference-value-span"><span style="color:brown">Step 2. Comparing the evidence and the reference value</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-preparing-r-and-the-data-span"><span style="color:blue;">Preparing R and the data</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-based-on-selected-data-sets-span"><span style="color:blue;">Examples based on selected data sets</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-selecting-and-displaying-the-data-set-and-the-variable-of-interest-span"><span style="color:blue;">Selecting and displaying the data set and the variable of interest</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-summaries-for-the-sample-data-span"><span style="color:blue;">Summaries for the sample data</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-example-of-evidence-evaluation-for-a-hypothesis-test-span"><span style="color:brown">Example of evidence evaluation for a hypothesis test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-i-span"><span style="color:blue">Numerical example of evidence evaluation (i)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-ii-span"><span style="color:blue">Numerical example of evidence evaluation (ii)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><span style="color:brown">Example of evidence evaluation for a hypothesis test</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-comparing-the-evidence-and-the-reference-value-span"><span style="color:brown">Comparing the evidence and the reference value</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-iii-span"><span style="color:blue">Numerical example of evidence evaluation (iii)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-step-3-evaluating-the-evidence-based-on-test-statistic-values-span"><span style="color:brown">Step 3. Evaluating the evidence based on test statistic values</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-iv-span"><span style="color:blue">Numerical example of evidence evaluation (iv)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-errors-associated-with-a-hypothesis-testing-procedure-span"><span style="color:brown">Errors associated with a hypothesis testing procedure</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-using-the-probabilities-of-the-errors-to-define-critical-values-for-a-test-span"><span style="color:brown">Using the probabilities of the errors to define critical values for a test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><span style="color:green;">Questions</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-v-span"><span style="color:blue">Numerical example of evidence evaluation (v)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-steps-to-conduct-a-hypothesis-testing-procedure-span"><span style="color:brown;">Steps to conduct a hypothesis testing procedure</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-an-illustration-of-the-general-hypothesis-testing-procedure-span"><span style="color:blue;">An illustration of the general hypothesis testing procedure</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-summary-of-a-hypothesis-testing-procedure-span"><span style="color:brown">Summary of a hypothesis testing procedure</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><span style="color:green;">Questions</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-application-of-hypothesis-testing-procedures-span"><span style="color:blue;">Numerical application of hypothesis testing procedures</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-1-define-the-data-to-be-used-for-the-example-span"><span style="color:blue;">1. Define the data to be used for the example</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-2-define-the-type-of-test-that-you-would-like-to-conduct-span"><span style="color:blue;">2. Define the type of test that you would like to conduct</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-3-perform-the-required-calculations-for-the-test-span"><span style="color:blue;">3. Perform the required calculations for the test</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-the-errors-in-a-hypothesis-test-span"><span style="color:brown">The errors in a hypothesis test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-for-type-i-errors-span"><span style="color:blue;">Numerical example for type I errors</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-for-type-ii-errors-span"><span style="color:blue;">Numerical example for type II errors</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-the-power-function-of-a-test-span"><span style="color:brown">The power function of a test</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-computing-the-power-of-a-test-span"><span style="color:brown">Computing the power of a test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><span style="color:green;">Questions</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-of-power-functions-span"><span style="color:blue;">Examples of power functions</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-impact-of-the-sample-size-on-the-power-function-of-a-test-span"><span style="color:brown">Impact of the sample size on the power function of a test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-power-functions-and-sample-sizes-span"><span style="color:blue;">Power functions and sample sizes</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-hypothesis-testing-and-data-science-terminology-span"><span style="color:brown">Hypothesis testing and data science terminology</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-appendix-1-power-functions-for-normal-data-span"><span style="color:orange;">Appendix 1: Power functions for normal data</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-computing-the-power-for-the-mean-of-a-normal-population-span"><span style="color:orange;">Computing the power for the mean of a normal population</span></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="span-style-color-brown-hypothesis-testing-on-one-population-span">
<h1><span style="color:brown">Hypothesis testing on one population</span><a class="headerlink" href="#span-style-color-brown-hypothesis-testing-on-one-population-span" title="Permalink to this headline">#</a></h1>
<div class="section" id="span-style-color-brown-contents-span">
<h2><span style="color:brown;">Contents</span><a class="headerlink" href="#span-style-color-brown-contents-span" title="Permalink to this headline">#</a></h2>
<p>This chapter covers the contents from Lesson 2 in the Statistics II subject, <em>“Hypothesis testing in one population”</em>. These contents correspond to the motivation and description of a procedure to reach conclusions for simple questions about population parameters, based on information obtained from a sample. We will refer to this procedure as <span style="color:brown;">hypothesis testing</span> and in this lesson we will consider the case when we only have one population.</p>
<p>These contents are structured as follows:</p>
<ul class="simple">
<li><p>Description of a hypothesis testing procedure</p>
<ul>
<li><p>Definition of the test</p></li>
<li><p>Different types of tests</p></li>
</ul>
</li>
<li><p>Testing errors, significance and power of a test</p>
<ul>
<li><p>Critical region of a test</p></li>
</ul>
</li>
<li><p>Procedure to conduct a hypothesis test</p>
<ul>
<li><p>Application cases for different parameters and assumptions</p></li>
</ul>
</li>
<li><p>P-value of a test</p></li>
<li><p>Relationship between hypothesis tests and confidence intervals</p></li>
<li><p>Computing the power of a test for a true value of the parameter or the sample size for a desired power</p></li>
</ul>
</div>
<div class="section" id="span-style-color-brown-introduction-span">
<h2><span style="color:brown;">Introduction</span><a class="headerlink" href="#span-style-color-brown-introduction-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="section" id="span-style-color-brown-goals-i-span">
<h3><span style="color:brown;">Goals (i)</span><a class="headerlink" href="#span-style-color-brown-goals-i-span" title="Permalink to this headline">#</a></h3>
<p>In Statistics II we are interested in the definition, implementation and understanding of procedures to conduct statistical inference, that is, to extract information from one or several samples, in order to provide relevant knowledge about some parameters of interest in a population.</p>
<p>This knowledge can be generated in many different forms, depending on the specific application and the relevant questions to answer based on the available data. For example, in Lesson 1 we considered the situation where we wanted to obtain a good numerical approximation to the parameter values, as well as information on the error associated to this approximation. In this Lesson we consider how to obtain information about the answers to simple (yes/no) questions on the parameters of interest for one population, based on the sample data.</p>
<p>As we have uncertain information, in the derivation of these procedures we will pay special attention to different means of controlling the probabilities of any unavoidable errors associated to this uncertainty.</p>
</div>
<div class="section" id="span-style-color-brown-goals-ii-span">
<h3><span style="color:brown;">Goals (ii)</span><a class="headerlink" href="#span-style-color-brown-goals-ii-span" title="Permalink to this headline">#</a></h3>
<p>Our learning goals for this lesson are:</p>
<ul class="simple">
<li><p>Know how to formulate and perform a test of hypothesis in a one-population setting</p>
<ul>
<li><p>Know how to formulate the null and alternative hypotheses of the test in an efficient manner,</p></li>
<li><p>And how to apply a procedure to obtain an answer using either critical regions or p-values</p>
<ul>
<li><p>Being able to select a suitable test statistic for the test</p></li>
</ul>
</li>
<li><p>To understand how to interpret the results of a hypothesis test</p></li>
</ul>
</li>
<li><p>To understand the definition and the meaning of Type I and Type II errors, and their impact on hypothesis testing procedures</p>
<ul>
<li><p>Know the definitions of the significance level and the power of a test</p></li>
</ul>
</li>
<li><p>To know how to calculate the power of a test and how to identify a sample size needed to achieve a desired power</p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-brown-hypothesis-tests-span">
<h2><span style="color:brown">Hypothesis tests</span><a class="headerlink" href="#span-style-color-brown-hypothesis-tests-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>We wish to define procedures to answer simple questions about the values of population parameters, based on the information available in an observed random sample. In this lesson we will mostly study how to conduct comparisons between a given parameter and a reference value, based on the observations in the sample. More specifically, these procedures will compare the values of population means, proportions, variances or standard deviations with some specified values of interest for these parameters.</p>
<p>For example, if our variable represents the change in a price, we may be interested in knowing if the mean of this variable is positive, that is, if the price is increasing. Or if our variable represents the voting intentions of individuals, we may be interested in comparing the population proportion of persons willing to vote for a certain party with the value of this proportion that was observed in the last election (based on a sample of voters).</p>
<p>To answer these questions, we will proceed by determining how best to:</p>
<ol class="arabic simple">
<li><p>Provide a <span style="color:brown;">formal representation for the question</span> of interest.</p>
<ul class="simple">
<li><p>We will do this by introducing a mathematical description based on the definition of a null and an alternative hypothesis, corresponding to the true/false answers to this question.</p></li>
<li><p>This description will be based on a mathematical comparison between our parameter and a reference value (<span class="math notranslate nohighlight">\(\theta_0\)</span>).</p></li>
</ul>
</li>
<li><p>Define a way to <span style="color:brown;">compare the information in our sample with a reference value for the parameter.</span></p>
<ul class="simple">
<li><p>This summary will be based on the use of an appropriate <span style="color:brown;">statistic</span> that combines a sample estimate and the reference value into a number.</p></li>
<li><p>The statistic should provide large/small values associated to the true/false answers we have defined.</p></li>
</ul>
</li>
<li><p>Conduct an <span style="color:brown;">evaluation of the evidence based on the value of the statistic</span> to determine if it is sufficiently large/small to answer yes/no to our question.</p>
<ul class="simple">
<li><p>We will define a critical value to define when the statistic value is sufficiently large.</p></li>
<li><p>As the information available (our sample) is uncertain, we will make use of probability information obtained from the (known) distribution of the statistic to define the critical value.</p></li>
<li><p>The probabilities we will use as reference will be defined from the probabilities of the errors we could make when applying this hypothesis testing procedure.</p></li>
</ul>
</li>
</ol>
<div class="section" id="span-style-color-brown-step-1-defining-the-null-and-alternative-hypotheses-span">
<h3><span style="color:brown">Step 1. Defining the null and alternative hypotheses</span><a class="headerlink" href="#span-style-color-brown-step-1-defining-the-null-and-alternative-hypotheses-span" title="Permalink to this headline">#</a></h3>
<p>In hypothesis testing we consider situations where there exist only two outcomes of interest, which we can associate to answering yes/no to a certain question comparing the values of a population parameter to some reference value. The first step in our procedure to conduct these hypothesis tests is to formally define our yes/no question.</p>
<p>The two outcomes for the question will be represented by what we will call our <span style="color:brown">null</span> and <span style="color:brown">alternative hypotheses.</span> And as our main goal is to compare parameter values with some given reference values, these hypotheses will be written in terms of equalities or inequalities relating the parameter of interest and one reference value, for example, one of these hypotheses could take the form <span class="math notranslate nohighlight">\(\theta \geq \theta_0\)</span>. Also, and for the purposes of this lesson, they will always be defined so that the null and alternative hypotheses are given in terms of <span style="color:brown">sets of values of the parameter that are the complement of each other.</span></p>
<p>To illustrate this situation with an example, assume we are studying the population mean of the change in the weekly prices of a certain commodity, and we wish to determine if our sample provides sufficient evidence that the expected value of these weekly changes is larger than <span class="math notranslate nohighlight">\(0.1\)</span>%. Formally, our yes/no question can be written in one of two possible ways:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
H_0 &amp; : &amp; \mu \geq 0.001 = \mu_0 \\
H_1 &amp; : &amp; \mu &lt; 0.001
\end{array} \qquad \mbox{or} \qquad 
\begin{array}{rcl}
H_0 &amp; : &amp; \mu \leq 0.001 = \mu_0 \\
H_1 &amp; : &amp; \mu &gt; 0.001
\end{array}
\end{split}\]</div>
<p>where the population mean <span class="math notranslate nohighlight">\(\mu\)</span> is the parameter of interest, and <span class="math notranslate nohighlight">\(\mu_0 = 0.001\)</span> is our reference value.</p>
<p>In this representation we have introduced several conventions commonly used in hypothesis testing, and that we will maintain throughout this course. Note that these conventions could be modified without significantly changing the basic procedure we will describe below.</p>
<ul class="simple">
<li><p>We denote by <span class="math notranslate nohighlight">\(H_0\)</span> the null hypothesis and by <span class="math notranslate nohighlight">\(H_1\)</span> the alternative hypothesis.</p></li>
<li><p>We indicate each hypothesis as an equality or inequality relating the corresponding population parameter (the population mean in this case) and a reference value.</p></li>
<li><p>We write the null hypothesis including the equality between the parameter and the reference value.</p></li>
<li><p>Both hypotheses define a partition of the values of the parameter, that is, all possible values are covered between both of them, and they have no intersection.</p></li>
</ul>
<p>We now comment on how to choose which one of two representations indicated above is the one we prefer for our hypothesis test. A complication is that the procedure used to conduct the test does not treat both hypotheses as symmetric, that is, if we were to interchange the two hypotheses the results we would obtain would not be equivalent. Thus, the choice of one representation over the other may affect the answer provided by the test.</p>
<p>We may think of the possible outcomes of the test as corresponding to one of three possible alternatives: i) we have enough evidence in favor of <span class="math notranslate nohighlight">\(H_0\)</span>, ii) we have enough evidence in favor of <span class="math notranslate nohighlight">\(H_1\)</span> or iii) we do not have enough evidence in favor of either of the hypotheses. But, although we have these three situations, our procedure will be defined as having only two possible outcomes: either we reject <span class="math notranslate nohighlight">\(H_0\)</span> or we fail to reject it. That is, we do not differentiate between situations where we should reject <span class="math notranslate nohighlight">\(H_1\)</span> and those where we do not have enough evidence to clearly favor any of the two hypotheses.</p>
<p>As a consequence, our conclusion will be based on determining if we have enough evidence to reject <span class="math notranslate nohighlight">\(H_0\)</span>. And if in some case the evidence is not sufficient to reject <span class="math notranslate nohighlight">\(H_0\)</span>, we will not conclude automatically that we can reject <span class="math notranslate nohighlight">\(H_1\)</span>. This implies that <span style="color:brown">our procedure favors <span class="math notranslate nohighlight">\(H_0\)</span>,</span> in the sense that unless we have clear evidence to reject it, we will continue accepting <span class="math notranslate nohighlight">\(H_0\)</span>. This has clear implications for our choice of <span class="math notranslate nohighlight">\(H_0\)</span>, so that if for example we define <span class="math notranslate nohighlight">\(H_0 : \mu \geq 0.001\)</span>, then we will tend to accept this statement is correct unless the observed data has a value of the sample mean clearly smaller than <span class="math notranslate nohighlight">\(0.001\)</span>.</p>
<p>As a summary, <span style="color:brown;">when we do not have sufficent evidence</span> to support any of the two hypotheses, <span style="color:brown;">we give the benefit of the doubt to the null hypothesis, <span class="math notranslate nohighlight">\(H_0\)</span>.</span></p>
<div class="section" id="span-style-color-green-questions-span">
<h4><span style="color:green;">Questions</span><a class="headerlink" href="#span-style-color-green-questions-span" title="Permalink to this headline">#</a></h4>
<p><span style="color:green">Answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">Indicate the null and alternative hypotheses for a test on the population mean where you wish to test if the value of this parameter is larger than 5, based on sample data. Discuss your different alternatives.</span></p></li>
<li><p><span style="color:green">Assume you have been given a test with <span class="math notranslate nohighlight">\(H_0 : p \leq p_0\)</span>. Write down the form of <span class="math notranslate nohighlight">\(H_1\)</span> for this test.</span></p></li>
<li><p><span style="color:green">Given the alternative hypotesis for a test defined as <span class="math notranslate nohighlight">\(H_1 : \sigma &gt; \sigma_0\)</span>, indicate if the null hypothesis would be <span class="math notranslate nohighlight">\(H_0 : \sigma \leq \sigma_0\)</span> or <span class="math notranslate nohighlight">\(H_0 : \sigma = \sigma_0\)</span>.</span></p></li>
<li><p><span style="color:green">If you wish to specify only one of the two hypotheses in a test, which one would be more informative, <span class="math notranslate nohighlight">\(H_0\)</span> or <span class="math notranslate nohighlight">\(H_1\)</span>?</span></p></li>
</ul>
</div>
<div class="section" id="span-style-color-brown-selecting-a-null-hypothesis-for-the-test-span">
<h4><span style="color:brown">Selecting a null hypothesis for the test</span><a class="headerlink" href="#span-style-color-brown-selecting-a-null-hypothesis-for-the-test-span" title="Permalink to this headline">#</a></h4>
<p>Based on our preceding comments on the preference of the procedure to keep <span class="math notranslate nohighlight">\(H_0\)</span>, we present some observations and practical considerations when selecting the null and alternative hypotheses for a test.</p>
<ul class="simple">
<li><p>As an initial observation, the procedure that has been described to conduct a hypothesis test can be applied to any definition of the null and alternative hypotheses, within the cases considered up to this point. In particular, the procedure is the same even if we interchange the null and alternative hypotheses in a test.</p></li>
<li><p>But this procedure introduces an asymmetry between both hypotheses, and the answers we may get depend on the way the test is defined (the way we define <span class="math notranslate nohighlight">\(H_0\)</span>). These answers would be affected if we exchange both hypotheses.</p>
<ul>
<li><p>And some ways to define the null hypothesis may provide answers that are more informative from a practical point of view.</p></li>
</ul>
</li>
</ul>
<p>In some cases we need to define our test (define <span class="math notranslate nohighlight">\(H_0\)</span>) before we observe our sample values, or independently of these values.</p>
<ul class="simple">
<li><p>This might be due to legal or ethical reasons, for example.</p>
<ul>
<li><p>In a clinical trial conducted as part of the approval process for a certain treatment, this approval usually is granted only if the evidence in favor of the medical benefits of the treatment is very significant (due for example to the existence of possible side effects, or its high costs). In this case we would prefer to choose our alternative hypothesis to imply that unless the evidence in favor of the treatment is very clear, it would not be approved. We would define:</p></li>
</ul>
</li>
</ul>
<div class="math notranslate nohighlight">
\[
H_1 : \mbox{ the outcome of the trial shows significant clinical benefits}
\]</div>
<ul class="simple">
<li><p>If a regulator is considering the possibility of imposing penalties on a company because of practices going against rules and regulations, it would only proceed with penalizing the company if the evidence for these practices is very clear. That is, our alternative hypothesis in this case would be:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
H_1 : \mbox{ significant evidence of practices going against regulations has been found}
\]</div>
<ul class="simple">
<li><p>In general, for these cases the alternative hypothesis corresponds to an option we would only accept if the evidence from the sample would clearly favor it.</p></li>
</ul>
<p>In most practical cases it is possible to wait until the sample has been collected before having to specify the hypotheses for the test.</p>
<ul class="simple">
<li><p>In these cases, the choice of hypotheses can be (should be) based on the evidence provided by the data and on the reference values of interest (the value of <span class="math notranslate nohighlight">\(\mu_0\)</span>, for example).</p></li>
<li><p>The test will in most practical cases be defined as a one-sided test, as the evidence always lies on one side of the reference value.</p></li>
<li><p>If the evidence from the sample were aligned with the hull hypothesis (for example, if <span class="math notranslate nohighlight">\(\bar x &gt; \mu_0\)</span> and <span class="math notranslate nohighlight">\(H_0 : \mu \geq \mu_0\)</span>), then <span class="math notranslate nohighlight">\(H_0\)</span> would not be rejected, for reasonable values of the significance level, below 50%.</p>
<ul>
<li><p>To reach this conclusion we do not need to apply the testing procedure; thus, this conclusion is not very informative.</p></li>
</ul>
</li>
<li><p>When the evidence from the sample is aligned with the alternative hypothesis, we have a more interesting situation, as the conclusion would depend on how far is this evidence from the reference value.</p></li>
<li><p>We must determine if this evidence is sufficiently different from the null hypothesis, in which case we would reject <span class="math notranslate nohighlight">\(H_0\)</span>, or if it is not too far away from it, and then we would fail to reject it.</p>
<ul>
<li><p>We carry out this study by following the procedure we have just described.</p></li>
</ul>
</li>
<li><p>In these cases, the alternative hypothesis for our one-sided test goes in the direction of the evidence provided by the sample.</p></li>
</ul>
<p>As a final comment, we observe that failing to reject the null hypothesis of a one-sided test is not the same as accepting that our evidence supports this null hypothesis.</p>
<ul class="simple">
<li><p>When we fail to reject <span class="math notranslate nohighlight">\(H_0\)</span>, we have two possible situations:</p>
<ul>
<li><p>We may not have enough information to accept or reject <span class="math notranslate nohighlight">\(H_0\)</span>, or</p></li>
<li><p>We have enough information to be highly confident in the validity of <span class="math notranslate nohighlight">\(H_0\)</span>.</p></li>
</ul>
</li>
<li><p>To verify if we have enough evidence to accept <span class="math notranslate nohighlight">\(H_0\)</span>, as opposed to the option of just not rejecting it:</p>
<ul>
<li><p>We must have evidence from our sample going in the direction of the null hypothesis.</p></li>
<li><p>And additionally this evidence must be well within the range of values included in <span class="math notranslate nohighlight">\(H_0\)</span>.</p></li>
<li><p>This would be equivalent to rewriting our test to determine if we would reject <span class="math notranslate nohighlight">\(H_1\)</span>, after we interchange <span class="math notranslate nohighlight">\(H_0\)</span> and <span class="math notranslate nohighlight">\(H_1\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="section" id="id1">
<h5><span style="color:green;">Questions</span><a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h5>
<p><span style="color:green">Answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">For a given test with a null hypothesis of the form <span class="math notranslate nohighlight">\(H_0 : p \leq p_0 = 0.3\)</span> you have collected a sample such that <span class="math notranslate nohighlight">\(\hat p = 0.25\)</span>. What can you say about the conclusion for this test?</span></p></li>
<li><p><span style="color:green">You are asked to test if a population mean is equal to 0, and you have collected a sample where <span class="math notranslate nohighlight">\(\bar x = -0.35\)</span>. Comment on the advantages or disadvantages of selecting as the null hypothesis for your test either <span class="math notranslate nohighlight">\(H_0 : \mu = \mu_0 = 0\)</span>, <span class="math notranslate nohighlight">\(H_0 : \mu \geq \mu_0\)</span> or <span class="math notranslate nohighlight">\(H_0 : \mu \leq \mu_0\)</span></span></p></li>
<li><p><span style="color:green">How would the preceding remarks apply to a two-sided test?</span></p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-red-exercise-span">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#span-style-color-red-exercise-span" title="Permalink to this headline">#</a></h4>
<p><em>To verify the gas mileage of a new car model, a manufacturer selects six non-professional drivers to drive six different cars of this new model between two cities. At the end of each trip, the mileage of the corresponding vehicle is measured (in liters per Km) and the resulting values are indicated in the following table:</em></p>
<div class="math notranslate nohighlight">
\[
\begin{array}{cccccc}
    5.82 &amp; 5.74 &amp; 6.25 &amp; 5.57 &amp; 6.13 &amp; 5.61
\end{array}
\]</div>
<p><em>The manufacturer would like to conduct a publicity campaign based on the statement that the new model has a gas consumption lower than 6 liters per Km on the highway. Assuming that the gas consumption on highway trips is distributed normally, you are asked to test the manufacturer claim at a 5% significance level.</em></p>
<div class="section" id="span-style-color-red-exercise-solution-span">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#span-style-color-red-exercise-solution-span" title="Permalink to this headline">#</a></h5>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> denote the random variable under consideration: the gas consumption of the new model (measured in l/Km), with mean <span class="math notranslate nohighlight">\(\mu\)</span>. The values we have collected in our sample yield the following values and estimates</p>
<div class="math notranslate nohighlight">
\[
\bar x = \frac{\sum_{i=1}^6 x_i}{6} = 5.8533 , \quad s = \sqrt{\frac{\sum_{i=1}^6 x_i^2 - n\bar x^2}{5}} = 0.2783, \quad n = 6
\]</div>
<ol class="arabic simple">
<li><p>The test of interest is defined as:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
   H_0 &amp; : &amp; \mu \geq 6 = \mu_0 \\
   H_1 &amp; : &amp; \mu &lt; 6
\end{array}
\end{split}\]</div>
<p>Note that the alternative hypothesis goes in the direction of the sample data. Also, it is reasonable to require that in order to accept a low value for the mileage we should have significant evidence supporting this claim, as a reasonable measure for customer protection.</p>
<ol class="arabic simple" start="2">
<li><p>The statistic for this test, as we study a population mean from a sample with normal data and unknown population variance, is</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
T = \frac{\bar X - \mu}{S/\sqrt{n}} \sim t_{n-1}
\]</div>
<p>For the sample values and the reference value used to define the null hypothesis, the test statistic takes the value:</p>
<div class="math notranslate nohighlight">
\[
t_0 = \frac{\bar x - \mu_0}{s/\sqrt{n}} = \frac{5.8533 - 6}{0.2783/\sqrt{6}} = -1.2908
\]</div>
<ol class="arabic" start="3">
<li><p>We can proceed in one of two ways: i) We may compare this value <span class="math notranslate nohighlight">\(t_0\)</span> with the relevant quantile of a Student-t distribution with five (<span class="math notranslate nohighlight">\(n-1\)</span>) degrees of freedom for a one-sided test with 5% significance. The critical value is <span class="math notranslate nohighlight">\(t_{5;0.95} = -t_{5;0.05} = -2.015\)</span>, obtained from the table for the Student t distribution.</p>
<p>Or ii) we may compute the p-value for this test using <span style="color:blue;font-family:monospace;font-size:90%;">R</span> as</p>
</li>
</ol>
<div class="math notranslate nohighlight">
\[
\text{p-value} = \Pr( T &lt; t_0 ) = \Pr (T_5 &lt; -1.2908 ) = 0.1266
\]</div>
<p>From the tables we can only obtain the approximation, <span class="math notranslate nohighlight">\(\text{p-value} \in [0.10;0.15]\)</span>.</p>
<p>In the formulas for both cases we have used the inequalities given in the definition of our alternative hypothesis.</p>
<ol class="arabic simple" start="4">
<li><p>From the preceding values, as <span class="math notranslate nohighlight">\(t_0 = -1.2908 &gt; -2.015 = t_{5;0.95}\)</span>, we cannot reject the null hypothesis at a significance level of 5%, that is, we cannot state with high certainty that the gas consumption is lower than 6 l per Km. We reach the same conclusion using the p-value, as <span class="math notranslate nohighlight">\(\text{p-value} = 0.1266 &gt; 0.05 = \alpha\)</span>; in general, a p-value of <span class="math notranslate nohighlight">\(0.1266\)</span> is quite high and we would not reject <span class="math notranslate nohighlight">\(H_0\)</span> for such a large p-value.</p></li>
</ol>
<p><a id='Step2'></a></p>
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-step-2-comparing-the-evidence-and-the-reference-value-span">
<h3><span style="color:brown">Step 2. Comparing the evidence and the reference value</span><a class="headerlink" href="#span-style-color-brown-step-2-comparing-the-evidence-and-the-reference-value-span" title="Permalink to this headline">#</a></h3>
<p>Once we have specified the question of interest by defining our null and alternative hypotheses, the next step in a hypothesis test consists in conducting a meaningful comparison between our sample data and the reference value in the null hypothesis (<span class="math notranslate nohighlight">\(\mu_0\)</span> in our initial example).</p>
<p>A <span style="color:brown">meaningful comparison</span> should be based on a measure of the distance between the sample estimate for the parameter of interest and the reference value for this parameter. This distance should be evaluated in a manner that incorporates:</p>
<ul class="simple">
<li><p>The relationship between these two values, that is, how close these values are.</p></li>
<li><p>The variability in the population, usually estimated from the sample, to correct the scale of the preceding distance between the values.</p></li>
<li><p>The resulting value should be easy to interpret to determine when it is large or small, that is, when the data from the sample is close or compatible with the reference value.</p></li>
</ul>
<p>The value we obtain at the end of this process will be used to determine if this evidence is enough to reject <span class="math notranslate nohighlight">\(H_0\)</span>, when the value is large enough compared with some critical value, or not.</p>
</div>
</div>
<div class="section" id="span-style-color-blue-preparing-r-and-the-data-span">
<h2><span style="color:blue;">Preparing R and the data</span><a class="headerlink" href="#span-style-color-blue-preparing-r-and-the-data-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>To illustrate the concepts we have introduced, and to motivate possible choices of good estimators, we will consider specific examples, mostly based on real data, which we will process using <span style="color:blue;font-family:monospace;font-size:90%;">R</span>.</p>
<p>We start by preparing <span style="color:blue;font-family:monospace;font-size:90%;">R</span> to read and manipulate the data mentioned above. In the following <span style="color:blue;font-family:monospace;font-size:90%;">R</span> <span style="color:brown">code cell</span> we:</p>
<ol class="arabic simple">
<li><p>Load the <span style="color:blue;font-family:monospace;font-size:90%;">R</span> libraries we are going to need for our examples.</p></li>
<li><p>Define a function, <span style="color:blue;font-family:monospace;font-size:90%;">table_prnt</span>, specifying the format for the tables that will present the numerical results in this lesson.</p></li>
<li><p>Introduce information to work with the available data sets.</p></li>
</ol>
<p>The <span style="color:brown;">available data sets</span> and their identifying codes are:</p>
<ol class="arabic simple">
<li><p>Hourly prices for the Iberian electricity market</p></li>
<li><p>Grades for a Statistics subject in UC3M</p></li>
<li><p>Share prices for a company (Iberdrola) from the IBEX index</p></li>
<li><p>Simulated data from a N(80,30) distribution (var 1), an Exp(lambda=1/30) distribution (var 2) and a Binom(20,0.4) distribution (var 3)</p></li>
<li><p>Data from the Sustainable Develpment Report 2021, with the scores by country for goals 1 and 2</p></li>
</ol>
<p>In order to add another data set to this collection, you should include information for each of the following variables: the <span style="color:blue;font-family:monospace;font-size:90%;">.csv</span> file containing the data and a text with a short description for the data.</p>
<p>It is also important to ensure that the <span style="color:brown;">working directory</span> has been <span style="color:brown;">selected correctly,</span> as the directory that includes all the data sets that could be used in this lesson.</p>
<p>To execute the commands in the cell, select the cell by clicking on it, and then <span style="color:blue;">press the <strong>RUN</strong> button</span> in the menu bar, or press <span style="color:blue;">Shift-Enter.</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#options(jupyter.plot_mimetypes = c(&quot;text/plain&quot;,&quot;image/png&quot;))</span>

<span class="c1"># Load libraries with R functions</span>

<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">))</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">huxtable</span><span class="p">))</span>
<span class="nf">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">kableExtra</span><span class="p">))</span>
<span class="nf">library</span><span class="p">(</span><span class="n">IRdisplay</span><span class="p">)</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">))</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">qqplotr</span><span class="p">))</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">GGally</span><span class="p">))</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">))</span>
<span class="nf">library</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

<span class="c1"># Define a function to format and print the results of interest</span>

<span class="n">outp.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">   </span><span class="c1"># = 1 for html output, = 0 for Jupyter Books</span>

<span class="nf">if </span><span class="p">(</span><span class="n">outp.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">table_prnt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">p.df</span><span class="p">,</span><span class="n">p.capt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># A function to control the presentation of tables with numerical summaries</span>
<span class="w">    </span><span class="n">p.df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">kable</span><span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">,</span><span class="n">caption</span><span class="o">=</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;&lt;em&gt;&#39;</span><span class="p">,</span><span class="n">p.capt</span><span class="p">,</span><span class="s">&#39;&lt;/em&gt;&#39;</span><span class="p">),</span><span class="n">align</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">kable_styling</span><span class="p">(</span><span class="n">full_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;left&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">as.character</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">display_html</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">table_prnt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">p.df</span><span class="p">,</span><span class="n">p.capt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># A function to control the presentation of tables with numerical summaries</span>
<span class="w">    </span><span class="n">p.df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">kable</span><span class="p">(</span><span class="s">&quot;simple&quot;</span><span class="p">,</span><span class="n">caption</span><span class="o">=</span><span class="n">p.capt</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-examples-based-on-selected-data-sets-span">
<h2><span style="color:blue;">Examples based on selected data sets</span><a class="headerlink" href="#span-style-color-blue-examples-based-on-selected-data-sets-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>To illustrate the concepts we have introduced, and to motivate possible choices of good estimators, we will consider specific examples, mostly based on real data, which we will process using <span style="color:blue;font-family:monospace;font-size:90%;">R</span>.</p>
<div class="section" id="span-style-color-blue-selecting-and-displaying-the-data-set-and-the-variable-of-interest-span">
<h3><span style="color:blue;">Selecting and displaying the data set and the variable of interest</span><a class="headerlink" href="#span-style-color-blue-selecting-and-displaying-the-data-set-and-the-variable-of-interest-span" title="Permalink to this headline">#</a></h3>
<p>We select one of these data sets and the variable of interest in the following cell.</p>
<ol class="arabic simple">
<li><p>We assign the corresponding number to the variable <span style="color:blue;font-family:monospace;font-size:90%;">sel.data</span>, at the start of the following code cell.</p></li>
<li><p>We read the file and include the data in a <span style="color:brown;">data frame</span> with the name <span style="color:blue;font-family:monospace;font-size:90%;">Data.fr</span>.</p></li>
<li><p>We assign the number corresponding to the order of the variable of interest in the data set, to the variable <span style="color:blue;font-family:monospace;font-size:90%;">sel.col</span>.</p></li>
<li><p>We assign the values of the variable to an <span style="color:blue;font-family:monospace;font-size:90%;">R</span> data frame with the name <span style="color:blue;font-family:monospace;font-size:90%;">data.sel</span>. This data frame will contain a single variable (column) with the name <span style="color:blue;font-family:monospace;font-size:90%;">Val</span>.</p></li>
</ol>
<p>Finally, we print the names of the selected data set and variable, to check that these values are correct. Then we display some of the values from the <span style="color:blue;font-family:monospace;font-size:90%;">.csv</span> file, keeping the same structure of the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the data set of interest</span>

<span class="c1">## Datasets that are available for this lesson</span>

<span class="n">v.pref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Dat_PreciosOMIE.csv&quot;</span><span class="p">,</span><span class="w">     </span><span class="c1"># Name of the .csv data file</span>
<span class="w">                            </span><span class="s">&quot;Dat_Calificaciones.csv&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="s">&quot;Dat_PreciosIBE_MC.csv&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="s">&quot;Dat_SimulatedData.csv&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="s">&quot;Dat_SDR21.csv&quot;</span><span class="p">))</span>
<span class="n">v.pref</span><span class="o">$</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Electricity prices&quot;</span><span class="p">,</span><span class="w">         </span><span class="c1"># Short title for the data</span>
<span class="w">                </span><span class="s">&quot;Grades&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;Share returns&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;Simulated data&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;SDG 2021 Scores&quot;</span><span class="p">)</span>

<span class="c1">## Indicate the data set and variable to select</span>
<span class="c1">## These values can be modified</span>

<span class="n">sel.data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<span class="n">sel.col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span>

<span class="c1">## Read the data</span>

<span class="n">s.pref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.pref</span><span class="p">[</span><span class="n">sel.data</span><span class="p">,]</span>

<span class="n">Data.fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">read.csv2</span><span class="p">(</span><span class="n">s.pref</span><span class="o">$</span><span class="n">file</span><span class="p">)</span>
<span class="n">data.sel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">[,</span><span class="n">sel.col</span><span class="p">])</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">data.sel</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Val&quot;</span><span class="p">)</span>

<span class="c1">## Summary of the selected data</span>

<span class="n">descr.df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">s.pref</span><span class="o">$</span><span class="n">title</span><span class="p">,</span><span class="nf">colnames</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">)[</span><span class="n">sel.col</span><span class="p">]))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">descr.df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Selection&quot;</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">descr.df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Data set&quot;</span><span class="p">,</span><span class="s">&quot;Variable&quot;</span><span class="p">)</span>

<span class="n">Data.hux.0</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">descr.df</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.0</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Print a part of the data we have selected</span>

<span class="n">max.row.show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="w">       </span><span class="c1"># Max number of individual values to show</span>
<span class="n">max.col.show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="w">       </span><span class="c1"># Max number of variables to show</span>

<span class="n">n.row.show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">),</span><span class="n">max.row.show</span><span class="p">)</span>
<span class="n">n.col.show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="nf">ncol</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">),</span><span class="n">max.col.show</span><span class="p">)</span>

<span class="n">Data.hux.1</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n.row.show</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="n">n.col.show</span><span class="p">])</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="n">n.row.show</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.1</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="n">s.pref</span><span class="o">$</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: 

                  Selection
---------  ----------------
Data set    SDG 2021 Scores
Variable         Goal1Score
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: SDG 2021 Scores

 CountryCode   SDGIndexScore                Region   Population   Goal1Dash   Goal1Score   Goal2Dash    Goal2Score
------------  --------------  --------------------  -----------  ----------  -----------  ----------  ------------
         AGO            50.3                Africa     32866268         red       12.913         red     55.424125
         ALB              71   E. Europe &amp; C. Asia      2877800      yellow      91.6375      orange   60.00485714
         ARE            70.2                  MENA      9890400       green      99.5695         red        67.268
         ARG            72.8                   LAC     45195777      yellow        95.99         red     67.543125
         ARM            71.8   E. Europe &amp; C. Asia      2963234      yellow       93.438      orange   60.72814286
         AUS            75.6                  OECD     25499881      yellow        99.61         red     58.740125
         AUT            82.1                  OECD      9006400       green       99.467      orange     73.767125
         AZE            72.4   E. Europe &amp; C. Asia     10139175       green          100      orange   61.88028571
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-summaries-for-the-sample-data-span">
<h3><span style="color:blue;">Summaries for the sample data</span><a class="headerlink" href="#span-style-color-blue-summaries-for-the-sample-data-span" title="Permalink to this headline">#</a></h3>
<p>In the following cell we conduct some simple exploratory analysis of the data from the variable we have selected: we compute some of its most relevant numerical summaries, such as its mean, standard deviation and median.</p>
<p>We also draw a boxplot of the sample data corresponding to this variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print summaries from the selected data set</span>

<span class="n">smp0.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">data.sel</span><span class="p">)</span>
<span class="n">smp0.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">)</span>
<span class="n">smp0.sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">)</span>
<span class="n">smp0.var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.sd</span><span class="o">^</span><span class="m">2</span>
<span class="n">smp0.med</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">median</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">)</span>
<span class="n">Sum.fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">smp0.sz</span><span class="p">,</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">smp0.sd</span><span class="p">,</span><span class="n">smp0.med</span><span class="p">),</span><span class="m">4</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>

<span class="n">Data.hux.2</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Sample size&quot;</span><span class="p">,</span><span class="s">&quot;Mean&quot;</span><span class="p">,</span><span class="s">&quot;Standard deviation&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Median&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.2</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%s summary&quot;</span><span class="p">,</span><span class="n">s.pref</span><span class="o">$</span><span class="n">title</span><span class="p">))</span>

<span class="c1">## Boxplot for the data</span>

<span class="n">plt.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.sel</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">Val</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_boxplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="n">s.pref</span><span class="o">$</span><span class="n">title</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">(),</span><span class="n">axis.text.x</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">(),</span><span class="n">axis.ticks.x</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">plt.1</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: SDG 2021 Scores summary

                      Values
-------------------  -------
Sample size              154
Mean                  72.871
Standard deviation    33.076
Median                 90.98
</pre></div>
</div>
<img alt="_images/46b953cb50798c73c1b430713e1966a5561b2cd23cbbe75c17a2031641be6d74.png" src="_images/46b953cb50798c73c1b430713e1966a5561b2cd23cbbe75c17a2031641be6d74.png" />
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-example-of-evidence-evaluation-for-a-hypothesis-test-span">
<h3><span style="color:brown">Example of evidence evaluation for a hypothesis test</span><a class="headerlink" href="#span-style-color-brown-example-of-evidence-evaluation-for-a-hypothesis-test-span" title="Permalink to this headline">#</a></h3>
<p>Our aim with this example is to motivate the use of statistics with known distributions to evaluate the evidence from the sample and to compare it to the reference value.</p>
<p>Assume we are interested in conducting a hypothesis test of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
H_0 &amp; : &amp; \mu \leq \mu_0 \\
H_1 &amp; : &amp; \mu &gt; \mu_0
\end{array}
\end{split}\]</div>
<p>for some reasonable reference value <span class="math notranslate nohighlight">\(\mu_0\)</span>, to be specified in the following cell, on the data set and the variable we have selected previously.</p>
<p>As in Lesson 1, we do not know the values of the population parameters. We will assume that our population corresponds to all the data we have available, and the values of the population parameters are the sample values for the full sample and the associated estimators.</p>
<p>In our experiment, we will generate subsamples of a given size from the data, and we will compute the sample means for each of the subsamples. These mean values aim to represent the different samples and sample estimates that we might have obtained in a practical case.</p>
<p>Our aim is to illustrate the complexity of reaching a conclusion regarding these hypotheses, based on the limited information available in one random sample. We will consider a situation where, in order to decide on the validity of <span class="math notranslate nohighlight">\(H_0\)</span>, we only take into account the value of our estimate for the parameter, computed from the sample; in our case, the sample mean. Our aim is to show that this value by itself provides very limited information.</p>
<div class="section" id="span-style-color-blue-numerical-example-of-evidence-evaluation-i-span">
<h4><span style="color:blue">Numerical example of evidence evaluation (i)</span><a class="headerlink" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-i-span" title="Permalink to this headline">#</a></h4>
<p>In the following cell we present the values of the means obtained from different samples in shades of blue/green, while the reference value, <span class="math notranslate nohighlight">\(\mu_0\)</span>, is shown in red. We have also plotted the population value <span class="math notranslate nohighlight">\(\mu\)</span> in black, although it is important to remember that in a practical case this value would be unknown.</p>
<p>As we have the true value of the population mean and the reference value, we know what answer is the correct one in this case, and this answer does not depend on the chosen sample. But in a practical situation we would need to reach this common conclusion by taking into account only two values: i) one of the blue/green bars (sample means) and ii) the red bar corresponding to the reference value.</p>
<p>We note that:</p>
<ul class="simple">
<li><p>In some cases our conclusion from the data may seem to be clear, as the difference between these two values is large, although in other cases the comparison may not be as clear.</p>
<ul>
<li><p>But it would be important to have some indication of which of the sample values can be considered to be close to the reference value and which values are not so close.</p></li>
</ul>
</li>
<li><p>In general, we may make mistakes when reaching a conclusion based on the data, as we get conflicting answers for the different samples.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: Values obtained from different samples</span>

<span class="c1">## These values can be modified</span>

<span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span>
<span class="n">smp.sz.prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span>

<span class="n">q.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pmin</span><span class="p">(</span><span class="m">0.99</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="m">0.05</span><span class="p">,</span><span class="m">0.35</span><span class="p">,</span><span class="m">0.915</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0.1</span><span class="o">*</span><span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>

<span class="c1">## Parameters</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">smp.sz.prop</span><span class="o">*</span><span class="n">smp0.sz</span><span class="p">)</span>

<span class="n">frac.disp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span>
<span class="n">mu.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">frac.disp</span><span class="o">*</span><span class="n">smp0.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)</span>

<span class="n">col.v.gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;#619CFF&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#00BFC4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#00BF7D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#33CCCC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#33FFCC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#99CCFF&quot;</span><span class="p">)</span>

<span class="c1">## Generate samples and estimates</span>

<span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mn.smp</span><span class="p">,</span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span>
<span class="w">    </span><span class="n">s.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">s.smp</span><span class="p">,</span><span class="nf">sd</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">s.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">vm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mn.smp</span><span class="p">,</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.smp</span><span class="p">)</span>

<span class="n">st.ord</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">order</span><span class="p">(</span><span class="n">s.mn</span><span class="o">$</span><span class="n">vm</span><span class="p">)</span>
<span class="n">st.vv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">q.val</span><span class="o">*</span><span class="n">n.samples</span><span class="p">)</span>
<span class="n">st.ix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st.ord</span><span class="p">[</span><span class="n">st.vv</span><span class="p">]</span>
<span class="n">st.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn</span><span class="o">$</span><span class="n">vm</span><span class="p">[</span><span class="n">st.ix</span><span class="p">]</span>
<span class="n">st.vsd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn</span><span class="o">$</span><span class="n">vs</span><span class="p">[</span><span class="n">st.ix</span><span class="p">]</span>

<span class="n">q.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">q.val</span><span class="p">,</span><span class="n">st.val</span><span class="p">,</span><span class="n">st.vsd</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">q.mn</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;quantiles&quot;</span><span class="p">,</span><span class="s">&quot;valm&quot;</span><span class="p">,</span><span class="s">&quot;vals&quot;</span><span class="p">)</span>

<span class="n">l.mx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="n">l.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span>
<span class="n">col.vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v.gen</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">q.val</span><span class="p">)]</span>
<span class="n">plt.l.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q.mn</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">valm</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample means&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylim</span><span class="p">(</span><span class="o">-</span><span class="n">l.mx</span><span class="p">,</span><span class="n">l.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_segment</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="w"> </span><span class="n">xend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">l.sz</span><span class="p">,</span><span class="w"> </span><span class="n">yend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l.sz</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_segment</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="p">,</span><span class="w"> </span><span class="n">xend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">l.sz</span><span class="p">,</span><span class="w"> </span><span class="n">yend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l.sz</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_segment</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valm</span><span class="p">,</span><span class="w"> </span><span class="n">xend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valm</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">l.sz</span><span class="p">,</span><span class="w"> </span><span class="n">yend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l.sz</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vals</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valm</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.vals</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_colour_discrete</span><span class="p">()</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">plt.l.1</span><span class="p">)</span>

<span class="c1">## Summary of numerical values</span>

<span class="n">q.mn.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rbind</span><span class="p">(</span><span class="n">st.val</span><span class="p">,</span><span class="n">st.vsd</span><span class="p">))</span>
<span class="n">q.mn.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">,</span><span class="n">q.mn.0</span><span class="p">,</span><span class="n">mu.0</span><span class="p">,</span><span class="n">smp0.mn</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>

<span class="n">Data.hux.1</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">q.mn.v</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Sample size&quot;</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">q.val</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">r.nm</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Mean Sample %2.0f&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Std dev Sample %2.0f&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="n">r.nm</span><span class="p">,</span><span class="s">&quot;mu 0&quot;</span><span class="p">,</span><span class="s">&quot;Population mean&quot;</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r.nm</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.1</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Sample means and ref value&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Sample means and ref value

                     Values
------------------  -------
Sample size              30
Mean Sample  1       66.625
Std dev Sample  1    38.113
Mean Sample  2       72.336
Std dev Sample  2    36.779
Mean Sample  3       83.245
Std dev Sample  3    27.859
mu 0                 71.361
Population mean      72.871
</pre></div>
</div>
<img alt="_images/100443cd0391c9ad9028e62c848e9dd67df4590ff1ec42965ffb4d6e979174ef.png" src="_images/100443cd0391c9ad9028e62c848e9dd67df4590ff1ec42965ffb4d6e979174ef.png" />
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-numerical-example-of-evidence-evaluation-ii-span">
<h4><span style="color:blue">Numerical example of evidence evaluation (ii)</span><a class="headerlink" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-ii-span" title="Permalink to this headline">#</a></h4>
<p>In the preceding example we did not take into account the variability in the data to scale the distances between the different values. From a more general point of view, we did not consider the form of the distribution of our sample mean values. As a consequence, it was not easy to determine when these values were close to the reference value, or if they were not.</p>
<p>In the following cell we show the preceding values, together with information about the means obtained for a very large number of samples, which we summarize in a histogram for the sample means. This plot should motivate the relevance of having information about the distribution of our statistic, when conducting our comparisons. For example, the plot shows that the values from the samples we have selected have different probabilities of being observed in any random sample, implying that making an error for one of the values may not have the same relevance as making the same mistake for another (more central) sample.</p>
<p>In practical applications this information will not be available. Our next best alternative will be to rely in assumptions on our data to derive a statistic with a known distribution that will allow us to approximate this distribution and to conduct meaningful comparisons between our data and the reference value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: Values obtained from different samples</span>

<span class="n">n.bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>

<span class="n">plt.h.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vm</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bins</span><span class="p">,</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Histogram of sample means&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">mu.0</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>

<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">q.val</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">plt.h.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt.h.1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">q.mn</span><span class="o">$</span><span class="n">valm</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v.gen</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">## Second histogram with shaded region for a p-value</span>

<span class="n">x.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn</span><span class="o">$</span><span class="n">vm</span><span class="p">)</span>
<span class="n">x.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn</span><span class="o">$</span><span class="n">vm</span><span class="p">))</span>
<span class="n">v.sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">st.vsd</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="n">dens.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x.val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x.val</span><span class="p">,</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.sd</span><span class="p">))</span>

<span class="n">plt.h.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vm</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">..density..</span><span class="p">),</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bins</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample mean and test statistic density - mu_0 true&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_function</span><span class="p">(</span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dnorm</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.sd</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">mu.0</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">q.mn</span><span class="o">$</span><span class="n">valm</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v.gen</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dnorm</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.sd</span><span class="p">),</span>
<span class="w">                </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">q.mn</span><span class="o">$</span><span class="n">valm</span><span class="p">[</span><span class="m">1</span><span class="p">]),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;grey&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="n">geom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;area&quot;</span><span class="p">)</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.h.1</span><span class="p">,</span><span class="n">plt.h.2</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Distributional information&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
<span class=" -Color -Color-Cyan">ℹ</span> Please use `linewidth` instead.”
</pre></div>
</div>
<img alt="_images/3dcae953264d87d5eb60af0a4e81a9c54e06b8f74bae36cc42d5a995335a877e.png" src="_images/3dcae953264d87d5eb60af0a4e81a9c54e06b8f74bae36cc42d5a995335a877e.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3><span style="color:brown">Example of evidence evaluation for a hypothesis test</span><a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>We continue with our example to motivate the use of statistics with known distributions to compare the evidence from the sample information and the reference value.</p>
<p>In general, a measure of this distance between the data and the reference value will be obtained from a statistic for the test that incorporates information on the variability of the data (the <span class="xref myst">second step</span> in our general procedure).</p>
<p>It will be similar to the statistics we used for the computation of confidence intervals, where we also wished to incorporate variability information into our estimates. These statistics, if they are evaluated assuming that <span class="math notranslate nohighlight">\(H_0\)</span> is true, should take small values when our sample is compatible with this null hypothesis, and large values when it is not compatible with it.</p>
<p>The distribution of these statistics will allow us to include probability values as a measure for this distance, as part of a <span class="xref myst">third step</span> in our procedure we will define below. These probabilities will be used to evaluate the magnitude of the errors associated to this procedure. Due to the random nature of our sample, it will always be possible to make a mistake when providing an answer for a hypothesis test, but we would like to design a procedure where these mistakes take place with low probability.</p>
<p>Before we define a formal procedure to conduct this evaluation of the evidence, we will present in the following cells examples to illustrate the different aspects involved in this evaluation,</p>
</div>
<div class="section" id="span-style-color-brown-comparing-the-evidence-and-the-reference-value-span">
<h3><span style="color:brown">Comparing the evidence and the reference value</span><a class="headerlink" href="#span-style-color-brown-comparing-the-evidence-and-the-reference-value-span" title="Permalink to this headline">#</a></h3>
<p>We have already discussed that having information about distribution properties for our estimator can be very useful to reach a conclusion for a hypothesis test. We obtain this information by selecting an appropriate <span style="color:brown">test statistic</span> for our parameter, given some reasonable assumptions on our data.</p>
<p>This statistic should satisfy the following conditions:</p>
<ul class="simple">
<li><p>It should incorporate data from our sample estimate for the parameter of interest, and the value of this parameter.</p></li>
<li><p>It should also incorporate variability information, to provide a value in a scale that can be interpreted to determine when these values are small or large.</p></li>
<li><p>And it should follow a known distribution, independent of the value of the parameter, so that we can use probability information to define some critical value that will determine when to reject <span class="math notranslate nohighlight">\(H_0\)</span>.</p></li>
</ul>
<p>These characteristics are similar to the ones we considered in Lesson 1 for the choice of a statistic to construct confidence intervals. In fact, we will use in our hypothesis testing procedure the same statistics we introduced in that lesson.</p>
<p>As an example to illustrate the procedure we wish to define, we will continue assuming that our hypothesis test of interest is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
H_0 &amp; : &amp; \mu \leq \mu_0 \\
H_1 &amp; : &amp; \mu &gt; \mu_0
\end{array}
\end{split}\]</div>
<p>To compute the distance between the sample data, in particular <span class="math notranslate nohighlight">\(\bar x\)</span>, and the reference value <span class="math notranslate nohighlight">\(\mu_0\)</span> we need to select a statistic. If we assume that the CLT applies to our sample (if it is large enough), we define our <span style="color:brown">test statistic</span> as</p>
<div class="math notranslate nohighlight">
\[
T \equiv \frac{\bar X - \mu}{S/\sqrt{n}} \sim_{\scriptsize \text{approx.}} N(0,1) ,
\]</div>
<p>which we already used in Lesson 1, as in both cases we would like to define which values of the parameter are extreme ones, as opposed to values that are reasonable, given a certain distribution and the sample value.</p>
<p>To evaluate this statistic <span class="math notranslate nohighlight">\(T\)</span> for our sample values, we need to assign a value to our parameter, <span class="math notranslate nohighlight">\(\mu\)</span>. As we wish to compare the evidence from the sample with our null hypothesis, we will use as a value for our parameter the reference value used to define this null hypothesis, <span class="math notranslate nohighlight">\(\mu_0\)</span> in our example. That is, we will assume that <span class="math notranslate nohighlight">\(H_0\)</span> is true when we evaluate the test statistic for our sample.</p>
<p>In this case, we compute the value of our test statistic as</p>
<div class="math notranslate nohighlight">
\[
t_0 = \frac{\bar x - \mu_0}{s/\sqrt{n}} 
\]</div>
<p>and this value can be compared with values from a standard normal distribution to determine if it is large or small.</p>
<div class="section" id="span-style-color-blue-numerical-example-of-evidence-evaluation-iii-span">
<h4><span style="color:blue">Numerical example of evidence evaluation (iii)</span><a class="headerlink" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-iii-span" title="Permalink to this headline">#</a></h4>
<p>The following cell computes the values of the test statistic for the samples we generated in our example, assuming that the parameter of interest is the population mean and the samples we have collected are large enough to support the application of the CLT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: Values of the test statistic</span>

<span class="c1">## Computing the values of the test statistic</span>

<span class="n">q.mn</span><span class="o">$</span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">q.mn</span><span class="o">$</span><span class="n">valm</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">q.mn</span><span class="o">$</span><span class="n">vals</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">))</span>

<span class="c1">## Printing these values</span>

<span class="n">q.mn.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">q.mn</span><span class="o">$</span><span class="n">t</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>

<span class="n">Data.hux.t</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">q.mn.v</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; &quot;</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">q.mn</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">r.nm</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Sample %2.0f&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">r.nm</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.t</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r.nm</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.t</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;T values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.t</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Test statistic values&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Test statistic values

             T values
----------  ---------
Sample  1      -0.681
Sample  2       0.145
Sample  3       2.336
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h4><span style="color:green;">Questions</span><a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<p><span style="color:green">Answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">Which of the preceding values would lead you to reject <span class="math notranslate nohighlight">\(H_0\)</span></span></p></li>
<li><p><span style="color:green">How would you define which are significantly large values of the statistic?</span></p></li>
</ul>
<p><a id='Step3'></a></p>
</div>
</div>
<div class="section" id="span-style-color-brown-step-3-evaluating-the-evidence-based-on-test-statistic-values-span">
<h3><span style="color:brown">Step 3. Evaluating the evidence based on test statistic values</span><a class="headerlink" href="#span-style-color-brown-step-3-evaluating-the-evidence-based-on-test-statistic-values-span" title="Permalink to this headline">#</a></h3>
<p>The remaining step in our procedure to conduct a hypothesis test consists on comparing the value of our test statistic to some <span style="color:brown;">critical value,</span> which will define when our statistic should lead us to reject <span class="math notranslate nohighlight">\(H_0\)</span> and when that would not be the case. That is, we will transform our scale of distances associated to the value of our statistic, a continuous scale of values, to a zero/one result that will tell us when to reject/fail to reject our null hypothesis. And we will do this by defining a critical value selected to provide some control over the errors associated to our procedure.</p>
<p>We start with the value of the distance between our data and the null hypothesis that we have obtained from our test statistic. This distance can be measured by using two scales:</p>
<ul class="simple">
<li><p>In our example, we may work with the value of the statistic <span class="math notranslate nohighlight">\(T\)</span> for our sample when <span class="math notranslate nohighlight">\(\mu = \mu_0\)</span>, and determine if it is reasonably close to 0. That is, we determine if the true value <span class="math notranslate nohighlight">\(\mu\)</span>, approximated by <span class="math notranslate nohighlight">\(\bar x\)</span>, is close to <span class="math notranslate nohighlight">\(\mu_0\)</span>. We will base our decision on the values of a <span class="math notranslate nohighlight">\(N(0,1)\)</span> distribution, the distribution of our statistic, comparing them to the value of</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
t_0 = \frac{\bar x - \mu_0}{s/\sqrt{n}} ,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar x\)</span> denotes the sample mean and <span class="math notranslate nohighlight">\(s\)</span> is the sample quasi-standard deviation.</p>
<ul>
<li><p>Or we can compute the probability of observing the value <span class="math notranslate nohighlight">\(t_0\)</span>, or values that are even further from the null hypothesis (the center of our distribution) than this value, under a <span class="math notranslate nohighlight">\(N(0,1)\)</span> distribution. We call this probability the <span style="color:brown">p-value</span> of our statistic for our sample. This probability is a measure of how close our data is to <span class="math notranslate nohighlight">\(H_0\)</span> (how close <span class="math notranslate nohighlight">\(\mu\)</span> is to <span class="math notranslate nohighlight">\(\mu_0\)</span>), and it has the advantage of having a scale that is easy to interpret.</p>
<p>In our example we would compute our p-value as</p>
</li>
</ul>
<div class="math notranslate nohighlight">
\[
\mbox{p-value} = \Pr (T &gt; t) = \Pr \left( Z &gt; \frac{\bar x - \mu_0}{s/\sqrt{n}} \right) .
\]</div>
<div class="section" id="span-style-color-blue-numerical-example-of-evidence-evaluation-iv-span">
<h4><span style="color:blue">Numerical example of evidence evaluation (iv)</span><a class="headerlink" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-iv-span" title="Permalink to this headline">#</a></h4>
<p>In the following cell we indicate the p-values for our reference samples, and we represent the values of the distances obtained using the two preceding formulas, values of the test statistic and p-values, as well as the histograms corresponding to the sample means for a large collection of samples.</p>
<p>Note that in the case of the values of <span class="math notranslate nohighlight">\(T\)</span>, the resulting histogram is approximately normal, while for the p-values we have a histogram that should correspond approximately to a uniform distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: Values obtained from different samples</span>

<span class="c1">## Computing the p-values</span>

<span class="n">q.mn</span><span class="o">$</span><span class="n">pv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">q.mn</span><span class="o">$</span><span class="n">t</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1">## Printing these values</span>

<span class="n">q.mn.p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">q.mn</span><span class="o">$</span><span class="n">pv</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>

<span class="n">Data.hux.p</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">q.mn.p</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; &quot;</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">q.mn</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">r.nm</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Sample %2.0f&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">r.nm</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.p</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r.nm</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.p</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;P values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.p</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;P values for the test&quot;</span><span class="p">)</span>

<span class="c1">## Distances based on the value of the statistic</span>

<span class="n">t.s.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s.mn</span><span class="o">$</span><span class="n">vm</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">s.mn</span><span class="o">$</span><span class="n">vs</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)))</span>
<span class="n">t.smp0.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">smp0.mn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">smp0.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">))</span>
<span class="n">t.q.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s.mn</span><span class="o">$</span><span class="n">vm</span><span class="p">[</span><span class="n">st.ix</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">s.mn</span><span class="o">$</span><span class="n">vs</span><span class="p">[</span><span class="n">st.ix</span><span class="p">]</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">))</span>

<span class="c1">## Histogram for test statistic values</span>

<span class="n">n.bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>

<span class="n">plt.h.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t.s.mn</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bins</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Histogram of statistic values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">t.smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>

<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">q.val</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">plt.h.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt.h.1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">t.q.mn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v.gen</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">## Histogram based on the value of the probability (p-values)</span>

<span class="n">p.s.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">t.s.mn</span><span class="o">$</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span>
<span class="n">p.smp0.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">t.smp0.mn</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">p.q.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">t.q.mn</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="n">plt.h.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p.s.mn</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bins</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Histogram of p-values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">p.smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>

<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">q.val</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">plt.h.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt.h.2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">p.q.mn</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v.gen</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">linewidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>
<span class="p">}</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.h.1</span><span class="p">,</span><span class="n">plt.h.2</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Distances to H0 from different samples&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: P values for the test

             P values
----------  ---------
Sample  1       0.752
Sample  2       0.442
Sample  3        0.01
</pre></div>
</div>
<img alt="_images/2c4acaa042261649c267bfea0a1d1726399bbda8a9aa21a3b1aa70dec4947469.png" src="_images/2c4acaa042261649c267bfea0a1d1726399bbda8a9aa21a3b1aa70dec4947469.png" />
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-errors-associated-with-a-hypothesis-testing-procedure-span">
<h4><span style="color:brown">Errors associated with a hypothesis testing procedure</span><a class="headerlink" href="#span-style-color-brown-errors-associated-with-a-hypothesis-testing-procedure-span" title="Permalink to this headline">#</a></h4>
<p>Our measures of the distance between our data and the reference value in the hypothesis test, <span class="math notranslate nohighlight">\(\mu_0\)</span>, must be compared to some value that will determine when to accept (fail to reject) or reject <span class="math notranslate nohighlight">\(H_0\)</span>. This threshold value, our <span style="color:brown">critical value,</span> will transform our continous scale of distances into an accept/reject decision about the hypotheses in the test.</p>
<p>Our choice of this threshold value will be based on the errors associated to our decision to accept/reject <span class="math notranslate nohighlight">\(H_0\)</span>. We will base our definition on the errors related to <span class="math notranslate nohighlight">\(H_0\)</span>, as the definition of <span class="math notranslate nohighlight">\(H_0\)</span> is usually given in a manner that is easier to analyze from a formal point of view.</p>
<p>Any reasonable procedure we might define will give rise to errors in some cases, due to the uncertainty in the information available from our sample. To define these errors in a more precise manner, and to understand their sources and relationships, we will compare what we do not know but we would like to approximate, that is, wether the value of our parameter satisfies the condition in <span class="math notranslate nohighlight">\(H_0\)</span> or not, and the decision we make to reject <span class="math notranslate nohighlight">\(H_0\)</span> or not. In the following table we present all four possible comparisons and outcomes associated to these two situations:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{cc|cc}
 &amp; &amp; \text{Our decision} &amp; \\
 &amp; &amp; \text{Do not reject } H_0 &amp; \text{Reject } H_0 \\
\hline
\text{True situation} &amp; H_0 \text{ is correct} &amp; \text{Ok} &amp; \text{Type I error} \\
 &amp; H_0 \text{ is not correct} &amp; \text{Type II error} &amp; \text{Ok}
\end{array}
\end{split}\]</div>
<p>In this table we identify two possible errors in the outcome of a hypothesis test, that we will identify as:</p>
<ul class="simple">
<li><p>A <span style="color:brown">type I error</span>, when we conclude from the evidence that <span class="math notranslate nohighlight">\(H_0\)</span> should be rejected, but the (unknown) population value satisfies <span class="math notranslate nohighlight">\(H_0\)</span>.</p></li>
<li><p>A <span style="color:brown">type II error</span>, when we conclude from the evidence that <span class="math notranslate nohighlight">\(H_0\)</span> should not be rejected, but the (unknown) population value satisfies <span class="math notranslate nohighlight">\(H_1\)</span>.</p></li>
</ul>
<p>In a practical case we cannot know if we have made one of these errors or not, but we would like to control the probability of making them. We will use the following notation</p>
<div class="math notranslate nohighlight">
\[
\alpha = \Pr(\text{making a type I error}) , \qquad \beta = \Pr(\text{making a type II error})
\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is known as the <span style="color:brown">significance level</span> of the test, while <span class="math notranslate nohighlight">\(1 - \beta\)</span> denotes the <span style="color:brown">power</span> of the test. We wish to define and use hypothesis tests with low values of <span class="math notranslate nohighlight">\(\alpha\)</span> and high values of <span class="math notranslate nohighlight">\(1 - \beta\)</span>, that is, with low error probabilities.</p>
<p>These two values are related in the sense that to reduce the value of <span class="math notranslate nohighlight">\(\alpha\)</span> we must also reduce <span class="math notranslate nohighlight">\(1 - \beta\)</span> and increase <span class="math notranslate nohighlight">\(\beta\)</span>. For example, if we set a threshold for the values of the statistic beyond which we would reject <span class="math notranslate nohighlight">\(H_0\)</span> as a very extreme (large in our example) value, then the probability of a Type I error will be very low, but the probability of a type II error will be very large. And the opposite situation would apply if we were to set this threshold at a very low value.</p>
<p>The usual compromise between these two values consists on fixing the value of <span class="math notranslate nohighlight">\(\alpha\)</span> to a reasonable quantity, and to accept the value of <span class="math notranslate nohighlight">\(\beta\)</span> that will result from this choice, for a given test and its associated test statistic. The motivation for this compromise is based on the fact that it is easier to define <span class="math notranslate nohighlight">\(\alpha\)</span> for one relevant value of the parameter, the reference value <span class="math notranslate nohighlight">\(\theta_0\)</span>, while the value of <span class="math notranslate nohighlight">\(\beta\)</span> will depend on the true value of the parameter under <span class="math notranslate nohighlight">\(H_1\)</span>, and there are many possible values of <span class="math notranslate nohighlight">\(\theta\)</span> in this region</p>
</div>
</div>
<div class="section" id="span-style-color-brown-using-the-probabilities-of-the-errors-to-define-critical-values-for-a-test-span">
<h3><span style="color:brown">Using the probabilities of the errors to define critical values for a test</span><a class="headerlink" href="#span-style-color-brown-using-the-probabilities-of-the-errors-to-define-critical-values-for-a-test-span" title="Permalink to this headline">#</a></h3>
<p>Based on either the value of the test statistic <span class="math notranslate nohighlight">\(t_0\)</span> or the p-value for our test, we will select a <span style="color:brown">critical value</span> for these quantities, and we will reject <span class="math notranslate nohighlight">\(H_0\)</span> whenever we are beyond this critical value.</p>
<p>In both cases, this value will be selected to ensure that the probability of a type I error is equal to a <span style="color:brown">significance level</span> that we will specify. We will denote the significance level as <span class="math notranslate nohighlight">\(\alpha\)</span>, the same notation as the probability of a type I error, as both values coincide.</p>
<p>Our choice of a critical value will depend on the measure we wish to use:</p>
<ul class="simple">
<li><p>If we work with the value of the test statistic, assuming that the parameter is equal to the reference value, <span class="math notranslate nohighlight">\(t_0\)</span>, we will define the critical value to ensure that the type I error has a probability <span class="math notranslate nohighlight">\(\alpha\)</span> (the significance level) of happening. If we denote a r.v. with the distribution of our statisticby <span class="math notranslate nohighlight">\(T\)</span> and our critical value as <span class="math notranslate nohighlight">\(\text{cv}\)</span>, for the example we are considering this probability is given by</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\Pr(\text{type I error}) = \Pr( T &gt; \text{cv} )
\]</div>
<p>and if we impose the condition that the error has to have a probability equal to the significance level, we obtain</p>
<div class="math notranslate nohighlight">
\[
\Pr( T_0 &gt; \text{cv} ) = \alpha \quad \Rightarrow \quad \text{cv} = z_{\alpha} ,
\]</div>
<p>that is, the critical value is the <span class="math notranslate nohighlight">\(\alpha\)</span> quantile for the distribution of the test statistic, a standard normal distribution in this case. The value <span class="math notranslate nohighlight">\(T_0\)</span> denotes the test statistic defined for the value of the parameter equal to its reference value, <span class="math notranslate nohighlight">\(\mu = \mu_0\)</span> in our example.</p>
<p>In our example, we would reject <span class="math notranslate nohighlight">\(H_0\)</span> if <span class="math notranslate nohighlight">\(t_0 &gt; z_\alpha\)</span>, as this choice ensures that if <span class="math notranslate nohighlight">\(H_0\)</span> is true, the error associated to rejecting <span class="math notranslate nohighlight">\(H_0\)</span> (a type I error) will be equal to <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<ul class="simple">
<li><p>If we work with p-values, we have that</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\text{p-value} = \Pr( T &gt; t_0 )
\]</div>
<p>and we will reject <span class="math notranslate nohighlight">\(H_0\)</span> when <span class="math notranslate nohighlight">\(\text{p-value} &lt; \alpha\)</span>. This choice of a critical value for the p-value implies that the condition we use to reject <span class="math notranslate nohighlight">\(H_0\)</span> satisfies</p>
<div class="math notranslate nohighlight">
\[
\text{p-value} = \Pr ( T &gt; t_0 ) \leq \alpha = \Pr( T_0 &gt; z_{\alpha} ) \Rightarrow t_0 \leq z_{\alpha} 
\]</div>
<p>the same condition as before. As a consequence, the probability of a type I error is again equal to <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>Note that we reject <span class="math notranslate nohighlight">\(H_0\)</span> when the <span class="math notranslate nohighlight">\(\text{p-value}\)</span> is small, as it is a measure of the compatibility between the information in our sample, and the reference value of the parameter.</p>
<div class="section" id="id4">
<h4><span style="color:green;">Questions</span><a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h4>
<p><span style="color:green">Answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">Comment if the value of the power of a test, <span class="math notranslate nohighlight">\(1 - \beta\)</span>, should be a small value.</span></p></li>
<li><p><span style="color:green">Can the value of the power of a test <span class="math notranslate nohighlight">\(1 - \beta\)</span> be equal to the significance level of the test <span class="math notranslate nohighlight">\(\alpha\)</span>? Discuss.</span></p></li>
<li><p><span style="color:green">Comment what happens to the significance level of a test when the sample size increases. How would the power of the test change with the sample size?</span></p></li>
<li><p><span style="color:green">Consider a test to determine if a certain medical diagnostic has detected some serious condition, where the null hypothesis is that the treatment provides no indication of that condition. Indicate the errors for this test. Which of the two error probabilities would be more relevant?</span></p></li>
</ul>
</div>
<div class="section" id="span-style-color-blue-numerical-example-of-evidence-evaluation-v-span">
<h4><span style="color:blue">Numerical example of evidence evaluation (v)</span><a class="headerlink" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-v-span" title="Permalink to this headline">#</a></h4>
<p>The following cell shows the values of the test statistic, its p-values and the critical values for the statistic and for the p-values (the significance level), for the example we have been studying up to this point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: Conclusions</span>

<span class="c1">## Computing the critical value</span>

<span class="n">sig.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span>
<span class="n">crit.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1">## Printing these values</span>

<span class="n">q.col.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">q.mn</span><span class="o">$</span><span class="n">t</span><span class="p">,</span><span class="n">crit.val</span><span class="p">),</span><span class="m">3</span><span class="p">)</span>
<span class="n">q.col.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">q.mn</span><span class="o">$</span><span class="n">pv</span><span class="p">,</span><span class="n">sig.lvl</span><span class="p">),</span><span class="m">3</span><span class="p">)</span>
<span class="n">q.mn.p1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">q.col.1</span><span class="p">,</span><span class="n">q.col.2</span><span class="p">))</span>

<span class="n">Data.hux.p1</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">q.mn.p1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; &quot;</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">q.mn</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">r.nm</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Sample %2.0f&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">r.nm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">r.nm</span><span class="p">,</span><span class="s">&quot;Critical values&quot;</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.p1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r.nm</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.p1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Test values&quot;</span><span class="p">,</span><span class="s">&quot;P values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.p1</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Statistic and p values for the test&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Statistic and p values for the test

                   Test values   P values
----------------  ------------  ---------
Sample  1               -0.681      0.752
Sample  2                0.145      0.442
Sample  3                2.336       0.01
Critical values          1.645       0.05
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id5">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h4>
<p><em>An industrial production line is supposed to fill out containers with a substance to a target weight of 16 grams. An excessive over- or under-weight are considered to be serious problems and should lead to the suspension and recalibration of the production line. A quality control inspector selects a sample of forty containers, based on which she is supposed to decide whether the production line should be stopped or not.</em></p>
<p><em>If this sample yields a mean weight of <span class="math notranslate nohighlight">\(16.31\)</span> grams and a quasi-variance of <span class="math notranslate nohighlight">\(0.82\)</span> grams<span class="math notranslate nohighlight">\({}^2\)</span>, which action should the inspector take at a 5% significance level?</em></p>
<div class="section" id="id6">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h5>
<p>For the population of packages produced in this line, we define the continuous random variable <span class="math notranslate nohighlight">\(X =\)</span> “fill weight of a container”.</p>
<p>We will base our decision on the operation of the line in the results of a hypothesis test on the mean of the population <span class="math notranslate nohighlight">\(\mu_X\)</span>, for a significance level <span class="math notranslate nohighlight">\(\alpha = 0.05.\)</span> Our null hypothesis will be that the population mean is equal to the desired weight value, <span class="math notranslate nohighlight">\(H_0 : \mu_X = 16\)</span>, as both an excess and a defect in the weight are considered serious problems.</p>
<ol class="arabic simple">
<li><p>The hypotheses of the test will be</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
   H_0 &amp; : &amp; \mu_X = 16 = \mu_0 \\
   H_1 &amp; : &amp; \mu_X \not= 16
\end{array}
\end{split}\]</div>
<ol class="arabic simple" start="2">
<li><p>The statistic for this test, as we study a population mean from a large sample (<span class="math notranslate nohighlight">\(n = 40\)</span>), is</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
T = \frac{\bar X - \mu}{S/\sqrt{n}} \sim_{\scriptsize\text{approx.}} N(0,1)
\]</div>
<p>For the sample values and the reference value used to define the null hypothesis, the test statistic takes the value:</p>
<div class="math notranslate nohighlight">
\[
t_0 = \frac{16.31 - 16}{\sqrt{0.82/40}} = 2.165
\]</div>
<ol class="arabic" start="3">
<li><p>We may proceed by computing the critical region of the test, or the p-value of this test.</p>
<p>The critical value corresponding to a significance level <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span> will be <span class="math notranslate nohighlight">\(z_{\alpha/2} = 1.96\)</span>, and the critical region will be</p>
</li>
</ol>
<div class="math notranslate nohighlight">
\[
\text{RR}_{0.05} = \{ (x_1, \ldots , x_n ) | \{ t_0 &lt; -1.96 \} \cup \{ t_0 &gt; 1.96 \} \}
\]</div>
<p>For the p-value, we have</p>
<div class="math notranslate nohighlight">
\[
\text{p-value} = 2 \Pr \left( Z &gt; | t_0 | \right) = 2 \Pr (Z &gt; 2.165 ) = 0.0304
\]</div>
<ol class="arabic simple" start="4">
<li><p>From the preceding values, as <span class="math notranslate nohighlight">\(t_0 = 2.165 &gt; 1.96\)</span>, the sample lies in the critical region and we reject <span class="math notranslate nohighlight">\(H_0\)</span>, that is, we can state with high certainty that the containers have an average weight different from 16 grams. We would reach the same conclusion using the p-value, as <span class="math notranslate nohighlight">\(\text{p-value} = 0.0304 &lt; 0.05\)</span>. Thus, we would reject the null hypothesis for any significance level larger than 3%.</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-steps-to-conduct-a-hypothesis-testing-procedure-span">
<h3><span style="color:brown;">Steps to conduct a hypothesis testing procedure</span><a class="headerlink" href="#span-style-color-brown-steps-to-conduct-a-hypothesis-testing-procedure-span" title="Permalink to this headline">#</a></h3>
<p>The following steps summarize the procedure to conduct a hypothesis test, adapted to the particular case we have been using before.</p>
<p><span style="color:brown;">· Step 0.</span> Identify the parameter of interest. Assume in our case that we wish to conduct a test for the population mean.</p>
<p>Select the reference value for the test, <span class="math notranslate nohighlight">\(\mu_0\)</span>. Also, select a significance level <span class="math notranslate nohighlight">\(\alpha\)</span> for the test.</p>
<p><span style="color:brown;">· Step 1.</span> Define the null and alternative hypotheses. Assume again that for this example we wish to test the following hypotheses:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
H_0 &amp; : &amp; \mu \leq \mu_0 \\
H_1 &amp; : &amp; \mu &gt; \mu_0
\end{array}
\end{split}\]</div>
<p><span style="color:brown;">· Step 2.</span> Identify the test statistic to use and its distribution, from the choice of parameter to study and the properties of the sample and the population. If we assume that <span class="math notranslate nohighlight">\(n\)</span> is large enough, we have</p>
<div class="math notranslate nohighlight">
\[
T = \frac{\bar X - \mu}{S/\sqrt{n}} \sim_{\scriptsize\text{approx.}} N(0,1)
\]</div>
<p>Compute the required statistics from the sample; in this case we will need the values of <span class="math notranslate nohighlight">\(\bar x\)</span>, <span class="math notranslate nohighlight">\(s\)</span> and <span class="math notranslate nohighlight">\(n\)</span>. From these values and the reference value for <span class="math notranslate nohighlight">\(\mu\)</span>, compute the value of the test statistic,</p>
<div class="math notranslate nohighlight">
\[
t_0 = \frac{\bar x - \mu_0}{s/\sqrt{n}}
\]</div>
<p><span style="color:brown;">· Step 3.</span> Compute the critical value and/or the p-value for this test, as</p>
<div class="math notranslate nohighlight">
\[
\text{cv} = z_{\alpha} , \qquad \text{p-value} = \Pr( Z &gt; t )
\]</div>
<p><span style="color:brown;">· Step 4.</span> Reach a conclusion for the test, by checking either if <span class="math notranslate nohighlight">\(t &gt; \text{cv}\)</span> or if <span class="math notranslate nohighlight">\(\text{p-value} &lt; \alpha\)</span>.</p>
<div class="section" id="span-style-color-blue-an-illustration-of-the-general-hypothesis-testing-procedure-span">
<h4><span style="color:blue;">An illustration of the general hypothesis testing procedure</span><a class="headerlink" href="#span-style-color-blue-an-illustration-of-the-general-hypothesis-testing-procedure-span" title="Permalink to this headline">#</a></h4>
<p>In the following cell we present the numerical results corresponding to the preceding steps, obtained from a random subsample of the data we have selected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: a simple example</span>

<span class="c1">## These values can be modified</span>

<span class="n">sig.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span>
<span class="n">smp.sz.prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span>
<span class="n">q.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0.2</span><span class="o">*</span><span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="c1">## General parameters</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="m">30</span><span class="p">,</span><span class="nf">floor</span><span class="p">(</span><span class="n">smp.sz.prop</span><span class="o">*</span><span class="n">smp0.sz</span><span class="p">))</span>

<span class="c1">## Generate our sample and the reference value</span>

<span class="n">f.dsp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1.5</span><span class="o">*</span><span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>

<span class="n">v.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">mu.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f.dsp</span><span class="o">*</span><span class="nf">sd</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)</span>

<span class="c1">## Display de values of the general parameters</span>

<span class="n">dat.a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0</span><span class="p">,</span><span class="n">sig.lvl</span><span class="p">),</span><span class="m">2</span><span class="p">))</span>
<span class="n">Data.hux.a</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">dat.a</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.a</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Reference value mu0&quot;</span><span class="p">,</span><span class="s">&quot;Significance level&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.a</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.a</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Step 3 - Ref values for the test&quot;</span><span class="p">)</span>

<span class="c1">## Obtain the summary values for the sample</span>

<span class="n">sv.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span>
<span class="n">ss.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">v.smp</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span>
<span class="n">s.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span>

<span class="c1">## Print summary values from our sample</span>

<span class="n">dat.b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">sv.smp</span><span class="p">,</span><span class="w"> </span><span class="n">ss.smp</span><span class="p">,</span><span class="w"> </span><span class="n">mn.smp</span><span class="p">,</span><span class="w"> </span><span class="n">s.smp</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>
<span class="n">Data.hux.b</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">dat.b</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.b</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Sample size&quot;</span><span class="p">,</span><span class="s">&quot;Sum of values&quot;</span><span class="p">,</span><span class="s">&quot;Sum of squares&quot;</span><span class="p">,</span><span class="s">&quot;Sample mean&quot;</span><span class="p">,</span><span class="s">&quot;Sample quasi-std dev&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.b</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.b</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Step 5 - sample values&quot;</span><span class="p">)</span>

<span class="c1">## Compute the value of the statistic for the data in the sample and the given reference value</span>

<span class="n">t.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">mn.smp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">s.smp</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">))</span>

<span class="n">dat.c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">t.val</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="n">Data.hux.c</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">dat.c</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.c</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Test statistic&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.c</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Value&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.c</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Step 6 - test statistic&quot;</span><span class="p">)</span>

<span class="c1">## Compute and print the critical value and the p-value</span>

<span class="n">v.crit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">p.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">t.val</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="n">dat.d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">v.crit</span><span class="p">,</span><span class="n">p.val</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>
<span class="n">Data.hux.d</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">dat.d</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.d</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Critical value for the test&quot;</span><span class="p">,</span><span class="s">&quot;P-value of the test&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.d</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.d</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Step 7 - Critical value and p-value&quot;</span><span class="p">)</span>

<span class="c1">## Conclusion</span>

<span class="nf">if </span><span class="p">(</span><span class="n">p.val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sig.lvl</span><span class="p">)</span><span class="w"> </span><span class="n">c.txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Reject H_0&quot;</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="n">c.txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Fail to reject H_0&quot;</span>
<span class="w">    </span>
<span class="n">dat.e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">c.txt</span><span class="p">)</span>
<span class="n">Data.hux.e</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">dat.e</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.e</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Conclusion for the test  &quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.e</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.e</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Step 8 - Conclusion&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Step 3 - Ref values for the test

                       Values
--------------------  -------
Reference value mu0     58.38
Significance level       0.05
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Step 5 - sample values

                            Values
---------------------  -----------
Sample size                     30
Sum of values             2077.004
Sum of squares          178227.726
Sample mean                 69.233
Sample quasi-std dev        34.456
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Step 6 - test statistic

                  Value
---------------  ------
Test statistic    1.725
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Step 7 - Critical value and p-value

                               Values
----------------------------  -------
Critical value for the test     1.645
P-value of the test             0.042
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Step 8 - Conclusion

                                     
------------------------  -----------
Conclusion for the test    Reject H_0
------------------------  -----------
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-summary-of-a-hypothesis-testing-procedure-span">
<h3><span style="color:brown">Summary of a hypothesis testing procedure</span><a class="headerlink" href="#span-style-color-brown-summary-of-a-hypothesis-testing-procedure-span" title="Permalink to this headline">#</a></h3>
<p>Summarizing the contents of the preceding cells, in order to carry out a hypothesis testing process we need to:</p>
<p><span style="color:brown">· Step 1.</span> Define our null and alternative hypotheses. We will mostly consider hypotheses defined as inequalities relating the parameter and a reference value, which we will call <span style="color:brown">one-sided</span> hypotheses,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
H_0 &amp; : &amp; \mu \geq \mu_0 \\
H_1 &amp; : &amp; \mu &lt; \mu_0
\end{array} \qquad \mbox{or} \qquad 
\begin{array}{rcl}
H_0 &amp; : &amp; \mu \leq \mu_0 \\
H_1 &amp; : &amp; \mu &gt; \mu_0
\end{array}
\end{split}\]</div>
<p>In some special cases (mostly theoretical ones) we may consider <span style="color:brown">two-sided</span> hypotheses, based on equality relationships of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
H_0 &amp; : &amp; \mu = \mu_0 \\
H_1 &amp; : &amp; \mu \not= \mu_0
\end{array}
\end{split}\]</div>
<p><span style="color:brown">· Step 2.</span> Select a test statistic with a known distribution, to evaluate the distance between our data and the reference value. These statistics will depend on the parameter to compare, the properties of the data and the sample characteristics. We will consider statistics similar to the ones introduced in Lesson 1.</p>
<p>Compute the value of the test statistic under the null hypothesis, using our reference value <span class="math notranslate nohighlight">\(\mu_0\)</span> as the value of the parameter.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\small
\begin{array}{lllccc}
\text{Parameter} &amp; \text{Estimator} &amp; \text{Assumptions} &amp; \text{Statistic} &amp; \text{Distribution} &amp; \text{Statistic under } H_0 \\
\hline
\text{Mean } \mu &amp; \text{Sample mean } \bar X &amp; \text{Large sample size} &amp; \frac{\bar X - \mu}{\frac{S}{\sqrt{n}}} &amp; N(0,1) &amp; t_0 = \frac{\bar x - \mu_0}{\frac{s}{\sqrt{n}}} \\
&amp; &amp; \text{Normal data} &amp; \frac{\bar X - \mu}{\frac{S}{\sqrt{n}}} &amp; t_{n-1} &amp; t_0 = \frac{\bar x - \mu_0}{\frac{s}{\sqrt{n}}} \\
\text{Proportion } p &amp; \text{Sample proportion } \hat P &amp; \text{Large sample size} &amp; \frac{\hat P - p}{\sqrt{\frac{p(1 - p)}{n}}} &amp; N(0,1) &amp; t_0 = \frac{\hat p - p_0}{\sqrt{\frac{p(1 - p)}{n}}} \\
\text{Variance } \sigma^2 &amp; \text{Sample quasivariance } S^2 &amp; \text{Normal data} &amp; \frac{(n-1)S^2}{\sigma^2} &amp; \chi^2_{n-1} &amp; t_0 = \frac{(n-1)s^2}{\sigma_0^2}
\end{array}
\end{split}\]</div>
<p><span style="color:brown">· Step 3.</span> If you wish to conduct the test in the space of probabilities, compute a p-value for the test and compare it with the significance level. Otherwise, if you work with the value of the test statistic, compute a critical value as a quantile from the distribution of the test statistic, and compare these values.</p>
<p>The following table presents the conditions under which you should reject the null hypothesis, for a certain significance level <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\small
\begin{array}{cccc}
H_1 &amp; \text{Critical value} &amp; \text{Rejection region} &amp; \text{P-value def} \\
\hline
\mu &gt; \mu_0 &amp; z_{\alpha},t_{n-1;\alpha} &amp; \{ t &gt; \text{cv} \} &amp; \Pr(T &gt; t) \\
\mu &lt; \mu_0 &amp; -z_{\alpha},-t_{n-1;\alpha} &amp; \{ t &lt; \text{cv} \} &amp; \Pr(T &lt; t) \\
\mu \not= \mu_0 &amp; z_{\alpha/2},t_{n-1;\alpha/2} &amp; \{ t &lt; -\text{cv} \}\cup \{ t &gt; \text{cv} \} &amp; \min(1,2\Pr(T &gt; t)) \\
\sigma^2 &gt; \sigma_0^2 &amp; \chi^2_{n-1;\alpha} &amp; \{ t &gt; \mbox{cv} \} &amp; \Pr(T &gt; t) \\
\sigma^2 &lt; \sigma_0^2 &amp; \chi^2_{n-1;1-\alpha} &amp; \{ t &lt; \mbox{cv} \} &amp; \Pr(T &lt; t) \\
\sigma^2 \not= \sigma_0^2 &amp; \chi^2_{n-1;\alpha/2},\chi^2_{n-1;1-\alpha/2} &amp; \{ t &lt; \chi^2_{n-1;1-\alpha} \}\cup \{ t &gt; \chi^2_{n-1;\alpha} \} &amp; \min(1,2\Pr(T &gt; t))
\end{array}
\end{split}\]</div>
<p>Comments on this table:</p>
<ul class="simple">
<li><p>The symbol <span class="math notranslate nohighlight">\(t\)</span> represents the value of the test statistic for the available sample, under the null hypothesis.</p></li>
<li><p>The symbol <span class="math notranslate nohighlight">\(\mbox{cv}\)</span> represents the critical value as specified in the corresponding column of the table.</p></li>
<li><p>When two critical values from different distributions are indicated, you should use the one corresponding to the assumptions reasonable for your test.</p></li>
<li><p>For the p-value you always reject when <span class="math notranslate nohighlight">\(\mbox{p-value} &lt; \alpha\)</span>.</p></li>
<li><p>All quantiles are right-quantiles, for example, <span class="math notranslate nohighlight">\(\Pr(Z &gt; z_\alpha ) = \alpha\)</span>.</p></li>
<li><p>For tests on the proportion, just replace <span class="math notranslate nohighlight">\(\mu\)</span> with <span class="math notranslate nohighlight">\(p\)</span> in the preceding formulas and use the quantiles from a Normal distribution.</p></li>
</ul>
<p><span style="color:brown">· Step 4.</span> Interpret and explain your conclusion for the data you have collected and for the definition of the null hypothesis.</p>
<div class="section" id="id7">
<h4><span style="color:green;">Questions</span><a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h4>
<p><span style="color:green">Answer the following questions, for some reasonable significance level:</span></p>
<ul class="simple">
<li><p><span style="color:green">For a given sample with <span class="math notranslate nohighlight">\(\bar x = 12.4\)</span>, <span class="math notranslate nohighlight">\(s = 5.8\)</span> and <span class="math notranslate nohighlight">\(n = 36\)</span>, conduct a test of the form <span class="math notranslate nohighlight">\(H_1 : \mu &lt; \mu_0 = 14\)</span> and indicate your conclusion.</span></p></li>
<li><p><span style="color:green">Conduct a test of the form <span class="math notranslate nohighlight">\(H_0 : p = p_0 = 0.25\)</span> based on a sample with <span class="math notranslate nohighlight">\(\hat p = 0.2\)</span> and <span class="math notranslate nohighlight">\(n = 100\)</span>.Indicate your conclusion.</span></p></li>
<li><p><span style="color:green">You have a sample of normal observations that satisfies <span class="math notranslate nohighlight">\(\bar x = -3.4\)</span>, <span class="math notranslate nohighlight">\(s = 1.2\)</span> and <span class="math notranslate nohighlight">\(n = 16\)</span>. Conduct a test of the form <span class="math notranslate nohighlight">\(H_1 : \mu &gt; \mu_0 = -4\)</span> and indicate your conclusion.</span></p></li>
<li><p><span style="color:green">A sample of normal observations satisfies <span class="math notranslate nohighlight">\(s = 4\)</span> and <span class="math notranslate nohighlight">\(n = 20\)</span>. Conduct a test of the form <span class="math notranslate nohighlight">\(H_0 : \sigma \leq \sigma_0 = 3\)</span> and indicate your conclusion.</span></p></li>
<li><p><span style="color:green">Comment the following statement: “For a given sample and the same definition of a test, conducting a two-sided test is equivalent to conducting the equivalent one-sided test but replacing the significance level by a value twice as large”.</span></p></li>
</ul>
</div>
<div class="section" id="id8">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h4>
<p><em>The manufacturer of a certain precision component is required to ensure that the variability (standard deviation) in one of the characteristics of a given component does not exceed <span class="math notranslate nohighlight">\(0.2\)</span> mm. The manufacturer has collected a sample of 12 measurements from different components, with values for the characteristic given in the following table:</em></p>
<div class="math notranslate nohighlight">
\[
\begin{array}{cccccccccccc}
13.13 &amp; 13.29 &amp; 13.34 &amp; 13.24 &amp; 12.89 &amp; 13.17 &amp; 12.68 &amp; 13.35 &amp; 13.07 &amp; 12.78 &amp; 13.32 &amp; 12.69
\end{array}
\]</div>
<p><em>The manufacturer would like to test if the information in the sample would imply that the manufacturing process is not working within the desired tolerance. Should the factory stop this process and recalibrate it?</em></p>
<p><em>You may assume that the data follow a normal distribution.</em></p>
<div class="section" id="id9">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h5>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> denote the random variable corresponding to the value of the characteristic of interest. We wish to conduct a hypothesis test on the value of <span class="math notranslate nohighlight">\(\sigma_X\)</span>, or on <span class="math notranslate nohighlight">\(\sigma_X^2\)</span>, as this second option is slightly simpler.</p>
<p>The data we have collected in our sample yield the following values and estimates</p>
<div class="math notranslate nohighlight">
\[
\bar x = \frac{\sum_{i=1}^{12} x_i}{12} = 13.0683 , \quad s^2 = \frac{\sum_{i=1}^{12} x_i - n\bar x^2}{11} = 0.06562, \quad n = 12
\]</div>
<ol class="arabic simple">
<li><p>The test of interest is defined as:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
   H_0 &amp; : &amp; \sigma_X^2 \leq 0.2^2 = \sigma_0^2 \\
   H_1 &amp; : &amp; \sigma_X^2 &gt; 0.04
\end{array}
\end{split}\]</div>
<p>The alternative hypothesis in this case has been selected in the direction of the sample data. Its interpretation would be that we do not wish to stop the production unless we have clear evidence that the tolerance is being exceeded, when considering all the maufactured components.</p>
<ol class="arabic simple" start="2">
<li><p>The statistic for this test, as we study a population variance from a sample with normal data, is</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
T = \frac{(n-1)S_x^2}{\sigma^2} \sim \chi^2_{n-1}
\]</div>
<p>For the sample values and the reference value used to define the null hypothesis, the test statistic takes the value:</p>
<div class="math notranslate nohighlight">
\[
t_0 = \frac{(n-1)s^2}{\sigma_0^2} = \frac{11\times 0.06562}{0.04} = 18.044
\]</div>
<ol class="arabic simple" start="3">
<li><p>We can proceed in one of two ways. We may compare this value <span class="math notranslate nohighlight">\(t_0\)</span> with the relevant quantile of a chi squared distribution with eleven (<span class="math notranslate nohighlight">\(n-1\)</span>) degrees of freedom for a one-sided test, using a reasonable significance level, for example, <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>. This critical value is <span class="math notranslate nohighlight">\(\chi^2_{n-1;0.05} = \chi^2_{11;0.05} = 19.675\)</span>, obtained from the table for the chi squared distribution.</p></li>
</ol>
<p>Alternatively, we may compute the p-value for this test using <span style="color:blue;font-family:monospace;font-size:90%;">R</span>, as</p>
<div class="math notranslate nohighlight">
\[
\text{p-value} = \Pr( T &gt; t_0 ) = \Pr (\chi^2_{11} &gt; 18.044 ) = 0.08057
\]</div>
<p>From the tables we can only obtain the approximation, <span class="math notranslate nohighlight">\(\text{p-value} \in [0.05;0.10]\)</span>.</p>
<ol class="arabic simple" start="4">
<li><p>From the preceding values, as <span class="math notranslate nohighlight">\(t_0 = 18.044 &lt; 19.675 = \chi^2_{11;0.05}\)</span>, we cannot reject the null hypothesis at a significance level of 5%, that is, we cannot state with high certainty that the variability in the value of the characteristic is larger than <span class="math notranslate nohighlight">\(0.2\)</span> mm.</p></li>
</ol>
<p>We reach the same conclusion using the p-value, as <span class="math notranslate nohighlight">\(\text{p-value} = 0.08057 &gt; 0.05 = \alpha\)</span>. But in this case we would have rejected the null hypothesis if we would have chosen a significance level of 10%, for example, or in general for any significance level larger than 8%.</p>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-numerical-application-of-hypothesis-testing-procedures-span">
<h2><span style="color:blue;">Numerical application of hypothesis testing procedures</span><a class="headerlink" href="#span-style-color-blue-numerical-application-of-hypothesis-testing-procedures-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>In the following cells we define a group of R commands that will allow us to conduct different hypothesis tests for predefined data sets or for randomly selected data. These cells are structured as a sequence of tasks to be conducted on the data, to select it, preprocess it, apply the hypothesis testing procedure and show the results.</p>
<div class="section" id="span-style-color-blue-1-define-the-data-to-be-used-for-the-example-span">
<h3><span style="color:blue;">1. Define the data to be used for the example</span><a class="headerlink" href="#span-style-color-blue-1-define-the-data-to-be-used-for-the-example-span" title="Permalink to this headline">#</a></h3>
<p>In the following cell we indicate both the dataset and the variable that you would like to study. You have two options to work with this data:</p>
<ol class="arabic simple">
<li><p>Conduct a test on all the data, or</p></li>
<li><p>Conduct a test on a random subsample obtained from the data.</p></li>
</ol>
<p>This second case is introduced to allow for the generation of random examples of hypothesis tests. The two cases are controlled by specifying the value of a variable <span style="color:blue;font-family:monospace;font-size:90%;">smp.sz.frac</span>. If this value is set equal to 1, all the selected data are used, otherwise, a random subsample with the specified size is used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the data set and variable of interest</span>

<span class="n">f.pref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<span class="n">sel.col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span>

<span class="c1">## Read the data set</span>

<span class="n">s.pref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.pref</span><span class="p">[</span><span class="n">f.pref</span><span class="p">,]</span>
<span class="n">Data.fr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv2</span><span class="p">(</span><span class="n">s.pref</span><span class="o">$</span><span class="n">file</span><span class="p">)</span>

<span class="c1">## Extract variable of interest</span>

<span class="n">data.sel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">[,</span><span class="n">sel.col</span><span class="p">])</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">data.sel</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Val&quot;</span><span class="p">)</span>

<span class="c1"># Define the subsample you would like to use for the example (use the value 1 to specify the full sample)</span>

<span class="n">smp.sz.frac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span>

<span class="c1">## Define the variable with the data for the test</span>

<span class="n">smp0.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">data.sel</span><span class="p">)</span>
<span class="nf">if </span><span class="p">(</span><span class="n">smp.sz.frac</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">smp.sz.lbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;No&quot;</span>
<span class="w">    </span><span class="n">smp.sz.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.sz</span>
<span class="w">    </span><span class="n">v.smp.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.sel</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">smp.sz.lbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Yes&quot;</span>
<span class="w">    </span><span class="n">smp.sz.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">smp.sz.frac</span><span class="o">*</span><span class="n">smp0.sz</span><span class="p">)</span>
<span class="w">    </span><span class="n">v.smp.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="w"> </span><span class="n">smp.sz.2</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">## Summary of values from the full sample and the subsample</span>

<span class="n">smp0.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">)</span>
<span class="n">smp0.var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">)</span>

<span class="n">smp.sz.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">v.smp.2</span><span class="p">)</span>
<span class="n">mn.smp.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp.2</span><span class="p">)</span>
<span class="n">var.smp.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">v.smp.2</span><span class="p">)</span>

<span class="c1"># Print information on the selected data</span>

<span class="n">descr.df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">s.pref</span><span class="o">$</span><span class="n">title</span><span class="p">,</span><span class="nf">colnames</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">)[</span><span class="n">sel.col</span><span class="p">],</span><span class="n">smp.sz.lbl</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">descr.df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Selection&quot;</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">descr.df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Data set&quot;</span><span class="p">,</span><span class="s">&quot;Variable&quot;</span><span class="p">,</span><span class="s">&quot;Random subsample?&quot;</span><span class="p">)</span>

<span class="n">Data.hux.0</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">descr.df</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.0</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Selected data set and variables&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Selected data set and variables

                           Selection
------------------  ----------------
Data set             SDG 2021 Scores
Variable                  Goal1Score
Random subsample?                Yes
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-2-define-the-type-of-test-that-you-would-like-to-conduct-span">
<h3><span style="color:blue;">2. Define the type of test that you would like to conduct</span><a class="headerlink" href="#span-style-color-blue-2-define-the-type-of-test-that-you-would-like-to-conduct-span" title="Permalink to this headline">#</a></h3>
<p>We select the significance level of the test as the value of the variable <span style="color:blue;font-family:monospace;font-size:90%;">sig.lvl</span>, at the beginning of the cell.</p>
<p>We then specify the test we would like to carry out, by indicating:</p>
<ul class="simple">
<li><p>The parameter on which we wish to conduct the test, in the variable <span style="color:blue;font-family:monospace;font-size:90%;">ht.par</span>.</p></li>
<li><p>The assumptions we are willing to make about the test, also in the variable <span style="color:blue;font-family:monospace;font-size:90%;">ht.par</span>.</p></li>
<li><p>The form of the null hypothesis of the test, as well as the reference value, in the variable <span style="color:blue;font-family:monospace;font-size:90%;">ht.type</span>..</p></li>
</ul>
<p>The reference value is generated randomly, based on the (full) sample data. It can be introduced directly by giving a value to the variable <span style="color:blue;font-family:monospace;font-size:90%;">ref.val</span> in the following cell.</p>
<p>At the end of the cell we print a summary with all the preceding values plus some of the basis sample statistics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Significance level for the test</span>

<span class="n">sig.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span>

<span class="c1"># Choice of type of hypothesis test to conduct</span>

<span class="n">ht.par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w">         </span><span class="c1"># = 1, test for the mean (CLT)</span>
<span class="w">                    </span><span class="c1"># = 2, test for the mean (normal data)</span>
<span class="w">                    </span><span class="c1"># = 3, test for a proportion</span>
<span class="w">                    </span><span class="c1"># = 4, test for the variance</span>
<span class="n">ht.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w">        </span><span class="c1"># = 1, one-sided, left-hand test, H_1 : mu &gt; mu_0 (for example)</span>
<span class="w">                   </span><span class="c1"># = 2, one-sided, right-hand test, H_1 : mu &lt; mu_0 (for example)</span>
<span class="w">                   </span><span class="c1"># = 3, two-sided, H_1 : mu &lt;&gt; mu_0 (for example)</span>

<span class="c1"># Reference value for the test</span>

<span class="nf">if </span><span class="p">(</span><span class="n">ht.par</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">frac.shft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">ref.val.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="n">frac.shft</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp0.var</span><span class="o">/</span><span class="n">smp0.sz</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.par</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">frac.shft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">ref.cutoff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">frac.shft</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp0.var</span><span class="o">/</span><span class="n">smp0.sz</span><span class="p">)</span>
<span class="w">    </span><span class="n">smp0.pr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ref.cutoff</span><span class="p">)</span>
<span class="w">    </span><span class="n">pr.smp.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp.2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ref.cutoff</span><span class="p">)</span>
<span class="w">    </span><span class="n">ref.val.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.pr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="n">frac.shft</span><span class="o">*</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp0.pr</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">smp0.pr</span><span class="p">)</span><span class="o">/</span><span class="n">smp0.sz</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">frac.shft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0.5</span><span class="o">*</span><span class="nf">runif</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
<span class="w">    </span><span class="n">ref.val.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="n">frac.shft</span><span class="p">,</span><span class="n">frac.shft</span><span class="p">)</span><span class="o">*</span><span class="n">smp0.var</span>
<span class="p">}</span>

<span class="c1">## You may specify the reference value directly by giving a value to ref.val</span>

<span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ref.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref.val.v</span><span class="p">[</span><span class="n">ht.type</span><span class="p">]</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ref.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref.val.v</span><span class="p">[</span><span class="m">1</span><span class="o">+</span><span class="nf">rbinom</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">0.5</span><span class="p">)]</span>
<span class="p">}</span>

<span class="c1"># Output of sample data summaries and reference values</span>

<span class="n">df.c.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Test&quot;</span><span class="p">,</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="s">&quot;Sample&quot;</span><span class="p">)</span>
<span class="n">df.c.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Population Parameter&quot;</span><span class="p">,</span><span class="s">&quot;Alternative hypothesis&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Reference value&quot;</span><span class="p">,</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;Sample size&quot;</span><span class="p">)</span>

<span class="nf">if </span><span class="p">(</span><span class="n">ht.par</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">df.c.3.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Mean&quot;</span>
<span class="w">    </span><span class="n">add.vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">rbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="s">&quot;Mean&quot;</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%9.3f&quot;</span><span class="p">,</span><span class="n">mn.smp.2</span><span class="p">)),</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="s">&quot;Quasivariance&quot;</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%9.3f&quot;</span><span class="p">,</span><span class="n">var.smp.2</span><span class="p">))))</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="n">df.c.3.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$$H_1 : \\mu &gt; \\mu_0$$&quot;</span><span class="w"> </span><span class="n">else</span>
<span class="w">        </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="n">df.c.3.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$$H_1 : \\mu &lt; \\mu_0$$&quot;</span><span class="w"> </span><span class="n">else</span>
<span class="w">            </span><span class="n">df.c.3.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$$H_1 : \\mu \\not= \\mu_0$$&quot;</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.par</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">df.c.3.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Proportion&quot;</span>
<span class="w">    </span><span class="n">add.vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">rbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="s">&quot;Proportion&quot;</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%5.3f&quot;</span><span class="p">,</span><span class="n">pr.smp.2</span><span class="p">))))</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="n">df.c.3.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$$H_1 : p &gt; p_0$$&quot;</span><span class="w"> </span><span class="n">else</span>
<span class="w">        </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="n">df.c.3.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$$H_1 : p &lt; p_0$$&quot;</span><span class="w"> </span><span class="n">else</span>
<span class="w">            </span><span class="n">df.c.3.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$$H_1 : p \\not= p_0$$&quot;</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">df.c.3.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Variance&quot;</span>
<span class="w">    </span><span class="n">add.vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">rbind</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="s">&quot;Variance&quot;</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%9.3f&quot;</span><span class="p">,</span><span class="n">var.smp.2</span><span class="p">))))</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="n">df.c.3.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$$H_1 : \\sigma^2 &gt; \\sigma^2_0$$&quot;</span><span class="w"> </span><span class="n">else</span>
<span class="w">        </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="n">df.c.3.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$$H_1 : \\sigma^2 &lt; \\sigma^2_0$$&quot;</span><span class="w"> </span><span class="n">else</span>
<span class="w">            </span><span class="n">df.c.3.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;$$H_1 : \\sigma^2 \\not= \\sigma^2_0$$&quot;</span>
<span class="p">}</span>

<span class="n">df.c.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">df.c.3.1</span><span class="p">,</span><span class="n">df.c.3.2</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%9.3f&quot;</span><span class="p">,</span><span class="n">ref.val</span><span class="p">),</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%5.2f&quot;</span><span class="p">,</span><span class="n">sig.lvl</span><span class="p">),</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%5.0f&quot;</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="p">))</span>

<span class="n">mn.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">df.c.1</span><span class="p">,</span><span class="n">df.c.2</span><span class="p">,</span><span class="n">df.c.3</span><span class="p">))</span>
<span class="n">mn.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">Map</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">mn.val</span><span class="p">,</span><span class="n">add.vals</span><span class="p">))</span>

<span class="n">Data.hux</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">mn.val</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">Data.hux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Data.hux</span><span class="p">[</span><span class="m">-1</span><span class="p">,]</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="w">            </span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">,</span><span class="s">&quot;Test and sample values&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Test and sample values

-------  -----------------------  ------------------
   Test     Population Parameter          Proportion
          Alternative hypothesis   $$H_1 : p &lt; p_0$$
                 Reference value               0.376
              Significance level                0.05
 Sample              Sample size                  30
                      Proportion               0.300
-------  -----------------------  ------------------
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-3-perform-the-required-calculations-for-the-test-span">
<h3><span style="color:blue;">3. Perform the required calculations for the test</span><a class="headerlink" href="#span-style-color-blue-3-perform-the-required-calculations-for-the-test-span" title="Permalink to this headline">#</a></h3>
<p>The following cell presents the calculations required for the test, that is, the value of the statistic, the critical value, and the p-value of the test. The conclusion for this test is also shown at the end of the cell.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: Conducting the test and printing the results</span>

<span class="c1">## Computing the values required for the testing procedure</span>

<span class="nf">if </span><span class="p">(</span><span class="n">ht.par</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ht.val.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">mn.smp.2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ref.val</span><span class="p">)</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">var.smp.2</span><span class="o">/</span><span class="n">smp.sz.2</span><span class="p">)</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.2b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">ht.val.2a</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="o">*</span><span class="nf">pnorm</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">),</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.par</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ht.val.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">mn.smp.2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ref.val</span><span class="p">)</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">var.smp.2</span><span class="o">/</span><span class="n">smp.sz.2</span><span class="p">)</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pt</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pt</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="n">sig.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.2b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">ht.val.2a</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="o">*</span><span class="nf">pt</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">),</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.par</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ht.val.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">pr.smp.2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ref.val</span><span class="p">)</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">ref.val</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">ref.val</span><span class="p">)</span><span class="o">/</span><span class="n">smp.sz.2</span><span class="p">)</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">sig.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.2b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">ht.val.2a</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="o">*</span><span class="nf">pnorm</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">),</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">ht.val.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">)</span><span class="o">*</span><span class="n">var.smp.2</span><span class="o">/</span><span class="n">ref.val</span>
<span class="w">    </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pchisq</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pchisq</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ht.val.2a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="n">sig.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.2b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="n">sig.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pchisq</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pchisq</span><span class="p">(</span><span class="n">ht.val.1</span><span class="p">,</span><span class="n">smp.sz.2</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">        </span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="o">*</span><span class="nf">min</span><span class="p">(</span><span class="n">ht.val.3a</span><span class="p">,</span><span class="n">ht.val.3b</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">## Printing a summary of the results</span>

<span class="nf">if </span><span class="p">(</span><span class="n">ht.val.3</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">sig.lvl</span><span class="p">)</span><span class="w"> </span><span class="n">ht.val.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Reject H0&quot;</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="n">ht.val.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Fail to reject H0&quot;</span>

<span class="nf">if </span><span class="p">(</span><span class="n">ht.type</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">df.c.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Value of the test statistic&quot;</span><span class="p">,</span><span class="s">&quot;Critical value&quot;</span><span class="p">,</span><span class="s">&quot;P-value for the test&quot;</span><span class="p">,</span><span class="s">&quot;Test result&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">df.c.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%7.3f&quot;</span><span class="p">,</span><span class="n">ht.val.1</span><span class="p">),</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%7.3f&quot;</span><span class="p">,</span><span class="n">ht.val.2</span><span class="p">),</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%5.3f&quot;</span><span class="p">,</span><span class="n">ht.val.3</span><span class="p">),</span><span class="n">ht.val.4</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">df.c.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Value of the test statistic&quot;</span><span class="p">,</span><span class="s">&quot;Critical value 1&quot;</span><span class="p">,</span><span class="s">&quot;Critical value 2&quot;</span><span class="p">,</span><span class="s">&quot;P-value for the test&quot;</span><span class="p">,</span><span class="s">&quot;Test result&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">df.c.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%7.3f&quot;</span><span class="p">,</span><span class="n">ht.val.1</span><span class="p">),</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%7.3f&quot;</span><span class="p">,</span><span class="n">ht.val.2b</span><span class="p">),</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%7.3f&quot;</span><span class="p">,</span><span class="n">ht.val.2a</span><span class="p">),</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%5.3f&quot;</span><span class="p">,</span><span class="n">ht.val.3</span><span class="p">),</span><span class="n">ht.val.4</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">mn.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">df.c.1</span><span class="p">,</span><span class="n">df.c.2</span><span class="p">))</span>

<span class="n">Data.hux</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">mn.val</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">Data.hux</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Data.hux</span><span class="p">[</span><span class="m">-1</span><span class="p">,]</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>

<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">,</span><span class="s">&quot;Test results&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Test results

----------------------------  ------------------
 Value of the test statistic              -0.862
              Critical value              -1.645
        P-value for the test               0.194
                 Test result   Fail to reject H0
----------------------------  ------------------
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-the-errors-in-a-hypothesis-test-span">
<h2><span style="color:brown">The errors in a hypothesis test</span><a class="headerlink" href="#span-style-color-brown-the-errors-in-a-hypothesis-test-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>The errors in a hypothesis test play a crucial role in the definition of the test, and also in the choice of different statistics for a given test. In the following cells we will explore in some detail the characteristics and behavior of a test with respect to these errors.</p>
<p>As an illustration of the preceding comments, we will assume we are applying the procedure we have introduced to a test defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
H_0 &amp; : &amp; \mu \leq \mu_0 \\
H_1 &amp; : &amp; \mu &gt; \mu_0
\end{array}
\end{split}\]</div>
<p>An important goal is to illustrate that these errors cannot be avoided, but they can be controlled up to a point, in the case of the type II errors.</p>
<div class="section" id="span-style-color-blue-numerical-example-for-type-i-errors-span">
<h3><span style="color:blue;">Numerical example for type I errors</span><a class="headerlink" href="#span-style-color-blue-numerical-example-for-type-i-errors-span" title="Permalink to this headline">#</a></h3>
<p>The following cell shows the values of the statistic and the p-value for different samples, indicating with a red dot the cases in which we would be making a type I error.</p>
<p>This error is particularly relevant, as it is the one we wish to control in our design of the procedure. To study this error we have selected values of <span class="math notranslate nohighlight">\(\mu_0\)</span> such that <span class="math notranslate nohighlight">\(\mu &lt; \mu_0\)</span>, that is, where <span class="math notranslate nohighlight">\(H_0\)</span> is true for our example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: type I errors</span>

<span class="c1">## Parameters for the test (can be modified)</span>

<span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span>
<span class="n">smp.sz.prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span>
<span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span>

<span class="n">fr.dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span>

<span class="c1">## Other parameters</span>

<span class="n">smp.sz.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">smp.sz.prop</span><span class="o">*</span><span class="n">smp0.sz</span><span class="p">)</span>
<span class="n">mu.0.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fr.dist</span><span class="o">*</span><span class="n">smp0.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="n">t.q.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1">## Generate samples and estimates</span>

<span class="n">mn.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="w"> </span><span class="n">smp.sz.1</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">mn.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mn.smp.1</span><span class="p">,</span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp.1</span><span class="p">))</span>
<span class="w">    </span><span class="n">s.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">s.smp.1</span><span class="p">,</span><span class="nf">sd</span><span class="p">(</span><span class="n">v.smp.1</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">s.mn.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">vm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mn.smp.1</span><span class="p">,</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.smp.1</span><span class="p">)</span>

<span class="c1">## Distances based on the value of the statistic and the p-value</span>

<span class="n">v.t.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s.mn.1</span><span class="o">$</span><span class="n">vm</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0.1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">s.mn.1</span><span class="o">$</span><span class="n">vs</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz.1</span><span class="p">))</span>
<span class="n">err.v.t.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">v.t.1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">t.q.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>

<span class="n">t.s.mn.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.t.1</span><span class="p">,</span><span class="w"> </span><span class="n">errv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err.v.t.1</span><span class="p">)</span>
<span class="n">v.p.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">v.t.1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">err.v.p.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">v.p.1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">alpha</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="n">p.s.mn.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.p.1</span><span class="p">,</span><span class="w"> </span><span class="n">errv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err.v.p.1</span><span class="p">)</span>

<span class="n">plt.j.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t.s.mn.1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_jitter</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">t.s.mn.1</span><span class="o">$</span><span class="n">errv</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Values of test statistic&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">t.q.1</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>

<span class="n">plt.j.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p.s.mn.1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_jitter</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">p.s.mn.1</span><span class="o">$</span><span class="n">errv</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;p-values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.j.1</span><span class="p">,</span><span class="n">plt.j.2</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Distances to H0 from different samples&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>

<span class="c1">## Summary of numerical values</span>

<span class="n">mn.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0.1</span><span class="p">,</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">smp0.sd</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">t.q.1</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>
<span class="n">Data.hux</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">mn.val</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;mu 0&quot;</span><span class="p">,</span><span class="s">&quot;Population mean&quot;</span><span class="p">,</span><span class="s">&quot;Pop std dev&quot;</span><span class="p">,</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span><span class="s">&quot;Critical value&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Values for the example&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Values for the example

                      Values
-------------------  -------
mu 0                  74.381
Population mean       72.871
Pop std dev           33.076
Significance level       0.1
Critical value         1.282
</pre></div>
</div>
<img alt="_images/ad568b5ac946fc7af6d381364964bfe6d3766059392fbbb8b85a1e8a347250e9.png" src="_images/ad568b5ac946fc7af6d381364964bfe6d3766059392fbbb8b85a1e8a347250e9.png" />
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-numerical-example-for-type-ii-errors-span">
<h3><span style="color:blue;">Numerical example for type II errors</span><a class="headerlink" href="#span-style-color-blue-numerical-example-for-type-ii-errors-span" title="Permalink to this headline">#</a></h3>
<p>We repeat the preceding example for the case when <span class="math notranslate nohighlight">\(H_0\)</span> is not true, that is, when we select <span class="math notranslate nohighlight">\(\mu_0\)</span> so that <span class="math notranslate nohighlight">\(\mu &gt; \mu_0\)</span>. In the following plot we show the type II errors that we obtain for different samples, that is, we show as red dots the values corresponding to situations in which we would fail to reject the null hypothesis when we should, as <span class="math notranslate nohighlight">\(H_0\)</span> is false in this case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: type I errors</span>

<span class="c1">## Parameters for the test (can be modified)</span>

<span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span>
<span class="n">smp.sz.prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span>
<span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span>

<span class="n">fr.dist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>

<span class="c1">## Other parameters</span>

<span class="n">smp.sz.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">smp.sz.prop</span><span class="o">*</span><span class="n">smp0.sz</span><span class="p">)</span>
<span class="n">mu.0.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fr.dist</span><span class="o">*</span><span class="n">smp0.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="n">t.q.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>

<span class="c1">## Generate samples and estimates</span>

<span class="n">mn.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="w"> </span><span class="n">smp.sz.1</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">mn.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mn.smp.1</span><span class="p">,</span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp.1</span><span class="p">))</span>
<span class="w">    </span><span class="n">s.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">s.smp.1</span><span class="p">,</span><span class="nf">sd</span><span class="p">(</span><span class="n">v.smp.1</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">s.mn.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">vm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mn.smp.1</span><span class="p">,</span><span class="w"> </span><span class="n">vs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.smp.1</span><span class="p">)</span>

<span class="c1">## Distances based on the value of the statistic and the p-value</span>

<span class="n">v.t.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">s.mn.1</span><span class="o">$</span><span class="n">vm</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0.1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">s.mn.1</span><span class="o">$</span><span class="n">vs</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz.1</span><span class="p">))</span>
<span class="n">err.v.t.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">v.t.1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">t.q.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>

<span class="n">t.s.mn.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.t.1</span><span class="p">,</span><span class="w"> </span><span class="n">errv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err.v.t.1</span><span class="p">)</span>
<span class="n">v.p.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="n">v.t.1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">err.v.p.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">v.p.1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">alpha</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span>
<span class="n">p.s.mn.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.p.1</span><span class="p">,</span><span class="w"> </span><span class="n">errv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">err.v.p.1</span><span class="p">)</span>

<span class="n">plt.j.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t.s.mn.1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_jitter</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">t.s.mn.1</span><span class="o">$</span><span class="n">errv</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Values of test statistic&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">t.q.1</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>

<span class="n">plt.j.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p.s.mn.1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_jitter</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">p.s.mn.1</span><span class="o">$</span><span class="n">errv</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;p-values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.j.1</span><span class="p">,</span><span class="n">plt.j.2</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Distances to H0 from different samples&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>

<span class="c1">## Summary of numerical values</span>

<span class="n">mn.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0.1</span><span class="p">,</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">smp0.sd</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">t.q.1</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>
<span class="n">Data.hux</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">mn.val</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;mu 0&quot;</span><span class="p">,</span><span class="s">&quot;Population mean&quot;</span><span class="p">,</span><span class="s">&quot;Pop std dev&quot;</span><span class="p">,</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span><span class="s">&quot;Critical value&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Values for the example&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Values for the example

                      Values
-------------------  -------
mu 0                  60.793
Population mean       72.871
Pop std dev           33.076
Significance level       0.1
Critical value         1.282
</pre></div>
</div>
<img alt="_images/5f16ef024b448d37cc56daaf147d1f67abe107703074960de09d7a3dc3f08038.png" src="_images/5f16ef024b448d37cc56daaf147d1f67abe107703074960de09d7a3dc3f08038.png" />
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-the-power-function-of-a-test-span">
<h3><span style="color:brown">The power function of a test</span><a class="headerlink" href="#span-style-color-brown-the-power-function-of-a-test-span" title="Permalink to this headline">#</a></h3>
<p>In the preceding cells we have described how to conduct a hypothesis test to reach a conclusion for a given null hypothesis, based on the available data. The outcome of this procedure is affected by a series of choices:</p>
<ul class="simple">
<li><p>The definition of the null and alternative hypotheses, which we have commented before.</p></li>
<li><p>The significance level of the test.</p></li>
<li><p>Our selection of a test statistic (and its distribution), based on our assumptions on the data or on theoretical results. Different alternatives may be available for a given parameter, as we discussed in Lesson 1.</p></li>
</ul>
<p>In this section we will comment (briefly) on the criteria to select these two last items in the best possible manner. We will differentiate between better or poorer choices by looking at the magnitude of the errors associated both to our choices and the test procedure.</p>
<p>Remember that there are two possible types of errors in a test: the <span style="color:brown">type I error</span>, which happens when we reject <span class="math notranslate nohighlight">\(H_0\)</span> while it is true, and the <span style="color:brown">type II error</span>, when we fail to reject <span class="math notranslate nohighlight">\(H_0\)</span> but it is not true. Our preference would be to select a test that would yield very small probabilities for these two errors. It is important to remember that these probabilities change in opposite ways, that is, if we decrease one of the two probabilities, the other one will in general increase.</p>
<p>To find a balance between these two values, the usual approach is to fix the probability of a type I error for a given test, by setting this probability equal to some preferred value, the significance level. That is, when we specify the significance level for a test we are indicating how large a probability of a type I error we are willing to accept. Or in other words, what is an acceptable proportion of cases in which we would end up rejecting the null hypothesis when it is true.</p>
<p>Given this option, the second probability, that of a type II error, will take a value that is also a consequence of the particular type of test we have selected. And this value cannot be controlled beyond our choice of a test statistic, given the characteristics of the data.</p>
<p>If we wish to analyze how efficient a test is, we need to determine the value of this probability of a type II error, which we have denoted as <span class="math notranslate nohighlight">\(\beta\)</span>. The smaller it is, the better the test. In practice it is more common to work with the <span style="color:brown">power of the test</span>, a function defined as the value of <span class="math notranslate nohighlight">\(1 - \beta\)</span>, one minus the probability of a type II error. Given this definition, we would prefer to use a test having the largest possible value of the power.</p>
<p>The power of a test is defined as a function of the true value of the parameter, as the probability of this error depends on how far this value is from the null hypothesis of the test. We expect this probability to be higher when we are very far from the null hypothesis, as in that case, when <span class="math notranslate nohighlight">\(\mu = \mu_1\)</span> and <span class="math notranslate nohighlight">\(\mu_1\)</span> is very different from <span class="math notranslate nohighlight">\(\mu_0\)</span>, it should be much easier to obtain evidence showing that (with high probability) the data cannot have been generated from a population having <span class="math notranslate nohighlight">\(\mu = \mu_0\)</span>.</p>
</div>
<div class="section" id="span-style-color-brown-computing-the-power-of-a-test-span">
<h3><span style="color:brown">Computing the power of a test</span><a class="headerlink" href="#span-style-color-brown-computing-the-power-of-a-test-span" title="Permalink to this headline">#</a></h3>
<p>The power of a test is a probability which depends on the test statistic and the definition of the test, as well as on the true value of the parameter. We now present some examples of procedures to compute the value of this function, depending on the true value of <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<p>To compute this function we start from the definition of the power of a test: the probability of rejecting the null hypothesis if the true value of the parameter <span class="math notranslate nohighlight">\(\theta\)</span> is not in the region corresponding to that null hypothesis. As we have commented, this probability will be a function of the true value of the parameter <span class="math notranslate nohighlight">\(\theta = \theta_1\)</span>. In particular, if the true value of the parameter <span class="math notranslate nohighlight">\(\theta_1\)</span> is very far from the reference value defining the null hypothesis, <span class="math notranslate nohighlight">\(\theta_0\)</span>, it should be very easy to identify this situation by looking at the data, as our sample observations should take values close to <span class="math notranslate nohighlight">\(\theta_1\)</span> and far from <span class="math notranslate nohighlight">\(\theta_0\)</span>. While if the true value <span class="math notranslate nohighlight">\(\theta_1\)</span> is very close to <span class="math notranslate nohighlight">\(\theta_0\)</span>, it may be difficult to differentiate between <span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_0\)</span> based on the sample data, as the values in the sample will be close to <span class="math notranslate nohighlight">\(\theta_1\)</span>, but they will also be close to <span class="math notranslate nohighlight">\(\theta_0\)</span>.</p>
<p>Formally, for a value of the parameter <span class="math notranslate nohighlight">\(\theta_1\)</span> corresponding to the alternative hypothesis, we define the power of the test as</p>
<div class="math notranslate nohighlight">
\[
\mbox{power} (\theta_1) = \Pr( \mbox{reject } H_0 | \theta = \theta_1 ) .
\]</div>
<p>For example, in the particular case when the null hypothesis is given by <span class="math notranslate nohighlight">\(H_0 : \mu \leq \mu_0\)</span> and we have normal data, the definition would be:</p>
<div class="math notranslate nohighlight">
\[
\mbox{power} (\mu_1) = \Pr\left( \frac{\bar X - \mu_0}{S/\sqrt{n}} &gt; t_{n-1;\alpha} \; \Bigl| \; \mu = \mu_1 \right) , \qquad \frac{\bar X - \mu_1}{S/\sqrt{n}} \sim t_{n-1}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_1\)</span> denotes the true value of the parameter <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<p>The computation of this power function requires following several steps:</p>
<ol class="arabic">
<li><p>Write the probability of interest in terms of the test statistic and the definition of the rejection region for the test.</p></li>
<li><p>Identify the distribution to be used to compute this probability.</p></li>
<li><p>In the evaluation of the test we assume a distribution for the statistic when <span class="math notranslate nohighlight">\(\theta = \theta_0\)</span>, that is, we assume that <span class="math notranslate nohighlight">\(H_0\)</span> is true. The rejection region is then defined in terms of this statistic and the quantiles of its distribution.</p>
<p>But to compute the power, the distribution for the test statistic will be correct when <span class="math notranslate nohighlight">\(\theta = \theta_1\)</span>, that is, when the parameter takes its true value. We need to rewrite the probability used to define the power, based on the rejection region and written in terms of <span class="math notranslate nohighlight">\(\theta = \theta_0\)</span>, as another probability in terms of the corresponding statistic when <span class="math notranslate nohighlight">\(\theta = \theta_1\)</span>.</p>
</li>
<li><p>The last step is to compute the desired probability, the power, from the distribution of the statistic and the values of the parameters and estimates.</p></li>
</ol>
<p>For example, for the case when <span class="math notranslate nohighlight">\(H_0 : \sigma^2 \leq \sigma_0^2\)</span> and assuming normal observations, the power of the test for <span class="math notranslate nohighlight">\(\sigma^2 = \sigma_1^2\)</span> can be obtained through the following steps:</p>
<ol class="arabic simple">
<li><p>Using the definition of the rejection rgion, the probability we wish to compute is:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\mbox{power} (\sigma_1^2) &amp; = &amp; \Pr( \mbox{reject } H_0 | \sigma^2 = \sigma_1^2 ) \\
&amp; = &amp; \displaystyle \Pr\left( \frac{(n-1)S^2}{\sigma_0^2} &gt; \chi^2_{n-1;\alpha} \; \Bigl| \; \sigma^2 = \sigma^2_1 \right)
\end{array}
\end{split}\]</div>
<ol class="arabic simple" start="2">
<li><p>The distribution we will use to compute this probability, corresponding to the true value of the parameter <span class="math notranslate nohighlight">\(\sigma_1^2\)</span>, is:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\frac{(n-1)S^2}{\sigma_1^2} \sim \chi^2_{n-1}
\]</div>
<ol class="arabic simple" start="3">
<li><p>and 4. The probability defining the power, written in terms of this distribution, is</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\mbox{power} (\sigma_1^2) &amp; = &amp; \displaystyle \Pr\left( \frac{(n-1)S^2}{\sigma_0^2} &gt; \chi^2_{n-1;\alpha} \right) = \Pr\left( \frac{(n-1)S^2}{\sigma_1^2} \frac{\sigma_1^2}{\sigma_0^2} &gt; \chi^2_{n-1;\alpha} \right) \\
&amp; = &amp; \displaystyle \Pr\left( \frac{(n-1)S^2}{\sigma_1^2} &gt; \chi^2_{n-1;\alpha} \frac{\sigma_0^2}{\sigma_1^2} \right) = \Pr\left( \chi^2_{n-1} &gt; \chi^2_{n-1;\alpha} \frac{\sigma_0^2}{\sigma_1^2} \right)
\end{array}
\end{split}\]</div>
<p>Summarizing our previous comments, the power of a test will in general depend on the hypotheses of the test, the statistic we use and its distribution (and in particular on the sample size), the confidence level of the test and the true value of the parameter <span class="math notranslate nohighlight">\(\theta_1\)</span>. It will also be an increasing function as the true value of the parameter moves away from the null hypothesis.</p>
<div class="section" id="id10">
<h4><span style="color:green;">Questions</span><a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h4>
<p><span style="color:green">Answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">Compute the power of the test for a one-sided hypothesis test on the population variance, when <span class="math notranslate nohighlight">\(\sigma^2_0 = 2\)</span> and the true value of the parameter is <span class="math notranslate nohighlight">\(\sigma^2_1 = 3\)</span>. Repeat the calculation for <span class="math notranslate nohighlight">\(\sigma^2_1 = 4\)</span>.</span></p></li>
<li><p><span style="color:green">What is the value of the power of a test when <span class="math notranslate nohighlight">\(\theta_1 \rightarrow \theta_0\)</span>?</span></p></li>
<li><p><span style="color:green">Compute the power of the test for a ons-sided hypothesis test on the population proportion, when <span class="math notranslate nohighlight">\(p = p_0\)</span> and the true value is <span class="math notranslate nohighlight">\(p = p_1 &gt; p_0\)</span>.</span></p></li>
</ul>
</div>
<div class="section" id="id11">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h4>
<p><em>The manufacturer of a certain precision component is required to ensure that the variability (standard deviation) in one of the characteristics of a given component does not exceed <span class="math notranslate nohighlight">\(0.2\)</span> mm. The manufacturer has collected a sample of 12 measurements from different components, with a sample quasivariance equal to <span class="math notranslate nohighlight">\(s^2 = 0.06562\)</span>.</em></p>
<p><em>The manufacturer would like to test if the information in the sample would imply that the manufacturing process is not working within the desired tolerance, with a significance level of 5%. To understand the errors associated to this test, the manufacturer would like to know what is the power of the test if the true value of <span class="math notranslate nohighlight">\(\sigma\)</span> is <span class="math notranslate nohighlight">\(0.25\)</span>.</em></p>
<p><em>You may assume that the data follow a normal distribution.</em></p>
<div class="section" id="id12">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h5>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> denote the random variable corresponding to the value of the characteristic of interest. We wish to conduct a hypothesis test on the value of <span class="math notranslate nohighlight">\(\sigma_X\)</span>, or on <span class="math notranslate nohighlight">\(\sigma_X^2\)</span>, as this is an slightly simpler option. The hypothesis test we wish to study is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
   H_0 &amp; : &amp; \sigma_X^2 \leq 0.2^2 = \sigma_0^2 \\
   H_1 &amp; : &amp; \sigma_X^2 &gt; 0.04
\end{array}
\end{split}\]</div>
<p>The alternative hypothesis for this test has been selected in the direction of the sample data, and also in the direction of the (assumed) true value of the parameter.</p>
<p>The statistic for this test, as we study a population variance from a sample with normal data, is</p>
<div class="math notranslate nohighlight">
\[
T = \frac{(n-1)S_x^2}{\sigma^2} \sim \chi^2_{n-1}
\]</div>
<p>and the rejection region for the test, for a significance level <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>, is</p>
<div class="math notranslate nohighlight">
\[
\text{RR}_{0.05} = \left\{ (x_1,\ldots ,x_n) \; | \; t_0 &gt; \chi^2_{n-1;\alpha} = \chi^2_{11;0.05} = 19.675 \right\}
\]</div>
<p>where <span class="math notranslate nohighlight">\(t_0 = (n-1)s_x^2/\sigma_0^2\)</span>, the value of the test statistic assuming that <span class="math notranslate nohighlight">\(H_0\)</span> is true.</p>
<p>The power for this test for <span class="math notranslate nohighlight">\(\sigma = \sigma_1 = 0.25\)</span>, or equivalently <span class="math notranslate nohighlight">\(\sigma^2 = \sigma_1^2 = 0.0625\)</span>, is defined as</p>
<div class="math notranslate nohighlight">
\[
\text{power} (\mu) = \Pr \left( \text{reject } H_0 \; |\; \sigma^2 = \sigma_1^2 = 0.0625 \right) = \Pr \left( \frac{(n-1)S_x^2}{\sigma_0^2} &gt; 19.675 \; |\; \sigma^2 = 0.0625 \right)
\]</div>
<p>If the true value of the parameter is <span class="math notranslate nohighlight">\(\sigma_1^2 = 0.0625\)</span>, it is no longer true that <span class="math notranslate nohighlight">\((n-1)S_x^2/\sigma_0^2 \sim \chi^2_{n-1}\)</span>, and now it holds that</p>
<div class="math notranslate nohighlight">
\[
\frac{(n-1)S_x^2}{\sigma_1^2} \sim \chi^2_{11}
\]</div>
<p>We need to use this distribution to compute the probability defining the power. We rewrite the condition in the definition of the power in terms of the known distribution (which now is the statistic written using <span class="math notranslate nohighlight">\(\sigma_1^2\)</span> instead of <span class="math notranslate nohighlight">\(\sigma_0^2\)</span>),</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\text{power} (\mu) &amp; = &amp; \displaystyle \Pr \left( \frac{(n-1)S_x^2}{\sigma_1^2} \frac{\sigma_1^2}{\sigma_0^2} &gt; 19.675 \right) = \Pr \left( \chi_{11} &gt; 19.675 \frac{\sigma_0^2}{\sigma_1^2} \right) \\
&amp; = &amp; \Pr \left( \chi_{11} &gt; 12.592 \right) = 0.3208
\end{array}
\end{split}\]</div>
<p>In this case our null hypothesis is incorrect, as <span class="math notranslate nohighlight">\(\sigma_1^2 = 0.0625 &gt; \sigma_0^2 = 0.04\)</span>.
The probability of rejecting the null hypothesis when <span class="math notranslate nohighlight">\(\sigma^2 = \sigma_1^2\)</span> equals <span class="math notranslate nohighlight">\(0.3208\)</span>, which is not a very high probability. Note that we would like this value to be close to one.</p>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-examples-of-power-functions-span">
<h3><span style="color:blue;">Examples of power functions</span><a class="headerlink" href="#span-style-color-blue-examples-of-power-functions-span" title="Permalink to this headline">#</a></h3>
<p>We represent in the following cell the shape of the power functions for a few cases corresponding to situations we have covered in this lesson.</p>
<p>These results are based on exact representations of the power functions, although in the case of the tests on the population mean some special procedures have been required to obtain these values, see <span class="xref myst">Appendix 1</span>.</p>
<p>The cases presented in the following plots are:</p>
<ul class="simple">
<li><p>Tests on the population mean, for the normal case (with <span class="math notranslate nohighlight">\(\sigma^2 = 2\)</span>), simulated,</p>
<ul>
<li><p>Plot 1. A one-sided left test <span class="math notranslate nohighlight">\(H_0 : \mu \leq 4\)</span></p></li>
<li><p>Plot 2. A one-sided right test <span class="math notranslate nohighlight">\(H_0 : \mu \geq 4\)</span></p></li>
<li><p>Plot 3. A two-sided test <span class="math notranslate nohighlight">\(H_0 : \mu = 4\)</span></p></li>
</ul>
</li>
<li><p>Tests on the population variance, for the normal case</p>
<ul>
<li><p>Plot 4. A one-sided left test <span class="math notranslate nohighlight">\(H_0 : \sigma^2 \leq 2\)</span></p></li>
<li><p>Plot 5. A one-sided right test <span class="math notranslate nohighlight">\(H_0 : \sigma^2 \geq 2\)</span></p></li>
<li><p>Plot 6. A two-sided test <span class="math notranslate nohighlight">\(H_0 : \sigma^2 = 2\)</span></p></li>
</ul>
</li>
</ul>
<p>In the following code cell, the value of the significance level for the test can be modified in the variable <span style="color:blue;font-family:monospace;font-size:90%;">sig.lvl</span>, and the sample size can be modified in the variable <span style="color:blue;font-family:monospace;font-size:90%;">smp.sz</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: Power functions</span>

<span class="c1"># Tests on the mean</span>

<span class="c1">## These parameters can be modified</span>

<span class="n">sig.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span>
<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>

<span class="n">mu.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>
<span class="n">sig2.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>

<span class="c1">## Results obtained by conditioning of the value of the quasivariance</span>

<span class="n">crit.val.r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">crit.val.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="n">crit.val.bu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="n">sig.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">crit.val.bl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="n">sig.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">int.lim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="n">xlm.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">int.lim</span>
<span class="n">xlm.u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">int.lim</span>
<span class="n">x.seq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="n">xlm.l</span><span class="p">,</span><span class="n">xlm.u</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="m">100</span><span class="p">)</span>

<span class="n">int.fn.r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">delta</span><span class="p">,</span><span class="n">sig2</span><span class="p">,</span><span class="n">sm.s</span><span class="p">,</span><span class="n">cv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="nf">pt</span><span class="p">(</span><span class="n">cv</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">delta</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sig2</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">sm.s</span><span class="o">*</span><span class="p">(</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">))),</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="o">*</span><span class="nf">dchisq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">)}</span>
<span class="n">int.fn.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">delta</span><span class="p">,</span><span class="n">sig2</span><span class="p">,</span><span class="n">sm.s</span><span class="p">,</span><span class="n">cv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="nf">pt</span><span class="p">(</span><span class="n">cv</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">delta</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sig2</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">sm.s</span><span class="o">*</span><span class="p">(</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">))),</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="o">*</span><span class="nf">dchisq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">)}</span>
<span class="n">int.fn.b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">delta</span><span class="p">,</span><span class="n">sig2</span><span class="p">,</span><span class="n">sm.s</span><span class="p">,</span><span class="n">cv.u</span><span class="p">,</span><span class="n">cv.l</span><span class="p">)</span><span class="w"> </span><span class="p">{(</span><span class="nf">pt</span><span class="p">(</span><span class="n">cv.u</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">delta</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sig2</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">sm.s</span><span class="o">*</span><span class="p">(</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">))),</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                              </span><span class="nf">pt</span><span class="p">(</span><span class="n">cv.l</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">delta</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sig2</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">sm.s</span><span class="o">*</span><span class="p">(</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">))),</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span><span class="o">*</span><span class="nf">dchisq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">)}</span>

<span class="n">pwr.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">mu.1</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">x.seq</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pwr.val.r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">integrate</span><span class="p">(</span><span class="n">int.fn.r</span><span class="p">,</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="w"> </span><span class="n">sig2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig2.0</span><span class="p">,</span><span class="w"> </span><span class="n">sm.s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crit.val.r</span><span class="p">)</span><span class="o">$</span><span class="n">value</span>
<span class="w">    </span><span class="n">pwr.val.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">integrate</span><span class="p">(</span><span class="n">int.fn.l</span><span class="p">,</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="w"> </span><span class="n">sig2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig2.0</span><span class="p">,</span><span class="w"> </span><span class="n">sm.s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crit.val.l</span><span class="p">)</span><span class="o">$</span><span class="n">value</span>
<span class="w">    </span><span class="n">pwr.val.b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">integrate</span><span class="p">(</span><span class="n">int.fn.b</span><span class="p">,</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="w"> </span><span class="n">sig2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig2.0</span><span class="p">,</span><span class="w"> </span><span class="n">sm.s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">cv.u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crit.val.bu</span><span class="p">,</span><span class="w"> </span><span class="n">cv.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crit.val.bl</span><span class="p">)</span><span class="o">$</span><span class="n">value</span>
<span class="w">    </span><span class="n">pwr.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="n">pwr.val</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.1</span><span class="p">,</span><span class="n">pwr.val.r</span><span class="p">,</span><span class="n">pwr.val.l</span><span class="p">,</span><span class="n">pwr.val.b</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">pwr.mu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">pwr.val</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">pwr.mu</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;val&quot;</span><span class="p">,</span><span class="s">&quot;tr&quot;</span><span class="p">,</span><span class="s">&quot;tl&quot;</span><span class="p">,</span><span class="s">&quot;tb&quot;</span><span class="p">)</span>

<span class="c1">## Plots of power functions for the mean</span>

<span class="n">plt.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pwr.mu</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tr</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0</span><span class="p">),</span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;solid&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;mu_0&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="n">xlm.l</span><span class="m">+0.3</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Power function for a left one-sided test (mean)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;True value of the parameter&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="n">plt.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pwr.mu</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tl</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0</span><span class="p">),</span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;solid&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;mu_0&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="n">xlm.l</span><span class="m">+0.3</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Power function for a right one-sided test (mean)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;True value of the parameter&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="n">plt.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pwr.mu</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tb</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0</span><span class="p">),</span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;solid&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;mu_0&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="n">xlm.l</span><span class="m">+0.3</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Power function for a two-sided test (mean)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;True value of the parameter&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.1</span><span class="p">,</span><span class="n">plt.2</span><span class="p">,</span><span class="n">plt.3</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Power functions for a test on the population mean&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>

<span class="c1">## Plots of power functions for the variance</span>

<span class="n">plt.fct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>
<span class="n">xlm.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="n">xlm.u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt.fct</span><span class="o">*</span><span class="n">sig2.0</span>
<span class="n">xlm.inc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">xlm.u</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xlm.l</span><span class="p">)</span><span class="o">/</span><span class="m">100</span>

<span class="n">cv.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">cv.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">cv.3l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="n">sig.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="n">cv.3u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="n">sig.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>

<span class="n">sim.p.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">v.mu</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="n">xlm.l</span><span class="p">,</span><span class="n">xlm.u</span><span class="p">,</span><span class="n">xlm.inc</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">p.smp.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pchisq</span><span class="p">(</span><span class="n">cv.1</span><span class="o">*</span><span class="n">sig2.0</span><span class="o">/</span><span class="n">v.mu</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">p.smp.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pchisq</span><span class="p">(</span><span class="n">cv.2</span><span class="o">*</span><span class="n">sig2.0</span><span class="o">/</span><span class="n">v.mu</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">    </span><span class="n">p.smp.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pchisq</span><span class="p">(</span><span class="n">cv.3u</span><span class="o">*</span><span class="n">sig2.0</span><span class="o">/</span><span class="n">v.mu</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">pchisq</span><span class="p">(</span><span class="n">cv.3l</span><span class="o">*</span><span class="n">sig2.0</span><span class="o">/</span><span class="n">v.mu</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="w">    </span><span class="n">sim.p.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="n">sim.p.2</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="n">v.mu</span><span class="p">,</span><span class="n">p.smp.1</span><span class="p">,</span><span class="n">p.smp.2</span><span class="p">,</span><span class="n">p.smp.3</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">pwr.sig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">sim.p.2</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">pwr.sig</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;val&quot;</span><span class="p">,</span><span class="s">&quot;tl&quot;</span><span class="p">,</span><span class="s">&quot;tr&quot;</span><span class="p">,</span><span class="s">&quot;tb&quot;</span><span class="p">)</span>

<span class="n">plt.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pwr.sig</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tl</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">sig2.0</span><span class="p">),</span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;solid&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;sigma2_0&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">sig2.0</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="n">xlm.l</span><span class="m">+0.3</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Power function for a left one-sided test (variance)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;True value of the parameter&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="n">plt.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pwr.sig</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tr</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">sig2.0</span><span class="p">),</span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;solid&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;sigma2_0&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">sig2.0</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="n">xlm.l</span><span class="m">+0.3</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Power function for a right one-sided test (variance)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;True value of the parameter&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="n">plt.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pwr.sig</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">tb</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">sig2.0</span><span class="p">),</span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;solid&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;sigma2_0&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">sig2.0</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="n">xlm.l</span><span class="m">+0.3</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Power function for a two-sided test (variance)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;True value of the parameter&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.1</span><span class="p">,</span><span class="n">plt.2</span><span class="p">,</span><span class="n">plt.3</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Power functions for a test on the population variance&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7527a2061677165d05dd2dc0289c35624838fca7ddbd1f04cc782812eb49e6c6.png" src="_images/7527a2061677165d05dd2dc0289c35624838fca7ddbd1f04cc782812eb49e6c6.png" />
<img alt="_images/629d3d30dbe96f4b304e5e41015ceb8337935c34041afc184a5073a3f108abda.png" src="_images/629d3d30dbe96f4b304e5e41015ceb8337935c34041afc184a5073a3f108abda.png" />
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-impact-of-the-sample-size-on-the-power-function-of-a-test-span">
<h3><span style="color:brown">Impact of the sample size on the power function of a test</span><a class="headerlink" href="#span-style-color-brown-impact-of-the-sample-size-on-the-power-function-of-a-test-span" title="Permalink to this headline">#</a></h3>
<p>We have mentioned in the preceding cells that the power of a test depends on the sample size. Intuitively, if we would have more information available we should make smaller errors, everything else being the same.</p>
<p>Formally, for the particular case of a test on the variance with normal data and <span class="math notranslate nohighlight">\(H_0 : \sigma^2 \leq \sigma_0^2\)</span>, we have seen that the power of the test for <span class="math notranslate nohighlight">\(\sigma^2 = \sigma_1^2 &gt; \sigma_0^2\)</span> will be given by</p>
<div class="math notranslate nohighlight">
\[
\mbox{power} (\sigma_1^2) = \Pr\left( \chi^2_{n-1} &gt; \chi^2_{n-1;\alpha} \frac{\sigma_0^2}{\sigma_1^2} \right)
\]</div>
<p>Assume we would like to have a power of the test larger than a certain value <span class="math notranslate nohighlight">\(\beta\)</span>, for given values of <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\sigma_0^2\)</span> and <span class="math notranslate nohighlight">\(\sigma_1^2\)</span>. We need</p>
<div class="math notranslate nohighlight">
\[
\Pr\left( \chi^2_{n-1} &gt; \chi^2_{n-1;\alpha} \frac{\sigma_0^2}{\sigma_1^2} \right) &gt; \beta \ \Rightarrow \ \chi^2_{n-1;\alpha} \frac{\sigma_0^2}{\sigma_1^2} &lt; \chi^2_{n-1;\beta} \ \Rightarrow \ \frac{\chi^2_{n-1;\alpha}}{\chi^2_{n-1;\beta}} &lt; \frac{\sigma_1^2}{\sigma_0^2} 
\]</div>
<p>and we could find acceptable values of the sample size by trying values of the quantiles of a chi squared distribution for different values of <span class="math notranslate nohighlight">\(n\)</span> until we find the first value that satisfies the preceding condition.</p>
<div class="section" id="id13">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h4>
<p><em>The manufacturer of a certain precision component is required to ensure that the variability (standard deviation) in one of the characteristics of a given component does not exceed <span class="math notranslate nohighlight">\(0.2\)</span> mm. The manufacturer has collected a sample of 12 measurements from different components, with a sample quasivariance equal to <span class="math notranslate nohighlight">\(s^2 = 0.06562\)</span>.</em></p>
<p><em>The manufacturer would like to increase the power of the test (reduce the probability of a type II error) when the true value of <span class="math notranslate nohighlight">\(\sigma\)</span> is <span class="math notranslate nohighlight">\(0.25\)</span>, to a value of at least <span class="math notranslate nohighlight">\(0.7\)</span>, for a significance level of 5%. To achieve this, they are willing to increase the sample size of the sample used in the study. Which would be the smallest sample size that will ensure this power for the test?</em></p>
<p><em>You may assume that the data follow a normal distribution.</em></p>
<div class="section" id="id14">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h5>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> denote the random variable corresponding to the value of the characteristic of interest. Our hypothesis test is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
   H_0 &amp; : &amp; \sigma_X^2 \leq 0.2^2 = \sigma_0^2 \\
   H_1 &amp; : &amp; \sigma_X^2 &gt; 0.04
\end{array}
\end{split}\]</div>
<p>The statistic for this test is</p>
<div class="math notranslate nohighlight">
\[
T = \frac{(n-1)S_x^2}{\sigma^2} \sim \chi^2_{n-1}
\]</div>
<p>and the rejection region for the test, for a significance level <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span> and for any sample size <span class="math notranslate nohighlight">\(n\)</span>, is</p>
<div class="math notranslate nohighlight">
\[
\text{RR}_{0.05} = \left\{ (x_1,\ldots ,x_n) \; | \; t_0 &gt; \chi^2_{n-1;\alpha} = \chi^2_{n-1;0.05} \right\}
\]</div>
<p>where <span class="math notranslate nohighlight">\(t_0 = (n-1)s_x^2/\sigma_0^2\)</span>.</p>
<p>The power for this test for <span class="math notranslate nohighlight">\(\sigma = \sigma_1 = 0.25\)</span>, or equivalently <span class="math notranslate nohighlight">\(\sigma^2 = \sigma_1^2 = 0.0625\)</span>, is defined as</p>
<div class="math notranslate nohighlight">
\[
\text{power} (\mu) = \Pr \left( \text{reject } H_0 \; |\; \sigma^2 = \sigma_1^2 = 0.0625 \right) = \Pr \left( \frac{(n-1)S_x^2}{\sigma_0^2} &gt; \chi^2_{n-1;0.05} \; |\; \sigma^2 = 0.0625 \right)
\]</div>
<p>If the true value of the parameter is <span class="math notranslate nohighlight">\(\sigma_1^2 = 0.0625\)</span>, it is no longer true that <span class="math notranslate nohighlight">\((n-1)S_x^2/\sigma_0^2 \sim \chi^2_{n-1}\)</span>, and now it holds that</p>
<div class="math notranslate nohighlight">
\[
\frac{(n-1)S_x^2}{\sigma_1^2} \sim \chi^2_{n-1}
\]</div>
<p>We rewrite the condition in the probability defining the power in terms of the known distribution (which now is the statistic written using <span class="math notranslate nohighlight">\(\sigma_1^2\)</span> instead of <span class="math notranslate nohighlight">\(\sigma_0^2\)</span>),
$<span class="math notranslate nohighlight">\(
\text{power} (\mu) = \Pr \left( \frac{(n-1)S_x^2}{\sigma_1^2} \frac{\sigma_1^2}{\sigma_0^2} &gt; \chi^2_{n-1;0.05} \right) = \Pr \left( \chi_{n-1} &gt; \chi^2_{n-1;0.05} \frac{\sigma_0^2}{\sigma_1^2} \right)
\)</span>$</p>
<p>If we now impose the condition that the power should be at least <span class="math notranslate nohighlight">\(0.7\)</span>, we have (we translate the condition on the probability to a condition on quantiles),</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\text{power} (\mu) &amp; = &amp; \displaystyle \Pr \left( \chi_{n-1} &gt; \chi^2_{n-1;0.05} \frac{\sigma_0^2}{\sigma_1^2} \right) \geq 0.7 \Rightarrow \chi^2_{n-1;0.05} \frac{\sigma_0^2}{\sigma_1^2} \leq \chi^2_{n-1;0.7} \Rightarrow \frac{\chi^2_{n-1;0.05}}{\chi^2_{n-1;0.7}} \\
&amp; \leq &amp; \displaystyle \frac{\sigma_1^2}{\sigma_0^2} = \frac{0.0625}{0.04} = 1.5625
\end{array}
\end{split}\]</div>
<p>Using R to generate the values of the quantiles in the preceding formula, we obtain (see the following cell) that the requested answer is <span class="math notranslate nohighlight">\(n \geq 46\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exercise calculations. Sample sizes and power of hypothesis tests</span>

<span class="n">pwr.d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span>
<span class="n">sig.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span>

<span class="n">sg.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="o">^</span><span class="m">2</span>
<span class="n">sg.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span><span class="o">^</span><span class="m">2</span>
<span class="n">ref.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sg.1</span><span class="o">/</span><span class="n">sg.0</span>

<span class="n">n.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">40</span>
<span class="n">n.mx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span>
<span class="n">pwr.res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i.n</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">n.mn</span><span class="o">:</span><span class="n">n.mx</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">q.n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="n">sig.l</span><span class="p">,</span><span class="n">i.n</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">q.d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="n">pwr.d</span><span class="p">,</span><span class="n">i.n</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">pwr.res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="n">pwr.res</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="n">i.n</span><span class="p">,</span><span class="n">ref.v</span><span class="p">,</span><span class="n">q.n</span><span class="o">/</span><span class="n">q.d</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">pwr.res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">pwr.res</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">pwr.res</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Sample size&quot;</span><span class="p">,</span><span class="s">&quot;Ratio of variances&quot;</span><span class="p">,</span><span class="s">&quot;Ratio of quantiles&quot;</span><span class="p">)</span>

<span class="nf">table_prnt</span><span class="p">(</span><span class="n">pwr.res</span><span class="p">,</span><span class="s">&quot;Exercise results&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Exercise results

 Sample size   Ratio of variances   Ratio of quantiles
------------  -------------------  -------------------
          40               1.5625             1.608304
          41               1.5625             1.598950
          42               1.5625             1.589988
          43               1.5625             1.581393
          44               1.5625             1.573140
          45               1.5625             1.565208
          46               1.5625             1.557577
          47               1.5625             1.550229
          48               1.5625             1.543148
          49               1.5625             1.536317
          50               1.5625             1.529723
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-power-functions-and-sample-sizes-span">
<h4><span style="color:blue;">Power functions and sample sizes</span><a class="headerlink" href="#span-style-color-blue-power-functions-and-sample-sizes-span" title="Permalink to this headline">#</a></h4>
<p>As a practical illustration, the following cell plots the power functions for two cases (one-sided tests for the mean and the variance with normal data) and different sample sizes.</p>
<p>In these plots, the value of the significance level of the test can be modified in the variable <span style="color:blue;font-family:monospace;font-size:90%;">sig.lvl</span>, and the sample sizes used in the comparison can be modified in the variable <span style="color:blue;font-family:monospace;font-size:90%;">smp.sz.v</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Hypothesis testing: Power functions and sample sizes. </span>

<span class="c1">## Tests on the mean</span>

<span class="c1">### These parameters can be modified</span>

<span class="n">sig.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span>
<span class="n">smp.sz.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="m">40</span><span class="p">,</span><span class="m">100</span><span class="p">)</span>

<span class="n">mu.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span>
<span class="n">sig2.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span>

<span class="c1">### Colors for the plots</span>

<span class="n">col.v.gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;#619CFF&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#00BFC4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#00BF7D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#33CCCC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#33FFCC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#99CCFF&quot;</span><span class="p">)</span>
<span class="n">col.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v.gen</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">smp.sz.v</span><span class="p">)]</span>

<span class="c1">### Computing the power by conditioning on the values of the quasivariance</span>

<span class="n">int.lim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.2</span>
<span class="n">xlm.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">int.lim</span>
<span class="n">xlm.u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">int.lim</span>
<span class="n">x.seq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="n">xlm.l</span><span class="p">,</span><span class="n">xlm.u</span><span class="p">,</span><span class="n">length.out</span><span class="o">=</span><span class="m">100</span><span class="p">)</span>

<span class="n">int.fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">delta</span><span class="p">,</span><span class="n">sig2</span><span class="p">,</span><span class="n">sm.s</span><span class="p">,</span><span class="n">cv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="nf">pt</span><span class="p">(</span><span class="n">cv</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">delta</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sig2</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">sm.s</span><span class="o">*</span><span class="p">(</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">))),</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="o">*</span><span class="nf">dchisq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">sm.s</span><span class="m">-1</span><span class="p">)}</span>

<span class="n">sim.pl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i.s</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">smp.sz.v</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz.v</span><span class="p">[</span><span class="n">i.s</span><span class="p">]</span>
<span class="w">    </span><span class="n">crit.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="nf">for </span><span class="p">(</span><span class="n">mu.1</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">x.seq</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">pwr.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">integrate</span><span class="p">(</span><span class="n">int.fn</span><span class="p">,</span><span class="w"> </span><span class="n">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">Inf</span><span class="p">,</span><span class="w"> </span><span class="n">delta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mu.1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mu.0</span><span class="p">,</span><span class="w"> </span><span class="n">sig2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sig2.0</span><span class="p">,</span><span class="w"> </span><span class="n">sm.s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">cv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">crit.val</span><span class="p">)</span><span class="o">$</span><span class="n">value</span>
<span class="w">        </span><span class="n">sim.pl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="n">sim.pl</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.1</span><span class="p">,</span><span class="n">i.s</span><span class="p">,</span><span class="n">pwr.v</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="n">sim.pl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">sim.pl</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">sim.pl</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;val&quot;</span><span class="p">,</span><span class="s">&quot;smp.size&quot;</span><span class="p">,</span><span class="s">&quot;test&quot;</span><span class="p">)</span>
<span class="n">sim.pl</span><span class="o">$</span><span class="n">smp.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">sim.pl</span><span class="o">$</span><span class="n">smp.size</span><span class="p">)</span>

<span class="c1">### Drawing the plot</span>

<span class="n">plt.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim.pl</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">test</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">smp.size</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0</span><span class="p">),</span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;solid&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;mu_0&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">mu.0</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="n">xlm.l</span><span class="m">+0.3</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Power functions for a left one-sided test (mean)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;True value of the parameter&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="s">&quot;sample sizes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz.v</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="c1">## Plots of power functions for the variance</span>

<span class="n">plt.fct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.5</span>
<span class="n">xlm.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="n">xlm.u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt.fct</span><span class="o">*</span><span class="n">sig2.0</span>
<span class="n">xlm.inc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">xlm.u</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xlm.l</span><span class="p">)</span><span class="o">/</span><span class="m">100</span>

<span class="n">sim.p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i.s</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">smp.sz.v</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz.v</span><span class="p">[</span><span class="n">i.s</span><span class="p">]</span>
<span class="w">    </span><span class="n">cv.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">sim.p.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="w">    </span><span class="nf">for </span><span class="p">(</span><span class="n">v.mu</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="n">xlm.l</span><span class="p">,</span><span class="n">xlm.u</span><span class="p">,</span><span class="n">xlm.inc</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">v.tst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">pchisq</span><span class="p">(</span><span class="n">cv.1</span><span class="o">*</span><span class="n">sig2.0</span><span class="o">/</span><span class="n">v.mu</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">sim.p.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="n">sim.p.2</span><span class="p">,</span><span class="nf">c</span><span class="p">(</span><span class="n">v.mu</span><span class="p">,</span><span class="n">i.s</span><span class="p">,</span><span class="n">v.tst</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">sim.p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rbind</span><span class="p">(</span><span class="n">sim.p</span><span class="p">,</span><span class="n">sim.p.2</span><span class="p">)</span>
<span class="p">}</span>
<span class="n">sim.p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">sim.p</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">sim.p</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;val&quot;</span><span class="p">,</span><span class="s">&quot;smp.size&quot;</span><span class="p">,</span><span class="s">&quot;test&quot;</span><span class="p">)</span>
<span class="n">sim.p</span><span class="o">$</span><span class="n">smp.size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">sim.p</span><span class="o">$</span><span class="n">smp.size</span><span class="p">)</span>

<span class="c1">### Drawing the plot</span>

<span class="n">plt.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sim.p</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">   </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">val</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">test</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">smp.size</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">sig2.0</span><span class="p">),</span><span class="n">linetype</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;solid&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;sigma2_0&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">sig2.0</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">),</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Significance level&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">x</span><span class="o">=</span><span class="n">xlm.l</span><span class="m">+0.5</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sig.lvl</span><span class="p">,</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Power functions for a left one-sided test (variance)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;True value of the parameter&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="s">&quot;sample sizes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz.v</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">   </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.1</span><span class="p">,</span><span class="n">plt.2</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Power functions for a test on the population mean&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/23fec31d473778cde6b7e9c4f9a030cad5fe405fd5438d85204ebbc90ab60ac9.png" src="_images/23fec31d473778cde6b7e9c4f9a030cad5fe405fd5438d85204ebbc90ab60ac9.png" />
</div>
</div>
<div class="section" id="id15">
<h5><span style="color:green;">Questions</span><a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h5>
<p><span style="color:green">Answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">Compute the minimum sample size needed to ensure that the power of a one-sided hypothesis test on the population variance, when <span class="math notranslate nohighlight">\(\sigma^2_0 = 2\)</span> and the true value of the parameter is <span class="math notranslate nohighlight">\(\sigma^2_1 = 3\)</span>, equals <span class="math notranslate nohighlight">\(0.5\)</span> or more.</span></p></li>
<li><p><span style="color:green">Does the power of a test depend on the sample you have collected? Provide some intuitive explanation for this fact.</span></p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-hypothesis-testing-and-data-science-terminology-span">
<h2><span style="color:brown">Hypothesis testing and data science terminology</span><a class="headerlink" href="#span-style-color-brown-hypothesis-testing-and-data-science-terminology-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Many practical cases involve applying a procedure to predict a certain outcome, which is represented with two possible values. This procedure can be interpreted as a hypothesis test based on data, but it is also common in practice for data scientists to interpret this situation as the outcome of a mathematical computation that returns either a 0 or a 1 value.</p>
<p>Data scientists have a specific terminology to refer to this approach, which in many ways replicates the concepts we have seen in this lesson. In the following paragraphs we establish a relationship between these two collections of terms, the ones we have seen in this class and those commonly used in data science (machine learning), with the aim of familiarizing you with these terms.</p>
<ul class="simple">
<li><p><span style="color:brown">Confusion matrix</span>. Given a model which has been applied <span class="math notranslate nohighlight">\(m\)</span> times, and assuming we know the correct answer in each case, we can classify these <span class="math notranslate nohighlight">\(m\)</span> outcomes using a <span style="color:brown">confusion matrix</span>, defined as follows</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{cc|cc}
&amp; &amp; \text{Prediction} &amp; \\
&amp; &amp; \text{Positive} &amp; \text{Negative} \\
\hline
\text{Actual value} &amp; \text{Positive} &amp; \text{True positive (TP)} &amp; \text{False negative (FN)} \\
&amp; \text{Negative} &amp; \text{False positive (FP)} &amp; \text{True negative (TN)}
\end{array}
\end{split}\]</div>
<blockquote>
<div><p>A <span style="color:brown">false negative (FN)</span> corresponds to what we have called a Type I error, while a <span style="color:brown">false positive (FP)</span> would be equivalent to our Type II error. Note that this matrix represents what we would call a <span style="color:brown">contingency table</span> in Statistics.</li></ul></p>
</div></blockquote>
<ul class="simple">
<li><p><span style="color:brown">Accuracy</span>. It is defined as the sum of true positives and true negatives, divided by the total number of applications of the model. It estimates the probability of the model providing a correct answer, corresponding to one minus the probability of making an error, <span class="math notranslate nohighlight">\(1 - \alpha - \beta\)</span>.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\mbox{accuracy} = \frac{\mbox{TP} + \mbox{TN}}{\mbox{TP} + \mbox{TN} + \mbox{FP} + \mbox{FN}}
\]</div>
<ul class="simple">
<li><p><span style="color:brown">Precision</span>. It is the number of true positives (TP), divided by the total number of predicted positives, that is, <span class="math notranslate nohighlight">\(\mbox{TP} + \mbox{FP}\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\mbox{precision} = \frac{\mbox{TP}}{\mbox{TP} + \mbox{FP}}
\]</div>
<blockquote>
<div><p>It estimates the probability of <span class="math notranslate nohighlight">\(H_0\)</span> being true conditioned on us failing to reject <span class="math notranslate nohighlight">\(H_0\)</span>.</li></ul></p>
</div></blockquote>
<ul class="simple">
<li><p><span style="color:brown">Recall</span>. The number of true positives (TP) divided by the total number of actual positives, that is, <span class="math notranslate nohighlight">\(\mbox{TP} + \mbox{FN}\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\mbox{recall} = \frac{\mbox{TP}}{\mbox{TP} + \mbox{FN}}
\]</div>
<blockquote>
<div><p>It estimates the probability of <span class="math notranslate nohighlight">\(H_0\)</span> not being rejected conditioned on <span class="math notranslate nohighlight">\(H_0\)</span> being true, that is, <span class="math notranslate nohighlight">\(1 - \alpha\)</span>.</li></ul></p>
</div></blockquote>
<ul class="simple">
<li><p><span style="color:brown">Specificity</span>. The number of true negatives (TN) divided by the total number of actual negatives, that is, <span class="math notranslate nohighlight">\(\mbox{FP} + \mbox{TN}\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\mbox{specificity} = \frac{\mbox{TN}}{\mbox{FP} + \mbox{TN}}
\]</div>
<blockquote>
<div><p>It estimates the probability of rejecting <span class="math notranslate nohighlight">\(H_0\)</span> conditioned on <span class="math notranslate nohighlight">\(H_0\)</span> being false, that is, <span class="math notranslate nohighlight">\(1 - \beta\)</span>, the power of the test.</li></ul></p>
</div></blockquote>
<ul class="simple">
<li><p><span style="color:brown">F1 score</span>. In some cases we wish to measure both types of errors simultaneously. Although we could add both errors, similarly to what we did for the accuracy, the most usual way to combine this information consists in using the F1 score, defined as the harmonic mean of precision and recall, that is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
F_1 = \frac{2\times \mbox{precision}\times \mbox{recall}}{\mbox{precision} + \mbox{recall}}
\]</div>
<blockquote>
<div><p>This definition takes into account that the number of observations that have an actual positive or negative value may be very different, and combines information for both cases in relative and approximately equivalent terms.</li></ul></p>
</div></blockquote>
<ul class="simple">
<li><p><span style="color:brown">ROC curve</span>. In many cases we wish to study the behavior of a model for different values of a parameter. For example, the behavior of the errors in a hypothesis test as we change the critical value of the test, etc. In these cases it is common to use some graphical representations for the performance of the model, and one of the most common ones is the ROC curve.</p></li>
</ul>
<blockquote>
<div><p>This curve can be used to identify a better method when its area under the curve (AUC) is larger. It is defined as the curve plotting the false positive rate vs. the true positive rate (recall). The false positive rate is defined as</li></ul></p>
</div></blockquote>
<div class="math notranslate nohighlight">
\[
\mbox{false positive rate} = \frac{\mbox{FP}}{\mbox{FP} + \mbox{TN}} = 1 - \mbox{specificity}
\]</div>
<hr class="docutils" />
<hr class="docutils" />
<p><a id='App2_1'></a></p>
</div>
<div class="section" id="span-style-color-orange-appendix-1-power-functions-for-normal-data-span">
<h2><span style="color:orange;">Appendix 1: Power functions for normal data</span><a class="headerlink" href="#span-style-color-orange-appendix-1-power-functions-for-normal-data-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="section" id="span-style-color-orange-computing-the-power-for-the-mean-of-a-normal-population-span">
<h3><span style="color:orange;">Computing the power for the mean of a normal population</span><a class="headerlink" href="#span-style-color-orange-computing-the-power-for-the-mean-of-a-normal-population-span" title="Permalink to this headline">#</a></h3>
<p>Consider the case when we have a normal population, and we wish to compute the power of a test on the value of the population mean, with <span class="math notranslate nohighlight">\(H_0 \, :\, \mu \leq \mu_0\)</span>. The value of the power function for this case is given by</p>
<div class="math notranslate nohighlight">
\[
\mbox{power} (\mu_1) = \Pr\left( \frac{\bar X - \mu_0}{S/\sqrt{n}} &gt; t_{n-1;\alpha} \; \Bigl| \; \mu = \mu_1 \right) , \qquad \frac{\bar X - \mu_1}{S/\sqrt{n}} \sim t_{n-1}
\]</div>
<p>We compute this function by conditioning on all the possible values of <span class="math notranslate nohighlight">\(S\)</span>, and using the property that <span class="math notranslate nohighlight">\((n-1)S^2/\sigma^2 \sim \chi^2_{n-1}\)</span>. In the particular case with an alternative hypothesis <span class="math notranslate nohighlight">\(H_1 : \mu &gt; \mu_0\)</span>,</p>
<div class="math notranslate nohighlight">
\[
\mbox{power} (\mu_1; \sigma^2) = \Pr\left( \frac{\bar X - \mu_1}{S/\sqrt{n}} + \frac{\mu_1 - \mu_0}{S/\sqrt{n}} &gt; t_{n-1;\alpha} \; \Bigl| \; \mu_1 \right) = \Pr\left( T_{n-1} + \frac{\mu_1 - \mu_0}{\displaystyle \sqrt{\frac{\chi^2_{n-1}\sigma^2}{n(n-1)}}} &gt; t_{n-1;\alpha} \right)
\]</div>
<p>and the function can be computed as</p>
<div class="math notranslate nohighlight">
\[
\mbox{power} (\mu_1;\sigma^2) = \int_0^\infty \Pr\left( T_{n-1} + \frac{\delta}{\displaystyle \sqrt{\frac{\sigma^2 x}{n(n-1)}}} &gt; t_{n-1;\alpha} \right) f_{\chi^2_{n-1}} (x) dx
\]</div>
<p>where <span class="math notranslate nohighlight">\(f_{\chi^2_{n-1}} (x)\)</span> denotes the density of a chi squared distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom computed at <span class="math notranslate nohighlight">\(x\)</span>.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="L1ConfInt.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span style="color:brown">Statistical inference: Confidence intervals</span></p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-contents-span"><span style="color:brown;">Contents</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-introduction-span"><span style="color:brown;">Introduction</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-goals-i-span"><span style="color:brown;">Goals (i)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-goals-ii-span"><span style="color:brown;">Goals (ii)</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-hypothesis-tests-span"><span style="color:brown">Hypothesis tests</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-step-1-defining-the-null-and-alternative-hypotheses-span"><span style="color:brown">Step 1. Defining the null and alternative hypotheses</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-green-questions-span"><span style="color:green;">Questions</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-selecting-a-null-hypothesis-for-the-test-span"><span style="color:brown">Selecting a null hypothesis for the test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-red-exercise-span"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-red-exercise-solution-span"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-step-2-comparing-the-evidence-and-the-reference-value-span"><span style="color:brown">Step 2. Comparing the evidence and the reference value</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-preparing-r-and-the-data-span"><span style="color:blue;">Preparing R and the data</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-based-on-selected-data-sets-span"><span style="color:blue;">Examples based on selected data sets</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-selecting-and-displaying-the-data-set-and-the-variable-of-interest-span"><span style="color:blue;">Selecting and displaying the data set and the variable of interest</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-summaries-for-the-sample-data-span"><span style="color:blue;">Summaries for the sample data</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-example-of-evidence-evaluation-for-a-hypothesis-test-span"><span style="color:brown">Example of evidence evaluation for a hypothesis test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-i-span"><span style="color:blue">Numerical example of evidence evaluation (i)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-ii-span"><span style="color:blue">Numerical example of evidence evaluation (ii)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><span style="color:brown">Example of evidence evaluation for a hypothesis test</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-comparing-the-evidence-and-the-reference-value-span"><span style="color:brown">Comparing the evidence and the reference value</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-iii-span"><span style="color:blue">Numerical example of evidence evaluation (iii)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-step-3-evaluating-the-evidence-based-on-test-statistic-values-span"><span style="color:brown">Step 3. Evaluating the evidence based on test statistic values</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-iv-span"><span style="color:blue">Numerical example of evidence evaluation (iv)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-errors-associated-with-a-hypothesis-testing-procedure-span"><span style="color:brown">Errors associated with a hypothesis testing procedure</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-using-the-probabilities-of-the-errors-to-define-critical-values-for-a-test-span"><span style="color:brown">Using the probabilities of the errors to define critical values for a test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><span style="color:green;">Questions</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-of-evidence-evaluation-v-span"><span style="color:blue">Numerical example of evidence evaluation (v)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-steps-to-conduct-a-hypothesis-testing-procedure-span"><span style="color:brown;">Steps to conduct a hypothesis testing procedure</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-an-illustration-of-the-general-hypothesis-testing-procedure-span"><span style="color:blue;">An illustration of the general hypothesis testing procedure</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-summary-of-a-hypothesis-testing-procedure-span"><span style="color:brown">Summary of a hypothesis testing procedure</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><span style="color:green;">Questions</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-application-of-hypothesis-testing-procedures-span"><span style="color:blue;">Numerical application of hypothesis testing procedures</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-1-define-the-data-to-be-used-for-the-example-span"><span style="color:blue;">1. Define the data to be used for the example</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-2-define-the-type-of-test-that-you-would-like-to-conduct-span"><span style="color:blue;">2. Define the type of test that you would like to conduct</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-3-perform-the-required-calculations-for-the-test-span"><span style="color:blue;">3. Perform the required calculations for the test</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-the-errors-in-a-hypothesis-test-span"><span style="color:brown">The errors in a hypothesis test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-for-type-i-errors-span"><span style="color:blue;">Numerical example for type I errors</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-numerical-example-for-type-ii-errors-span"><span style="color:blue;">Numerical example for type II errors</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-the-power-function-of-a-test-span"><span style="color:brown">The power function of a test</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-computing-the-power-of-a-test-span"><span style="color:brown">Computing the power of a test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><span style="color:green;">Questions</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-of-power-functions-span"><span style="color:blue;">Examples of power functions</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-impact-of-the-sample-size-on-the-power-function-of-a-test-span"><span style="color:brown">Impact of the sample size on the power function of a test</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-power-functions-and-sample-sizes-span"><span style="color:blue;">Power functions and sample sizes</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-hypothesis-testing-and-data-science-terminology-span"><span style="color:brown">Hypothesis testing and data science terminology</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-appendix-1-power-functions-for-normal-data-span"><span style="color:orange;">Appendix 1: Power functions for normal data</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-computing-the-power-for-the-mean-of-a-normal-population-span"><span style="color:orange;">Computing the power for the mean of a normal population</span></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Department of Statistics UC3M
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>