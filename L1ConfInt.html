

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Statistical inference: Confidence intervals &#8212; Statistics II</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'L1ConfInt';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hypothesis testing on one population" href="L2HypTest.html" />
    <link rel="prev" title="Statistics II Course Book" href="L0Intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="L0Intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo_uc3m_banner.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo_uc3m_banner.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Confidence intervals</a></li>
<li class="toctree-l1"><a class="reference internal" href="L2HypTest.html">Hypothesis testing for one population</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1><span style="color:brown">Statistical inference: Confidence intervals</span></h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-contents-span"><span style="color:brown;">Contents</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-introduction-span"><span style="color:brown;">Introduction</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-goals-i-span"><span style="color:brown;">Goals (i)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-goals-ii-span"><span style="color:brown;">Goals (ii)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-keywords-in-statistics-and-statistical-inference-span"><span style="color:brown;">Keywords in statistics and statistical inference</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-point-estimators-span"><span style="color:brown;">Point estimators</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-selecting-a-good-point-estimator-span"><span style="color:brown;">Selecting a good point estimator</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-theoretical-properties-of-point-estimators-span"><span style="color:brown">Theoretical properties of point estimators</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-bias-of-an-estimator-span"><span style="color:brown">Bias of an estimator</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-efficiency-of-an-estimator-span"><span style="color:brown">Efficiency of an estimator</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-mean-squared-error-of-an-estimator-span"><span style="color:brown">Mean squared error of an estimator</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-red-exercise-span"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-red-exercise-solution-span"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-preparing-r-and-the-data-span"><span style="color:blue;">Preparing R and the data</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-based-on-selected-data-sets-span"><span style="color:blue;">Examples based on selected data sets</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-selecting-and-displaying-the-data-set-and-the-variable-of-interest-span"><span style="color:blue;">Selecting and displaying the data set and the variable of interest</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-summaries-for-the-sample-data-span"><span style="color:blue;">Summaries for the sample data</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-estimating-parameters-from-the-data-span"><span style="color:blue">Estimating parameters from the data</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-comparing-different-estimators-span"><span style="color:blue;">Comparing different estimators</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-green-questions-span"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-of-estimator-bias-span"><span style="color:blue;">Examples of estimator bias</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-of-estimator-efficiency-span"><span style="color:blue;">Examples of estimator efficiency</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-defining-good-estimators-span"><span style="color:brown;">Defining good estimators</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-examples-of-estimators-with-good-properties-span"><span style="color:brown;">Examples of estimators with good properties</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-confidence-intervals-span"><span style="color:brown">Confidence intervals</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-definition-of-confidence-intervals-a-theoretical-example-span"><span style="color:brown">Definition of confidence intervals: a theoretical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-definition-of-confidence-intervals-numerical-example-span"><span style="color:blue;">Definition of confidence intervals: numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-definition-of-confidence-intervals-a-general-procedure-span"><span style="color:brown">Definition of confidence intervals: a general procedure</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-confidence-intervals-for-the-population-mean-span"><span style="color:brown">Confidence intervals for the population mean</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-central-limit-theorem-approximation-span"><span style="color:brown">Central limit theorem approximation</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-central-limit-theorem-approximation-numerical-example-span"><span style="color:blue;">Central limit theorem approximation. Numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-central-limit-theorem-approximation-for-the-population-proportion-span"><span style="color:brown">Central limit theorem approximation for the population proportion</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-population-proportion-numerical-example-span"><span style="color:blue;">Population proportion. Numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-normal-data-span"><span style="color:brown">Normal data</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-mean-of-normal-data-numerical-example-span"><span style="color:blue;">Mean of normal data. Numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-mean-of-normal-data-numerical-example-ii-span"><span style="color:blue;">Mean of normal data. Numerical example (ii)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-confidence-intervals-for-the-population-variance-span"><span style="color:brown">Confidence intervals for the population variance</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-variance-of-normal-data-numerical-example-span"><span style="color:blue;">Variance of normal data - Numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-variance-of-normal-data-numerical-example-ii-span"><span style="color:blue;">Variance of normal data - Numerical example (ii)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-confidence-interval-length-and-sample-sizes-span"><span style="color:brown">Confidence interval length and sample sizes</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20"><span style="color:green;">Questions</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-estimators-and-confidence-intervals-summary-span"><span style="color:brown">Estimators and confidence intervals. Summary</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-appendix-1-distributions-associated-to-the-normal-span"><span style="color:orange">Appendix 1: Distributions associated to the normal</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-the-chi-squared-distribution-span"><span style="color:orange">The chi squared distribution</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-the-student-t-distribution-span"><span style="color:orange">The Student t distribution</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-summary-of-statistics-for-these-distributions-span"><span style="color:orange">Summary of statistics for these distributions</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-graphical-representation-of-their-density-functions-span"><span style="color:orange;">Graphical representation of their density functions</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-appendix-2-justification-of-test-statistics-distributions-span"><span style="color:orange;">Appendix 2: Justification of test statistics distributions</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-distribution-of-the-statistic-for-the-population-variance-span"><span style="color:orange;">Distribution of the statistic for the population variance</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-distribution-of-the-statistic-for-the-population-mean-span"><span style="color:orange;">Distribution of the statistic for the population mean</span></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="span-style-color-brown-statistical-inference-confidence-intervals-span">
<h1><span style="color:brown">Statistical inference: Confidence intervals</span><a class="headerlink" href="#span-style-color-brown-statistical-inference-confidence-intervals-span" title="Permalink to this headline">#</a></h1>
<hr class="docutils" />
<div class="section" id="span-style-color-brown-contents-span">
<h2><span style="color:brown;">Contents</span><a class="headerlink" href="#span-style-color-brown-contents-span" title="Permalink to this headline">#</a></h2>
<p>This chapter covers the contents from Lesson 1 in the subject, <em>“Point estimators and confidence intervals”</em>. These contents are related to the estimation of population parameters in one population, and are structured as follows:</p>
<ul class="simple">
<li><p>Statistical inference: general definitions</p></li>
<li><p>Point estimators</p>
<ul>
<li><p>Estimation of the population mean and variance</p></li>
</ul>
</li>
<li><p>Estimating the population mean using confidence intervals</p>
<ul>
<li><p>Confidence intervals for the mean in large samples</p></li>
<li><p>Confidence intervals for the population proportion</p></li>
<li><p>Confidence intervals for the mean of a normal population with unknown variance</p></li>
</ul>
</li>
<li><p>Estimating the population variance using confidence intervals</p>
<ul>
<li><p>Confidence intervals for the variance of a normal population</p></li>
</ul>
</li>
<li><p>Distributions of interest related to the normal</p></li>
</ul>
</div>
<div class="section" id="span-style-color-brown-introduction-span">
<h2><span style="color:brown;">Introduction</span><a class="headerlink" href="#span-style-color-brown-introduction-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<div class="section" id="span-style-color-brown-goals-i-span">
<h3><span style="color:brown;">Goals (i)</span><a class="headerlink" href="#span-style-color-brown-goals-i-span" title="Permalink to this headline">#</a></h3>
<p>The main aims of the Statistics II course are to introduce and provide understanding of different procedures to conduct statistical inference, that is, to extract information from one or several samples, which might provide relevant knowledge about the parameters of a population.</p>
<p>From a practical point of view, most questions of interest posed in real-life applications of Statistics to data analysis can be answered using some (approximate) knowledge of the distribution of the relevant variables. Using this knowledge would require identifying an appropriate law for the available data, as well as obtining good approximations to the values of the parameters associated with this law.</p>
<p>In this course we will center on the second part of this problem, that is, the definition of efficient procedures for the approximation of the values of relevant population parameters, based on the information available in a sample of the variables of interest.</p>
<p>These parameter values, used jointly with their associated probability distributions, allow us to estimate different measures of interest to understand real-life situations, and to make decisions based on our best possible information for uncertain variables. Also, these values in isolation provide basic but relevant information to explain, and to help to understand, the properties of the population of interest.</p>
<p>This lesson will center on the problem of approximating the value of an individual population parameter. We will concentrate on the most common numerical summaries defined in Statistics I as measures of location and scale: the mean, the proportion, the variance or the standard deviation of a population.</p>
</div>
<div class="section" id="span-style-color-brown-goals-ii-span">
<h3><span style="color:brown;">Goals (ii)</span><a class="headerlink" href="#span-style-color-brown-goals-ii-span" title="Permalink to this headline">#</a></h3>
<p>Our learning goals for this lesson are:</p>
<ul class="simple">
<li><p>To understand what it means to estimate unknown population parameters from the sample data.</p></li>
<li><p>To understand why some estimators may be better than others, and to know some good estimators for the most usual parameters.</p></li>
<li><p>To provide a motivation to construct confidence intervals for population parameters from the sample data.</p>
<ul>
<li><p>And to be able to apply a general procedure to obtain these intervals.</p></li>
</ul>
</li>
<li><p>For large samples:</p>
<ul>
<li><p>To know how to construct confidence intervals for the population mean and proportion.</p></li>
</ul>
</li>
<li><p>In the case of a normal distribution:</p>
<ul>
<li><p>To know how to construct confidence intervals for the population mean and variance.</p></li>
</ul>
</li>
<li><p>To know how to interpret a confidence interval.</p>
<ul>
<li><p>To understand the impact of the sample size, confidence level, etc. on the size of the confidence interval.</p></li>
<li><p>To know how to calculate a sample size needed to ensure a given interval width.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="span-style-color-brown-keywords-in-statistics-and-statistical-inference-span">
<h3><span style="color:brown;">Keywords in statistics and statistical inference</span><a class="headerlink" href="#span-style-color-brown-keywords-in-statistics-and-statistical-inference-span" title="Permalink to this headline">#</a></h3>
<p>We start by defining some basic concepts related to inference, which we will use throughout the course:</p>
<ul class="simple">
<li><p><span style="color:brown"><em>Population:</em></span> the complete set of numerical information on an uncertain quantity in which we may be interested.</p>
<ul>
<li><p>We identify the concept of the population with that of a random variable <span class="math notranslate nohighlight">\(X\)</span>.</p></li>
<li><p>This concept is also associated to that of the law or the distribution of the population, or the distribution of <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(F_X\)</span>.</p></li>
</ul>
</li>
<li><p><span style="color:brown"><em>Sample:</em></span> an observed subset (say, of size <span class="math notranslate nohighlight">\(n\)</span>) of the population values.</p>
<ul>
<li><p>In practice, it is a set of <span class="math notranslate nohighlight">\(n\)</span> numbers or lists of values having the same structure. It may contain outliers or it may have missing data.</p></li>
<li><p>From a theoretical point of view, we will represent it as a collection of <span class="math notranslate nohighlight">\(n\)</span> random variables <span class="math notranslate nohighlight">\((X_1,X_2,\ldots,X_n)\)</span>.</p></li>
</ul>
</li>
<li><p><span style="color:brown"><em>Parameter:</em></span> a constant characterizing <span class="math notranslate nohighlight">\(X\)</span> or <span class="math notranslate nohighlight">\(F_X\)</span>.</p></li>
<li><p><span style="color:brown"><em>Statistical inference:</em></span> the process of drawing conclusions about a population on the basis of measurements or observations made on a sample of individuals from the population.</p></li>
<li><p><span style="color:brown"><em>Statistic:</em></span> a random variable obtained as a function of a random sample, <span class="math notranslate nohighlight">\(\underline X_n \equiv (X_1,X_2,\ldots,X_n)\)</span>.</p></li>
<li><p><span style="color:brown"><em>Estimator of a parameter:</em></span> a random variable obtained as a function, say <span class="math notranslate nohighlight">\(T (\underline X_n ) = T(X_1,\ldots,X_n)\)</span>, <span class="math notranslate nohighlight">\(T: \mathbb{R}^n\rightarrow \mathbb{R}\)</span>, of a random sample, which is used to obtain information about an unknown population parameter of interest.</p></li>
<li><p><span style="color:brown"><em>Estimate:</em></span> a specific realization of that random variable, i.e., <span class="math notranslate nohighlight">\(T\)</span> evaluated at the observed sample, <span class="math notranslate nohighlight">\((x_1,x_2,\ldots,x_n)\)</span>, that provides an approximation to the unknown parameter of interest.</p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-brown-point-estimators-span">
<h2><span style="color:brown;">Point estimators</span><a class="headerlink" href="#span-style-color-brown-point-estimators-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Our goal in this lesson is to define procedures that provide good approximations to the (unknown) values of population parameters, from the observed values in a random sample. In general, for any given parameter there exist many ways (different statistics) to combine the sample values to obtain an approximation for a parameter of interest. We would like to identify estimators that provide the best possible approximations, as functions of the observations in an available sample, where these samples are in general random collections of values from the population.</p>
<p>We will approach this problem in two steps, by considering:</p>
<ol class="arabic simple">
<li><p>How to obtain the best possible approximation given as a single value, from the information in our sample, by defining good <span style="color:brown"><em>point estimators</em></span>.</p></li>
<li><p>How to use the information from our sample to obtain an approximation that is relevant, and coherent with the information available in most other possible samples, by incorporating to our estimator information about <span style="color:brown"><em>the variability in all the samples</em></span> from our sample/population. We will identify an interval that should contain the correct value of the parameter with high confidence. These approximations will be known as <span style="color:brown"><em>confidence intervals</em></span>.</p></li>
</ol>
<p>We start by commenting on the first of these steps, and in particular on:</p>
<ul class="simple">
<li><p>Examples of estimators that we may use to approximate different parameters.</p></li>
<li><p>Desirable properties for these estimators, taking into account not only the possible errors in the approximation due to the limited information in our sample, but also the variability in these errors, due to the randomness of our samples.</p></li>
</ul>
<div class="section" id="span-style-color-brown-selecting-a-good-point-estimator-span">
<h3><span style="color:brown;">Selecting a good point estimator</span><a class="headerlink" href="#span-style-color-brown-selecting-a-good-point-estimator-span" title="Permalink to this headline">#</a></h3>
<p>We wish to combine the information given in a sample to obtain a value that approximates an unknown population parameter. We formally define a <span style="color:brown">point estimator</span> of the population parameter as a function, <span class="math notranslate nohighlight">\(T\)</span>, of a sample <span class="math notranslate nohighlight">\(\underline X_n = (X_1,\ldots,X_n)\)</span> that yields a number approximating the value of the parameter of interest, <span class="math notranslate nohighlight">\(\tilde T = T(\underline X_n)\)</span>. Or alternatively, we can think of the estimator as the formula we will use to compute our approximation for the parameter.</p>
<p>Our aim is to obtain a good approximation, as close as possible to the correct value. Our estimator <span class="math notranslate nohighlight">\(T\)</span> is a random variable, as it depends on the available sample and our samples are in general random. As a consequence, it will take different values depending on the sample. A good estimator should achieve good results for any, or at least for most, of the possible random samples, as we do not control which sample will be available in a given case. As a consequence of the variability in these samples, it is not possible to guarantee that any given estimator will be able to provide, or even to be very close to the correct value. Our aim will have to be limited: to define estimators that have errors as small as possible over all possible samples.</p>
<p>To define what a small error means in our setting, we will take into consideration the properties of these random variables, and their impact on the quality of the values they provide when trying to approximate the unknown value of the parameter. In this lesson we will consider the two most basic characterizations of the behavior of a random variable: its <span style="color:brown">location</span> and <span style="color:brown">spread</span> properties, and their impact on our approximations.</p>
<p><em>See the cell <span class="xref myst">Comparing different estimators</span> below for some examples motivating these properties.</em></p>
</div>
</div>
<div class="section" id="span-style-color-brown-theoretical-properties-of-point-estimators-span">
<h2><span style="color:brown">Theoretical properties of point estimators</span><a class="headerlink" href="#span-style-color-brown-theoretical-properties-of-point-estimators-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Based on our preceding comments, we introduce in this section the main properties we would like to have in a good estimator for any parameter of a population <span class="math notranslate nohighlight">\(\theta\)</span>. To simplify our analysis, we will consider only the cases when the parameters of the population to be studied are its mean <span class="math notranslate nohighlight">\(\theta = \mu\)</span> and its variance <span class="math notranslate nohighlight">\(\theta = \sigma^2\)</span>. These values are simple to approximate, their estimators have nice theoretical properties and the values they provide are very useful in many practical situations.</p>
<p>As estimators are random variables, we will pay special attention to properties that ensure that the basic numerical summaries of the values of these estimators (their mean and variance) behave as expected, that is, that their values are such that any estimates obtained from random samples are as close as possible to the population value of interest. The study of these properties must be carried out in a general setting, by defining some desirable <span style="color:brown">theoretical</span> properties for any estimator and studying the behavior of these properties for our estimators of interest.</p>
<div class="section" id="span-style-color-brown-bias-of-an-estimator-span">
<h3><span style="color:brown">Bias of an estimator</span><a class="headerlink" href="#span-style-color-brown-bias-of-an-estimator-span" title="Permalink to this headline">#</a></h3>
<p>If we consider the <span style="color:brown"><em>mean</em></span> of the estimator, we would like its value to be as close as possible to the correct population value. For a random variable, taking many different possible values, this will mean that the center of all these values, its mean, should coincide with the value we wish to approximate.</p>
<p>Formally, we wish our estimator <span class="math notranslate nohighlight">\(T\)</span> to satisfy <span style="color:brown"><span class="math notranslate nohighlight">\(E[T] = \theta .\)</span></span> When this condition is satisfied, we say that the estimator is <span style="color:brown">unbiased.</span></p>
<p>Let <span class="math notranslate nohighlight">\(E[X_i] = \mu\)</span> and <span class="math notranslate nohighlight">\(\text{Var} (X_i) = \sigma^2\)</span>. Then, the <span style="color:brown">sample mean</span> is always unbiased, as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
E[\bar X] &amp; = &amp; E\left[ \frac{1}{n} \left( X_1 + \cdots + X_n \right) \right] = \frac{1}{n} E\left[ X_1 + \cdots + X_n \right] = \frac{1}{n} \left( E[ X_1 ] + \cdots + E [ X_n ] \right) \\
&amp; = &amp; \frac{1}{n} \left( \mu + \cdots + \mu \right) = \mu 
\end{array}
\end{split}\]</div>
<p>But the <span style="color:brown">sample variance</span> is not unbiased, as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
E[\hat \sigma^2] &amp; = &amp; E\left[ \frac{1}{n} \sum_{i=1}^n \left( X_i - \bar X \right)^2 \right] = \frac{1}{n} n \left( E\left[X_i^2 \right] - 2E\left[X_i \bar X \right] + E\left[ \bar X^2 \right] \right) \\
&amp; = &amp; \sigma^2 + \mu^2 - \frac{2}{n} \sum_{j=1}^n E\left[X_i X_j \right] + \frac{1}{n} \sigma^2 + \mu^2 \\
&amp; = &amp; \frac{n+1}{n} \sigma^2 + 2 \mu^2 - \frac{2}{n} E\left[X_i^2 \right] - \frac{2}{n} \sum_{i\not=j} E[X_i] E[ X_j] \\
&amp; = &amp; \frac{n+1}{n} \sigma^2 + 2 \mu^2 - \frac{2}{n} \sigma^2 - \frac{2}{n} \mu^2 - \frac{2(n-1)}{n} \mu^2 = \frac{n-1}{n} \sigma^2 \not= \sigma^2
\end{array}
\end{split}\]</div>
<p>where we have used <span class="math notranslate nohighlight">\(E[X^2] = \text{Var} (X) + E[X]^2\)</span>, and <span class="math notranslate nohighlight">\(E[X_i X_j] = E[X_i]E[X_j]\)</span> when <span class="math notranslate nohighlight">\(i \not= j\)</span>.</p>
<p>From this result, the <span style="color:brown">quasivariance</span> <span class="math notranslate nohighlight">\(s^2\)</span> is an unbiased estimator of the population variance, as <span class="math notranslate nohighlight">\(s^2 = \frac{n}{n-1} \hat \sigma^2\)</span>.</p>
<p>Also, the <span style="color:brown">sample median</span> is not unbiased for asymmetric distributions, where its value is different from that of the mean, but it is unbiased for symmetric distributions.</p>
</div>
<div class="section" id="span-style-color-brown-efficiency-of-an-estimator-span">
<h3><span style="color:brown">Efficiency of an estimator</span><a class="headerlink" href="#span-style-color-brown-efficiency-of-an-estimator-span" title="Permalink to this headline">#</a></h3>
<p>We would like all the values of an estimator to be close to the correct population value, implying that these values should present low variability. As a consequence, we would like the <span style="color:brown"><em>variance</em></span> of an estimator to be as small as possible.</p>
<p>When we compare different estimators, we say that an estimator with smaller variance is more <span style="color:brown">efficient</span> than another with larger variance.</p>
<p>The efficiency of an estimator will in general increase with the sample size <span class="math notranslate nohighlight">\(n\)</span>. For example, for the <span style="color:brown">sample mean</span> <span class="math notranslate nohighlight">\(\bar X\)</span> we have that</p>
<div class="math notranslate nohighlight">
\[
\mbox{Var}(\bar X) = \mbox{Var} \left( \frac{1}{n} \left( X_1 + \cdots + X_n \right) \right) = \frac{1}{n^2} \left( \mbox{Var} (X_1) + \cdots + \mbox{Var} (X_n) \right) = \frac{n\mbox{Var} (X)}{n^2} = \frac{\mbox{Var} (X)}{n} .
\]</div>
<p>This result shows that the variance of the sample mean becomes arbitrarily small when <span class="math notranslate nohighlight">\(n\)</span> is very large, and the efficiency of this estimator improves (arbitrarily) with the sample size.</p>
<p>The efficiency of an estimator is directly related to the size of the error associated with using that estimator. Estimators that are very efficient imply much smaller errors in the values of their estimates.</p>
</div>
<div class="section" id="span-style-color-brown-mean-squared-error-of-an-estimator-span">
<h3><span style="color:brown">Mean squared error of an estimator</span><a class="headerlink" href="#span-style-color-brown-mean-squared-error-of-an-estimator-span" title="Permalink to this headline">#</a></h3>
<p>In many practical situations we may have several available estimators with different values of their properties, bias and efficiency. When trying to determine which estimator is best, we may find ourselves with situations where two estimators might be such that one of them has smaller bias than the other, but the second one is more efficient. To be able to compare different estimators in these situations, it seems reasonable to use a criterion based on a combination of both properties.</p>
<p>The combination that is most commonly used is the <span style="color:brown">mean squared error (MSE)</span> of the estimator, defined as</p>
<div class="math notranslate nohighlight">
\[
\mbox{MSE}[\hat \theta_X] = E\left[ (\hat \theta_X - \theta_X)^2 \right] = \mbox{Var}[\hat \theta_X] + \left( \mbox{Bias}[\hat \theta_X] \right)^2 = \mbox{Var}[\hat \theta_X] + \left( E[\hat \theta_X] - \theta_X \right)^2
\]</div>
<p>Note that:</p>
<ul class="simple">
<li><p>The mean squared error of an unbiased estimator is equal to its variance.</p></li>
<li><p>An estimator with a smaller MSE is better than another one with a larger MSE.</p></li>
</ul>
<div class="section" id="span-style-color-red-exercise-span">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#span-style-color-red-exercise-span" title="Permalink to this headline">#</a></h4>
<p><em>A simple random sample of 15 processing times (in minutes) of clients in a supermarket were recorded:</em></p>
<div class="math notranslate nohighlight">
\[
\begin{array}{ccccccccccccccc}
5 &amp; 6.2 &amp; 4.8 &amp; 5.2 &amp; 5.2 &amp; 6.4 &amp; 4.9 &amp; 5.3 &amp; 4.2 &amp; 5 &amp; 5.9 &amp; 5.1 &amp; 6 &amp; 4.9 &amp; 5
\end{array}
\]</div>
<ul class="simple">
<li><p><em>Compute unbiased estimates for the population mean and variance of these processing times.</em></p></li>
<li><p><em>Obtain an estimate for the population proportion of processing times shorter than 5 minutes.</em></p></li>
</ul>
<div class="section" id="span-style-color-red-exercise-solution-span">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#span-style-color-red-exercise-solution-span" title="Permalink to this headline">#</a></h5>
<p>We will use as unbiased estimators for the population mean and variance the sample mean and the sample quasivariance, respectively.</p>
<p>For the sample mean, we have</p>
<div class="math notranslate nohighlight">
\[
\bar x = \frac{5 + 6.2 + \cdots + 4.9 + 5}{15} = 5.2733
\]</div>
<p>and for the sample quasivariance,</p>
<div class="math notranslate nohighlight">
\[
s_x^2 = \frac{\sum_i x_i^2 - n \bar x^2}{n-1} = \frac{5^2 + 6.2^2 + \cdots + 4.9^2 + 5^2 - 15\times 5.2733^2}{14} = 0.35495
\]</div>
<p>To estimate the population proportion we will use the sample proportion, given by</p>
<div class="math notranslate nohighlight">
\[
\hat p_x = \frac{0 + 0 + 1 + 0 + \cdots + 0 + 1 + 0}{15} = \frac{4}{15} = 0.2667
\]</div>
</div>
</div>
<div class="section" id="id1">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<p><em>Let <span class="math notranslate nohighlight">\(\hat \mu = \frac{1}{4}(X_1 + X_2 + X_{n-1} + X_n)\)</span> be an estimator of the population mean defined for a s.r.s. of size <span class="math notranslate nohighlight">\(n &gt; 4\)</span>, obtained from a population with <span class="math notranslate nohighlight">\(E[X] = \mu\)</span> and <span class="math notranslate nohighlight">\(\text{Var} (X) = \sigma^2\)</span>.</em></p>
<p><em>Compare the bias and efficiency properties of this estimator <span class="math notranslate nohighlight">\(\hat \mu\)</span>, with those of the sample mean <span class="math notranslate nohighlight">\(\bar X\)</span>.</em></p>
<div class="section" id="id2">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h5>
<p>From previous subjects (Statistics I) we know that the sample mean <span class="math notranslate nohighlight">\(\bar{X}\)</span> is an unbiased estimator of <span class="math notranslate nohighlight">\(\mu\)</span>, whose variance is given by <span class="math notranslate nohighlight">\(\displaystyle \frac{\sigma^2}{n}\)</span>.</p>
<p>For the proposed estimator, <span class="math notranslate nohighlight">\(\hat \mu\)</span>, making use of <span class="math notranslate nohighlight">\(E[X_i] = \mu\)</span> and <span class="math notranslate nohighlight">\(\text{Var} (X_i) = \sigma^2\)</span> for any <span class="math notranslate nohighlight">\(i=1,\ldots,n\)</span>, we have:</p>
<ul class="simple">
<li><p><span style="color:brown">Bias.</span> As the expected value of a sum of random variables is the sum of their expected values, we obtain</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
E[\hat \mu ] &amp; = &amp; E \left[ \frac{1}{4}(X_1 + X_2 + X_{n-1} + X_n) \right] = \frac{1}{4} (E[X_1] + E[X_2] + E[X_{n-1}] + E[X_n]) \\
&amp; = &amp; \frac{1}{4} (\mu + \mu + \mu + \mu) = \mu
\end{array}
\end{split}\]</div>
<p>implying that <span class="math notranslate nohighlight">\(\text{Bias} (\hat \mu ) = E[\hat \mu ] - \mu = 0\)</span>, that is, <span class="math notranslate nohighlight">\(\hat \mu\)</span> is unbiased.</p>
<ul class="simple">
<li><p><span style="color:brown">Efficiency.</span> We use the properties that the variance of a sum of independent random variables is the sum of their variances, and that <span class="math notranslate nohighlight">\(\text{Var} (aX) = a^2 \text{Var} (X)\)</span>, to obtain</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\text{Var}(\hat \mu ) &amp; = &amp; \text{Var} \left( \frac{1}{4} (X_1 + X_2 + X_{n-1} + X_n) \right) = \frac{1}{4^2} \left( \text{Var}(X_1) + \text{Var}(X_2) + \text{Var}(X_{n-1}) + \text{Var}(X_n) \right) \\
&amp; = &amp; \frac{1}{16} (\sigma^2 + \sigma^2 + \sigma^2 + \sigma^2) = \frac{\sigma^2}{4}
\end{array}
\end{split}\]</div>
<p>This value is also the MSE for <span class="math notranslate nohighlight">\(\hat \mu\)</span>.</p>
<ul class="simple">
<li><p><span style="color:brown">Relative efficiency.</span> We can compute the relative efficiency of these two estimators by dividing their variances,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\mbox{Relative efficiency}(\bar X,\hat \mu ) = \frac{\sigma^2/n}{\sigma^2/4} = \frac{4}{n} ,
\]</div>
<p>and as this ratio is smaller than 1, we conclude that <span class="math notranslate nohighlight">\(\bar X\)</span> is a more efficient estimator for <span class="math notranslate nohighlight">\(\mu\)</span> than <span class="math notranslate nohighlight">\(\hat \mu\)</span>.</p>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-preparing-r-and-the-data-span">
<h2><span style="color:blue;">Preparing R and the data</span><a class="headerlink" href="#span-style-color-blue-preparing-r-and-the-data-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>To illustrate the concepts we have introduced, and to motivate possible choices of good estimators, we will consider specific examples, mostly based on real data, which we will process using <span style="color:blue;font-family:monospace;font-size:90%;">R</span>.</p>
<p>We start by preparing <span style="color:blue;font-family:monospace;font-size:90%;">R</span> to read and manipulate the data mentioned above. In the following <span style="color:blue;font-family:monospace;font-size:90%;">R</span> <span style="color:brown">code cell</span> we:</p>
<ol class="arabic simple">
<li><p>Load the <span style="color:blue;font-family:monospace;font-size:90%;">R</span> libraries we are going to need for our examples.</p></li>
<li><p>Define a function, <span style="color:blue;font-family:monospace;font-size:90%;">table_prnt</span>, specifying the format for the tables that will present the numerical results in this lesson.</p></li>
<li><p>Introduce information to work with the available data sets.</p></li>
</ol>
<p>The <span style="color:brown;">available data sets</span> and their identifying codes are:</p>
<ol class="arabic simple">
<li><p>Hourly prices for the Iberian electricity market</p></li>
<li><p>Grades for a Statistics subject in UC3M</p></li>
<li><p>Share prices for a company (Iberdrola) from the IBEX index</p></li>
<li><p>Simulated data from a N(80,30) distribution (var 1), an Exp(lambda=1/30) distribution (var 2) and a Binom(20,0.4) distribution (var 3)</p></li>
<li><p>Data from the Sustainable Develpment Report 2021, with the scores by country for goals 1 and 2</p></li>
</ol>
<p>In order to add another data set to this collection, you should include information for each of the following variables: the <span style="color:blue;font-family:monospace;font-size:90%;">.csv</span> file containing the data and a text with a short description for the data.</p>
<p>It is also important to ensure that the <span style="color:brown;">working directory</span> has been <span style="color:brown;">selected correctly,</span> as the directory that includes all the data sets that could be used in this lesson.</p>
<p>To execute the commands in the cell, select the cell by clicking on it, and then <span style="color:blue;">press the <strong>RUN</strong> button</span> in the menu bar, or press <span style="color:blue;">Shift-Enter.</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#options(jupyter.plot_mimetypes = c(&quot;text/plain&quot;,&quot;image/png&quot;))</span>

<span class="c1"># Load libraries with R functions</span>

<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">))</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">huxtable</span><span class="p">))</span>
<span class="nf">library</span><span class="p">(</span><span class="n">knitr</span><span class="p">)</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">kableExtra</span><span class="p">))</span>
<span class="nf">library</span><span class="p">(</span><span class="n">IRdisplay</span><span class="p">)</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">))</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">qqplotr</span><span class="p">))</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">GGally</span><span class="p">))</span>
<span class="nf">suppressMessages</span><span class="p">(</span><span class="nf">library</span><span class="p">(</span><span class="n">car</span><span class="p">))</span>
<span class="nf">library</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

<span class="c1"># Define a function to format and print the results of interest</span>

<span class="n">outp.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">   </span><span class="c1"># = 1 for html output, = 0 for Jupyter Books</span>

<span class="nf">if </span><span class="p">(</span><span class="n">outp.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">table_prnt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">p.df</span><span class="p">,</span><span class="n">p.capt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># A function to control the presentation of tables with numerical summaries</span>
<span class="w">    </span><span class="n">p.df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">kable</span><span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">,</span><span class="n">caption</span><span class="o">=</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;&lt;em&gt;&#39;</span><span class="p">,</span><span class="n">p.capt</span><span class="p">,</span><span class="s">&#39;&lt;/em&gt;&#39;</span><span class="p">),</span><span class="n">align</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">kable_styling</span><span class="p">(</span><span class="n">full_width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;left&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">as.character</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">display_html</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="n">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">table_prnt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">p.df</span><span class="p">,</span><span class="n">p.capt</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1"># A function to control the presentation of tables with numerical summaries</span>
<span class="w">    </span><span class="n">p.df</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">kable</span><span class="p">(</span><span class="s">&quot;simple&quot;</span><span class="p">,</span><span class="n">caption</span><span class="o">=</span><span class="n">p.capt</span><span class="p">,</span><span class="n">align</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-examples-based-on-selected-data-sets-span">
<h2><span style="color:blue;">Examples based on selected data sets</span><a class="headerlink" href="#span-style-color-blue-examples-based-on-selected-data-sets-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>To illustrate the concepts we have introduced, and to motivate possible choices of good estimators, we will consider specific examples, mostly based on real data, which we will process using <span style="color:blue;font-family:monospace;font-size:90%;">R</span>.</p>
<div class="section" id="span-style-color-blue-selecting-and-displaying-the-data-set-and-the-variable-of-interest-span">
<h3><span style="color:blue;">Selecting and displaying the data set and the variable of interest</span><a class="headerlink" href="#span-style-color-blue-selecting-and-displaying-the-data-set-and-the-variable-of-interest-span" title="Permalink to this headline">#</a></h3>
<p>We select one of these data sets and the variable of interest in the following cell.</p>
<ol class="arabic simple">
<li><p>We assign the corresponding number to the variable <span style="color:blue;font-family:monospace;font-size:90%;">sel.data</span>, at the start of the following code cell.</p></li>
<li><p>We read the file and include the data in a <span style="color:brown;">data frame</span> with the name <span style="color:blue;font-family:monospace;font-size:90%;">Data.fr</span>.</p></li>
<li><p>We assign the number corresponding to the order of the variable of interest in the data set, to the variable <span style="color:blue;font-family:monospace;font-size:90%;">sel.col</span>.</p></li>
<li><p>We assign the values of the variable to an <span style="color:blue;font-family:monospace;font-size:90%;">R</span> data frame with the name <span style="color:blue;font-family:monospace;font-size:90%;">data.sel</span>. This data frame will contain a single variable (column) with the name <span style="color:blue;font-family:monospace;font-size:90%;">Val</span>.</p></li>
</ol>
<p>Finally, we print the names of the selected data set and variable, to check that these values are correct. Then we display some of the values from the <span style="color:blue;font-family:monospace;font-size:90%;">.csv</span> file, keeping the same structure of the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the data set of interest</span>

<span class="c1">## Datasets that are available for this lesson</span>

<span class="n">v.pref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Dat_PreciosOMIE.csv&quot;</span><span class="p">,</span><span class="w">     </span><span class="c1"># Name of the .csv data file</span>
<span class="w">                            </span><span class="s">&quot;Dat_Calificaciones.csv&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="s">&quot;Dat_PreciosIBE_MC.csv&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="s">&quot;Dat_SimulatedData.csv&quot;</span><span class="p">,</span>
<span class="w">                            </span><span class="s">&quot;Dat_SDR21.csv&quot;</span><span class="p">))</span>
<span class="n">v.pref</span><span class="o">$</span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Electricity prices&quot;</span><span class="p">,</span><span class="w">         </span><span class="c1"># Short title for the data</span>
<span class="w">                </span><span class="s">&quot;Grades&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;Share returns&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;Simulated data&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;SDG 2021 Scores&quot;</span><span class="p">)</span>

<span class="c1">## Indicate the data set and variable to select</span>
<span class="c1">## These values can be modified</span>

<span class="n">sel.data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span>
<span class="n">sel.col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span>

<span class="c1">## Read the data</span>

<span class="n">s.pref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.pref</span><span class="p">[</span><span class="n">sel.data</span><span class="p">,]</span>

<span class="n">Data.fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">read.csv2</span><span class="p">(</span><span class="n">s.pref</span><span class="o">$</span><span class="n">file</span><span class="p">)</span>
<span class="n">data.sel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">[,</span><span class="n">sel.col</span><span class="p">])</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">data.sel</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Val&quot;</span><span class="p">)</span>

<span class="c1">## Summary of the selected data</span>

<span class="n">descr.df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">s.pref</span><span class="o">$</span><span class="n">title</span><span class="p">,</span><span class="nf">colnames</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">)[</span><span class="n">sel.col</span><span class="p">]))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">descr.df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Selection&quot;</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">descr.df</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Data set&quot;</span><span class="p">,</span><span class="s">&quot;Variable&quot;</span><span class="p">)</span>

<span class="n">Data.hux.0</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">descr.df</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.0</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;&quot;</span><span class="p">)</span>

<span class="c1"># Print a part of the data we have selected</span>

<span class="n">max.row.show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="w">       </span><span class="c1"># Max number of individual values to show</span>
<span class="n">max.col.show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="w">       </span><span class="c1"># Max number of variables to show</span>

<span class="n">n.row.show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">),</span><span class="n">max.row.show</span><span class="p">)</span>
<span class="n">n.col.show</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="nf">ncol</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">),</span><span class="n">max.col.show</span><span class="p">)</span>

<span class="n">Data.hux.1</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Data.fr</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">n.row.show</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="n">n.col.show</span><span class="p">])</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="n">n.row.show</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.1</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="n">s.pref</span><span class="o">$</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: 

                  Selection
---------  ----------------
Data set    SDG 2021 Scores
Variable         Goal1Score
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: SDG 2021 Scores

 CountryCode   SDGIndexScore                Region   Population   Goal1Dash   Goal1Score
------------  --------------  --------------------  -----------  ----------  -----------
         AGO            50.3                Africa     32866268         red       12.913
         ALB              71   E. Europe &amp; C. Asia      2877800      yellow      91.6375
         ARE            70.2                  MENA      9890400       green      99.5695
         ARG            72.8                   LAC     45195777      yellow        95.99
         ARM            71.8   E. Europe &amp; C. Asia      2963234      yellow       93.438
         AUS            75.6                  OECD     25499881      yellow        99.61
         AUT            82.1                  OECD      9006400       green       99.467
         AZE            72.4   E. Europe &amp; C. Asia     10139175       green          100
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-summaries-for-the-sample-data-span">
<h3><span style="color:blue;">Summaries for the sample data</span><a class="headerlink" href="#span-style-color-blue-summaries-for-the-sample-data-span" title="Permalink to this headline">#</a></h3>
<p>In the following cell we conduct some simple exploratory analysis of the data from the variable we have selected: we compute some of its most relevant numerical summaries, such as its mean, standard deviation and median.</p>
<p>We also draw a boxplot of the sample data corresponding to this variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print summaries from the selected data set</span>

<span class="n">smp0.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">data.sel</span><span class="p">)</span>
<span class="n">smp0.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">)</span>
<span class="n">smp0.sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">)</span>
<span class="n">smp0.var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp0.sd</span><span class="o">^</span><span class="m">2</span>
<span class="n">smp0.med</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">median</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">)</span>
<span class="n">Sum.fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">smp0.sz</span><span class="p">,</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">smp0.sd</span><span class="p">,</span><span class="n">smp0.med</span><span class="p">),</span><span class="m">4</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>

<span class="n">Data.hux.2</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Sample size&quot;</span><span class="p">,</span><span class="s">&quot;Mean&quot;</span><span class="p">,</span><span class="s">&quot;Standard deviation&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Median&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.2</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.2</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%s summary&quot;</span><span class="p">,</span><span class="n">s.pref</span><span class="o">$</span><span class="n">title</span><span class="p">))</span>

<span class="c1">## Boxplot for the data</span>

<span class="n">plt.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.sel</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">Val</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_boxplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span><span class="n">s.pref</span><span class="o">$</span><span class="n">title</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">(),</span><span class="n">axis.text.x</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">(),</span><span class="n">axis.ticks.x</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">plt.1</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: SDG 2021 Scores summary

                      Values
-------------------  -------
Sample size              154
Mean                  72.871
Standard deviation    33.076
Median                 90.98
</pre></div>
</div>
<img alt="_images/46b953cb50798c73c1b430713e1966a5561b2cd23cbbe75c17a2031641be6d74.png" src="_images/46b953cb50798c73c1b430713e1966a5561b2cd23cbbe75c17a2031641be6d74.png" />
</div>
</div>
</div>
<div class="section" id="span-style-color-blue-estimating-parameters-from-the-data-span">
<h3><span style="color:blue">Estimating parameters from the data</span><a class="headerlink" href="#span-style-color-blue-estimating-parameters-from-the-data-span" title="Permalink to this headline">#</a></h3>
<p>To illustrate the properties of our estimators, and the quality of the results we obtain from them, we would need to compare these estimated values with the corresponding values for the population parameters. But when we work with real data, in nearly all cases we do not know these population values.</p>
<p>To overcome this problem in some measure, we will conduct an experiment based on assuming that the data we have collected is all the information we care about regarding the values of the selected variable (our population). Based on this definition for our population, we will conduct different experiments based on comparing the results generated by the estimators obtained for many random subsamples, with the population value of interest.</p>
<p>To simplify these comparisons, in each of them we will generate subsamples with the same size. And as we mentioned before, we will identify the value of the population parameter with the corresponding value estimated for the full sample.</p>
<p><a id='Comparing_estimators'></a></p>
</div>
<div class="section" id="span-style-color-blue-comparing-different-estimators-span">
<h3><span style="color:blue;">Comparing different estimators</span><a class="headerlink" href="#span-style-color-blue-comparing-different-estimators-span" title="Permalink to this headline">#</a></h3>
<p>In our first experiment we aim to illustrate the main characteristics of different estimators. We would like to emphasize their different behavior when trying to approximate the correct value of the parameter, and to provide a starting point to discuss what characteristic of each of these random variables (the estimators) is more relevant to provide a good approximation.</p>
<p>The experiment is based on the selection of a group of estimators and the generation of many values for these estimators, based on random samples of a fixed size. These random samples have been obtained by selecting observations in our data set with the same probability and independently of each other. To do this, we have used the <span style="color:blue;font-family:monospace;font-size:90%;">R</span> function <span style="color:blue;font-family:monospace;font-size:90%;">sample</span>.</p>
<p>The experiment is conducted in the <span style="color:blue;font-family:monospace;font-size:90%;">R</span> code cell below. We will select a random collection of <span class="math notranslate nohighlight">\(m\)</span> samples of size <span class="math notranslate nohighlight">\(n\)</span> from our variable. We define our value of <span class="math notranslate nohighlight">\(m\)</span> (<span style="color:brown">the number of samples to generate</span>) in a variable <span style="color:blue;font-family:monospace;font-size:90%;">n.samples</span> defined at the start of the cell, jointly with a value for <span class="math notranslate nohighlight">\(n\)</span> (<span style="color:brown">the sample size of each sample</span>), which we introduce using another variable <span style="color:blue;font-family:monospace;font-size:90%;">smp.sz.prop</span>, indicating the proportion of the total observations that we include in each sample.</p>
<p>From each sample we compute the following measures (estimates):</p>
<ol class="arabic simple">
<li><p>To approximate the population mean:</p>
<ul class="simple">
<li><p>The sample mean</p></li>
<li><p>The average of the <span class="math notranslate nohighlight">\(n/2\)</span> central observations</p></li>
<li><p>The average of the two most extreme observations</p></li>
<li><p>The sample median</p></li>
</ul>
</li>
<li><p>To approximate the population variance:</p>
<ul class="simple">
<li><p>The sample variance</p></li>
<li><p>The sample quasivariance</p></li>
<li><p>The square of the sample MAD (median absolute deviation), corrected for consistency under normality</p></li>
<li><p>The sample variance of the <span class="math notranslate nohighlight">\(n/2\)</span> central observations, corrected for consistency under normality</p></li>
</ul>
</li>
</ol>
<p>The choice of estimators indicated above is quite arbitrary. This experiment could be repeated with other definitions of approximations for the mean and the variance, although the general results should be similar.</p>
<p>To analize their performance, for each one of the preceding estimators we draw a histogram using their values for all the samples we have generated. In that histogram we also plot the correct value (the population parameter) as a red vertical line, in order to compare the values provided by each estimator and to help assess the quality of their approximations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Histograms for different estimators</span>

<span class="c1">## These values can be modified</span>

<span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span>
<span class="n">smp.sz.prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span>

<span class="c1">## Parameters</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">smp.sz.prop</span><span class="o">*</span><span class="n">smp0.sz</span><span class="p">)</span>
<span class="n">s.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="m">0.25</span><span class="o">*</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="n">s.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ceiling</span><span class="p">(</span><span class="m">0.75</span><span class="o">*</span><span class="n">smp.sz</span><span class="p">)</span>

<span class="c1">## Generate samples and estimates</span>

<span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cmn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xmn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">md.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="n">var.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qvar.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mad.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cvar.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">v.srt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sort</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span>
<span class="w">    </span><span class="n">vc.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v.srt</span><span class="p">[</span><span class="n">s.1</span><span class="o">:</span><span class="n">s.2</span><span class="p">]</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mn.smp</span><span class="p">,</span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span>
<span class="w">    </span><span class="n">cmn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">cmn.smp</span><span class="p">,</span><span class="nf">mean</span><span class="p">(</span><span class="n">vc.smp</span><span class="p">))</span>
<span class="w">    </span><span class="n">xmn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">xmn.smp</span><span class="p">,(</span><span class="nf">min</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span><span class="o">+</span><span class="nf">max</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span><span class="o">/</span><span class="m">2</span><span class="p">)</span>
<span class="w">    </span><span class="n">md.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">md.smp</span><span class="p">,</span><span class="nf">median</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">var.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">var.smp</span><span class="p">,</span><span class="nf">var</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">)</span><span class="o">/</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="w">    </span><span class="n">qvar.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">qvar.smp</span><span class="p">,</span><span class="nf">var</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span>
<span class="w">    </span><span class="n">mad.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mad.smp</span><span class="p">,</span><span class="nf">mad</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="w">    </span><span class="n">cvar.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">cvar.smp</span><span class="p">,</span><span class="nf">var</span><span class="p">(</span><span class="n">vc.smp</span><span class="p">)</span><span class="o">/</span><span class="m">0.144</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">s.mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">mn.smp</span><span class="p">,</span><span class="n">cmn.smp</span><span class="p">,</span><span class="n">xmn.smp</span><span class="p">,</span><span class="n">md.smp</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;mean&quot;</span><span class="p">,</span><span class="s">&quot;central&quot;</span><span class="p">,</span><span class="s">&quot;extreme&quot;</span><span class="p">,</span><span class="s">&quot;median&quot;</span><span class="p">)</span>

<span class="n">s.var.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">var.smp</span><span class="p">,</span><span class="n">qvar.smp</span><span class="p">,</span><span class="n">mad.smp</span><span class="p">,</span><span class="n">cvar.smp</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">s.var.smp</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;sv&quot;</span><span class="p">,</span><span class="s">&quot;sqv&quot;</span><span class="p">,</span><span class="s">&quot;mad&quot;</span><span class="p">,</span><span class="s">&quot;central&quot;</span><span class="p">)</span>

<span class="c1">## Obtain the histograms</span>

<span class="n">x.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="p">)</span>
<span class="n">x.mx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="p">)</span>

<span class="n">n.bin.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<span class="n">n.bin.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">mean</span><span class="p">)))</span>
<span class="n">n.bin.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">central</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">central</span><span class="p">)))</span>
<span class="n">n.bin.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">extreme</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">extreme</span><span class="p">)))</span>
<span class="n">n.bin.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">median</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">median</span><span class="p">)))</span>

<span class="n">plt.h.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample mean&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">central</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Central mean&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">extreme</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Extreme mean&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">median</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample median&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>

<span class="n">x.mx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span><span class="o">*</span><span class="nf">max</span><span class="p">(</span><span class="n">s.var.smp</span><span class="p">)</span>

<span class="n">n.bin.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<span class="n">n.bin.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="n">x.mx</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.var.smp</span><span class="o">$</span><span class="n">sv</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.var.smp</span><span class="o">$</span><span class="n">sv</span><span class="p">)))</span>
<span class="n">n.bin.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="n">x.mx</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.var.smp</span><span class="o">$</span><span class="n">sqv</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.var.smp</span><span class="o">$</span><span class="n">sqv</span><span class="p">)))</span>
<span class="n">n.bin.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="n">x.mx</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.var.smp</span><span class="o">$</span><span class="n">mad</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.var.smp</span><span class="o">$</span><span class="n">mad</span><span class="p">)))</span>
<span class="n">n.bin.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="n">x.mx</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.var.smp</span><span class="o">$</span><span class="n">central</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.var.smp</span><span class="o">$</span><span class="n">central</span><span class="p">)))</span>

<span class="n">plt.h.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.var.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sv</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample variance&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.var</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.var.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sqv</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample quasivariance&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.var</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.var.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mad</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;MAD&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.var</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.var.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">central</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Central variance&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.var</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>

<span class="c1">## Plot the histograms</span>

<span class="nf">cat</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&#39;Sample size = %6.0f\n&#39;</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">))</span>
<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.h.1</span><span class="p">,</span><span class="n">plt.h.2</span><span class="p">,</span><span class="n">plt.h.3</span><span class="p">,</span><span class="n">plt.h.4</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Population mean estimators&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.h.5</span><span class="p">,</span><span class="n">plt.h.6</span><span class="p">,</span><span class="n">plt.h.7</span><span class="p">,</span><span class="n">plt.h.8</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Population variance estimators&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size =     30
</pre></div>
</div>
<img alt="_images/c10497d0603a7c4b0d25a7ec3b0fb3d789faf3e78fa7928168c2ab78760237ef.png" src="_images/c10497d0603a7c4b0d25a7ec3b0fb3d789faf3e78fa7928168c2ab78760237ef.png" />
<img alt="_images/259621b7829fd0ea17c430b54508e993fd6c28c0aace902d5a3ab55e1c5809ea.png" src="_images/259621b7829fd0ea17c430b54508e993fd6c28c0aace902d5a3ab55e1c5809ea.png" />
</div>
</div>
<div class="section" id="span-style-color-green-questions-span">
<h4><span style="color:green;">Questions</span><a class="headerlink" href="#span-style-color-green-questions-span" title="Permalink to this headline">#</a></h4>
<p><span style="color:green">Take a look at these plots and answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">Which characteristics of each histogram indicate if a given estimator provides a good approximation to the population value?</span></p></li>
<li><p><span style="color:green">Which estimators are the best ones for each population value of interest?</span></p></li>
<li><p><span style="color:green">How does the quality of the estimators change with the sample size? To do this, change the value of </span> <span style="color:blue;font-family:monospace;font-size:90%;">smp.sz.prop</span> <span style="color:green"> in the preceding cell, or duplicate the cell using different values for this variable</span></p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-blue-examples-of-estimator-bias-span">
<h3><span style="color:blue;">Examples of estimator bias</span><a class="headerlink" href="#span-style-color-blue-examples-of-estimator-bias-span" title="Permalink to this headline">#</a></h3>
<p>In the following cell we represent the histograms of different estimators, and we compare them with the known value of the corresponding population parameter.</p>
<p>We wish to pay particular attention at the possible bias of these different estimators. To help with this, we have also represented in the corresponding plots the mean values, obtained from the generated samples, for these estimators.</p>
<p>In the plots the correct population value is shown in red, while the value of the mean of the sample estimates is shown in blue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Histograms for different estimators (bias comparison)</span>

<span class="c1">## These values can be modified</span>

<span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span>
<span class="n">smp.sz.prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span>

<span class="c1">## Parameters</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">smp.sz.prop</span><span class="o">*</span><span class="n">smp0.sz</span><span class="p">)</span>

<span class="c1">## Generate samples and estimates</span>

<span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">md.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mn.smp</span><span class="p">,</span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span>
<span class="w">    </span><span class="n">md.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">md.smp</span><span class="p">,</span><span class="nf">median</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span>
<span class="w">    </span><span class="n">xmn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">xmn.smp</span><span class="p">,(</span><span class="nf">min</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span><span class="o">+</span><span class="nf">max</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span><span class="o">/</span><span class="m">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">s.mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">mn.smp</span><span class="p">,</span><span class="n">xmn.smp</span><span class="p">,</span><span class="n">md.smp</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;mean&quot;</span><span class="p">,</span><span class="s">&quot;extreme&quot;</span><span class="p">,</span><span class="s">&quot;median&quot;</span><span class="p">)</span>

<span class="c1">## Obtain the histograms</span>

<span class="n">x.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="p">)</span>
<span class="n">x.mx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="p">)</span>

<span class="n">n.bin.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<span class="n">n.bin.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">mean</span><span class="p">)))</span>
<span class="n">n.bin.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">extreme</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">extreme</span><span class="p">)))</span>
<span class="n">n.bin.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">median</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">median</span><span class="p">)))</span>

<span class="n">plt.h.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample mean&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">mean</span><span class="p">),</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">extreme</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Extreme mean&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">extreme</span><span class="p">),</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">median</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample median&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">median</span><span class="p">),</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>

<span class="c1">## Plot the histograms</span>

<span class="nf">cat</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&#39;Sample size = %6.0f&#39;</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">))</span>
<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.h.1</span><span class="p">,</span><span class="n">plt.h.2</span><span class="p">,</span><span class="n">plt.h.3</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Bias comparison for mean estimators&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size =     77
</pre></div>
</div>
<img alt="_images/d01485e1791994de8a3110d38517c79c552f283464de4ac4272420f9c3ed758d.png" src="_images/d01485e1791994de8a3110d38517c79c552f283464de4ac4272420f9c3ed758d.png" />
</div>
</div>
<div class="section" id="id3">
<h4><span style="color:green;">Questions</span><a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h4>
<p><span style="color:green">Take a look at these plots and answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">From this information, could you say that any of these estimators are unbiased/biased?</span></p></li>
<li><p><span style="color:green">Which estimator seems to have the largest bias?</span></p></li>
<li><p><span style="color:green">Is the bias affected by the sample size? You can change the value of </span> <span style="color:blue;font-family:monospace;font-size:90%;">smp.sz.prop</span> <span style="color:green">in the preceding cell, or duplicate the cell using different values for this variable</span></p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-blue-examples-of-estimator-efficiency-span">
<h3><span style="color:blue;">Examples of estimator efficiency</span><a class="headerlink" href="#span-style-color-blue-examples-of-estimator-efficiency-span" title="Permalink to this headline">#</a></h3>
<p>The following cell presents the sample estimates obtained for different estimators, as well as the known value of the corresponding population parameter, in this case the population mean. As a difference with the preceding code cell, we wish to study now the behavior of the different estimators with respect to their efficiency.</p>
<p>We represent the histogram of their values for the different samples, with the aim of comparing the spread of these values, which represents their different efficiencies. The scales of the different histograms have been chosen to be the same, to facilitate the comparisons of these spreads.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Histograms for different estimators (efficiency comparisons)</span>

<span class="c1">## These values can be modified</span>

<span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span>
<span class="n">smp.sz.prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span>

<span class="c1">## Parameters</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">smp.sz.prop</span><span class="o">*</span><span class="n">smp0.sz</span><span class="p">)</span>

<span class="c1">## Generate samples and estimates</span>

<span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xmn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">mn.smp</span><span class="p">,</span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span>
<span class="w">    </span><span class="n">md.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">md.smp</span><span class="p">,</span><span class="nf">median</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span>
<span class="w">    </span><span class="n">xmn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">xmn.smp</span><span class="p">,(</span><span class="nf">min</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span><span class="o">+</span><span class="nf">max</span><span class="p">(</span><span class="n">v.smp</span><span class="p">))</span><span class="o">/</span><span class="m">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">s.mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">mn.smp</span><span class="p">,</span><span class="n">xmn.smp</span><span class="p">,</span><span class="n">md.smp</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;mean&quot;</span><span class="p">,</span><span class="s">&quot;extreme&quot;</span><span class="p">,</span><span class="s">&quot;median&quot;</span><span class="p">)</span>

<span class="c1">## Obtain the histograms</span>

<span class="n">x.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="p">)</span>
<span class="n">x.mx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="p">)</span>

<span class="n">n.bin.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<span class="n">n.bin.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">mean</span><span class="p">)))</span>
<span class="n">n.bin.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">extreme</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">extreme</span><span class="p">)))</span>
<span class="n">n.bin.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">n.bin.0</span><span class="o">*</span><span class="p">(</span><span class="n">x.mx</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x.mn</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">median</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">s.mn.smp</span><span class="o">$</span><span class="n">median</span><span class="p">)))</span>

<span class="n">plt.h.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">mean</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample mean&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">extreme</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Extreme mean&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>
<span class="n">plt.h.3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.mn.smp</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">median</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n.bin.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Sample median&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlim</span><span class="p">(</span><span class="n">x.mn</span><span class="p">,</span><span class="n">x.mx</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span>

<span class="c1">## Plot the histograms</span>

<span class="nf">cat</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&#39;Sample size = %6.0f\n&#39;</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">))</span>
<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.h.1</span><span class="p">,</span><span class="n">plt.h.2</span><span class="p">,</span><span class="n">plt.h.3</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Efficiency comparison for mean estimators&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sample size =     30
</pre></div>
</div>
<img alt="_images/2cb0dfa19ba6c398201726ec995996891c5eded2b28ae98fddb4613f7a9dead6.png" src="_images/2cb0dfa19ba6c398201726ec995996891c5eded2b28ae98fddb4613f7a9dead6.png" />
</div>
</div>
<div class="section" id="id4">
<h4><span style="color:green;">Questions</span><a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h4>
<p><span style="color:green">Take a look at these plots and answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">From this information, which estimator seems to be the most efficient?</span></p></li>
<li><p><span style="color:green">Is the efficiency affected by the sample size? You can change the value of </span> <span style="color:blue;font-family:monospace;font-size:90%;">smp.sz.prop</span> <span style="color:green">in the preceding cell, or duplicate the cell using different values for this variable</span></p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-brown-defining-good-estimators-span">
<h3><span style="color:brown;">Defining good estimators</span><a class="headerlink" href="#span-style-color-brown-defining-good-estimators-span" title="Permalink to this headline">#</a></h3>
<p>Based on the preceding description of the properties we would like to have when defining an estimator, it seems reasonable to ask if there exist general procedures to define estimators <span class="math notranslate nohighlight">\(T\)</span> of a parameter <span class="math notranslate nohighlight">\(\theta\)</span> having these good properties.</p>
<ul class="simple">
<li><p>In some situations, there exists an optimal estimator called the <span style="color:brown">minimum variance unbiased estimator</span>, defined as the estimator with the smallest variance/MSE among all unbiased estimators. This would be our best option.</p>
<ul>
<li><p>For example, the sample mean is the minimum variance unbiased estimator for the population mean when we have normal data.</p></li>
</ul>
</li>
<li><p>If we do not have such an estimator, different methods yield estimators with reasonably good properties. Examples of these methods are:</p>
<ul>
<li><p>Maximum likelihood estimation.</p></li>
<li><p>The method of moments.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="span-style-color-brown-examples-of-estimators-with-good-properties-span">
<h3><span style="color:brown;">Examples of estimators with good properties</span><a class="headerlink" href="#span-style-color-brown-examples-of-estimators-with-good-properties-span" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Examples of population parameters, estimators and estimates. Estimators with low bias and high efficiency:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\small
\begin{array}{llccc}
\text{Population parameter} &amp; \text{Sample value} &amp; T(\underline X_n) &amp; \text{Estimator} &amp; \text{Estimate} \\
\hline
\text{Mean } \mu_X &amp; \text{Sample mean} &amp; \displaystyle \frac{1}{n}(X_1 + \cdots + X_n) &amp; \bar X = \hat \mu_X &amp; \bar x \\
\text{Proportion } p_X &amp; \text{Sample proportion} &amp; \displaystyle \frac{1}{n} (\# \text{ favorable cases}) &amp; \hat p_X &amp; \hat p_x \\
\text{Variance } \sigma^2_X &amp; \text{Sample quasivariance} &amp; \displaystyle \frac{1}{n-1} (X_1^2 + \cdots + X_n^2 - n \bar X^2) &amp; s_X^2 &amp; s_x^2 \\
\hline
\end{array}
\end{split}\]</div>
</div>
</div>
<div class="section" id="span-style-color-brown-confidence-intervals-span">
<h2><span style="color:brown">Confidence intervals</span><a class="headerlink" href="#span-style-color-brown-confidence-intervals-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>Point estimators should provide good approximations to the values of interest, the parameters of the population. But the random nature of the values of the estimator, a consequence of the random nature of our samples, implies that their values, the estimates, will in general be incorrect (they will include errors). From a practical point of view, it is very important to use estimators that have small errors asociated to their estimates, as we have already discussed. And it is also important to be able to provide information on the size of these errors.</p>
<p>The errors will be a consequence of the variability in the approximations provided by a certain estimator for different random samples, obtained from our knowledge of the <span style="color:brown">distribution</span> of the estimators. This use of distributions is significantly different from our treatment of the point estimators; it also implies that many of the definitions and properties we will introduce will depend on probabilities.</p>
<p>The information about the errors can be presented in different ways; some of the most common are:</p>
<ul class="simple">
<li><p>To provide an estimate of the variability of the estimator, from the values of the sample. The most usual estimate is the <span style="color:brown">standard error,</span> that is, the standard deviation of the estimator.</p></li>
<li><p>To construct an interval, which will be referred to as a <span style="color:brown">confidence interval,</span> giving a range of values containing the unknown population value, in most cases.</p></li>
</ul>
<p>This additional information does not aim to improve the error in our estimate; we are obtaining additional information from the inference process that in general is very useful when using our estimates for practical applications.</p>
<div class="section" id="span-style-color-brown-definition-of-confidence-intervals-a-theoretical-example-span">
<h3><span style="color:brown">Definition of confidence intervals: a theoretical example</span><a class="headerlink" href="#span-style-color-brown-definition-of-confidence-intervals-a-theoretical-example-span" title="Permalink to this headline">#</a></h3>
<p>As our estimator is a random variable, it makes sense to compute an interval that will contain the possible values of this random variable with high probability, based on our knowledge of its distribution.</p>
<p>For example, if we consider the sample mean <span class="math notranslate nohighlight">\(\bar X\)</span> as an estimator for the population mean <span class="math notranslate nohighlight">\(\mu\)</span>, and if we can apply the CLT (we have a large enough sample), this result indicates that the sample mean (a sum of independent and identically distributed random variables) follows approximately a normal distribution, and we have</p>
<div class="math notranslate nohighlight">
\[
\bar X \sim_{\scriptsize \text{approx.}} N\left( \mu,\frac{\sigma^2}{n} \right)
\]</div>
<p>It also holds that</p>
<div class="math notranslate nohighlight">
\[
\frac{\bar X - \mu}{s/\sqrt{n}} \sim_{\scriptsize \text{approx.}} N(0,1)
\]</div>
<p>For any given probability <span class="math notranslate nohighlight">\(1 - \alpha\)</span> we can interpret this result as implying that</p>
<div class="math notranslate nohighlight">
\[
\Pr \left( -z_{\alpha} &lt; \frac{\bar X - \mu}{s/\sqrt{n}} \leq z_{\alpha} \right) \approx 1 - \alpha 
\]</div>
<p>where <span class="math notranslate nohighlight">\(z_{\alpha/2}\)</span> is the <span class="math notranslate nohighlight">\(\alpha/2\)</span> right-quantile of a standard normal distribution, <span class="math notranslate nohighlight">\(\Pr(Z &gt; z_{\alpha/2}) = \alpha/2\)</span>. Thus,
the interval <span class="math notranslate nohighlight">\(\mu \mp z_{\alpha/2} s/\sqrt{n}\)</span> contains the values of <span class="math notranslate nohighlight">\(\bar X\)</span> for all simple random samples with probability <span class="math notranslate nohighlight">\(1 - \alpha\)</span> (approximately). We will refer to this probability <span class="math notranslate nohighlight">\(1 - \alpha\)</span> as the <span style="color:brown">confidence level</span> of the interval; it measures how likely is it that the confidence interval will contain the correct (unknown) value.</p>
<p>But as <span class="math notranslate nohighlight">\(\mu\)</span> is an unknown value, this is not the type of interval we wish to obtain. For our case of interest (inference) we know the values for a sample but we do not know the value of <span class="math notranslate nohighlight">\(\mu\)</span>, which we would like to approximate. Fortunately, it is possible to obtain another interval for <span class="math notranslate nohighlight">\(\mu\)</span>, given some estimate for <span class="math notranslate nohighlight">\(\bar X\)</span>, using the formula for the preceding interval. We can rewrite it as</p>
<div class="math notranslate nohighlight">
\[
   \mu \in \left[ \bar x - z_{\alpha/2} \frac{s}{\sqrt{n}} \; ; \; \bar x + z_{\alpha/2} \frac{s}{\sqrt{n}} \right]
\]</div>
<p>This would be an example of a confidence interval, as it provides an interval where the unknown value <span class="math notranslate nohighlight">\(\mu\)</span> can be found for a high proportion of different samples obtained from the same distribution.</p>
<div class="section" id="id5">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h4>
<p><em>An industrial production line is supposed to fill out containers with a substance to a target weight of 16 grams. A quality control inspector selects a sample of forty containers, which yields a sample mean weight of <span class="math notranslate nohighlight">\(16.31\)</span> grams. Its quasi-variance is <span class="math notranslate nohighlight">\(0.82\)</span> grams<span class="math notranslate nohighlight">\({}^2\)</span>.</em></p>
<p><em>Compute a confidence interval for the population mean with a confidence level of 90%</em></p>
<div class="section" id="id6">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h5>
<p>For the population of packages produced in this line, we define the continuous random variable <span class="math notranslate nohighlight">\(X =\)</span> “fill weight of a package”.</p>
<p>We will compute the confidence interval for the population mean based on the statistic</p>
<div class="math notranslate nohighlight">
\[
T = \frac{\bar X - \mu}{S/\sqrt{n}} \sim_{\scriptsize\text{approx.}} N(0,1)
\]</div>
<p>We have selected it as we wish to approximate a population mean from information in a large sample (<span class="math notranslate nohighlight">\(n = 40\)</span>).</p>
<p>For this statistic, the confidence interval corresponding to a confidence level <span class="math notranslate nohighlight">\(1 - \alpha\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
\text{CI}_{1-\alpha} (\mu) = \left[ \bar x - z_{\alpha/2} \frac{s}{\sqrt{n}} \; ; \; \bar x + z_{\alpha/2} \frac{s}{\sqrt{n}} \right]
\]</div>
<p>For our sample we have <span class="math notranslate nohighlight">\(\bar x = 16.31\)</span>, <span class="math notranslate nohighlight">\(s^2 = 0.82\)</span> and <span class="math notranslate nohighlight">\(n = 40\)</span>. Also, from the normal tables (or from R) we have that <span class="math notranslate nohighlight">\(z_{\alpha/2} = z_{0.05} = 1.645\)</span>. Replacing these values we obtain the interval</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\text{CI}_{0.9} (\mu) &amp; = &amp; \left[ 16.31 - 1.645 \sqrt{\frac{0.82}{40}} \; ; \; 16.31 + 1.645 \sqrt{\frac{0.82}{40}} \right] \\
&amp; = &amp; \left[ 16.0745 \; ; \; 16.5455 \right]
\end{array}
\end{split}\]</div>
</div>
</div>
<div class="section" id="span-style-color-blue-definition-of-confidence-intervals-numerical-example-span">
<h4><span style="color:blue;">Definition of confidence intervals: numerical example</span><a class="headerlink" href="#span-style-color-blue-definition-of-confidence-intervals-numerical-example-span" title="Permalink to this headline">#</a></h4>
<p>For our selected data set, if we assume we can apply the CLT to a sample obtained from it (if <span class="math notranslate nohighlight">\(n\)</span> is large enough), we can build the corresponding confidence interval using the preceding formula.</p>
<p>The following code cell shows the results that we obtain if we repeat this process for many samples with the same sample size. The plot shows the intervals obtained for each one of a number of random samples, coded as a blue segment for those intervals that contain the correct value (in this case, the estimate from the full sample), and as a red segment when they do not contain it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">## Confidence intervals from the CLT</span>

<span class="c1">## These values can be modified</span>

<span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span>
<span class="n">smp.sz.prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span>
<span class="n">cf.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span>

<span class="c1">## Parameters</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">floor</span><span class="p">(</span><span class="n">smp.sz.prop</span><span class="o">*</span><span class="n">smp0.sz</span><span class="p">)</span>
<span class="n">sim.nq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="m">0.5</span><span class="o">+</span><span class="n">cf.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="c1">## Generate samples and estimates</span>

<span class="n">sim.ci</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n.samples</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">,</span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span>
<span class="w">    </span><span class="n">sd.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span>
<span class="w">    </span><span class="n">stderr.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sd.smp</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="w">    </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sim.nq</span><span class="o">*</span><span class="n">stderr.smp</span>
<span class="w">    </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sim.nq</span><span class="o">*</span><span class="n">stderr.smp</span>
<span class="w">    </span><span class="nf">if </span><span class="p">((</span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="p">))</span><span class="w"> </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mn.smp</span>
<span class="p">}</span>
<span class="w">    </span>
<span class="c1">## Generate the resulting intervals</span>

<span class="nf">names</span><span class="p">(</span><span class="n">sim.ci</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;xs&quot;</span><span class="p">,</span><span class="s">&quot;xe&quot;</span><span class="p">,</span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="s">&quot;center&quot;</span><span class="p">)</span>
<span class="n">sim.ci</span><span class="o">$</span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">n.samples</span><span class="p">)</span>
<span class="n">aux.lbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">sim.ci</span><span class="o">$</span><span class="n">c</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;outside&quot;</span><span class="p">,</span><span class="s">&quot;inside&quot;</span><span class="p">))</span>
<span class="n">sim.ci</span><span class="o">$</span><span class="n">cv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aux.lbl</span><span class="p">[</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">)]</span>
<span class="w">  </span>
<span class="c1">## Plot the intervals using a color code</span>

<span class="n">mn.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.95</span><span class="o">*</span><span class="nf">min</span><span class="p">(</span><span class="n">sim.ci</span><span class="o">$</span><span class="n">xs</span><span class="p">)</span>
<span class="n">mx.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.05</span><span class="o">*</span><span class="nf">max</span><span class="p">(</span><span class="n">sim.ci</span><span class="o">$</span><span class="n">xe</span><span class="p">)</span>

<span class="n">sim.t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;CLT Confidence intervals. Level %5.2f&quot;</span><span class="p">,</span><span class="n">cf.lvl</span><span class="p">)</span>

<span class="n">sim.ci.plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sim.ci</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">,</span><span class="n">xend</span><span class="o">=</span><span class="n">xe</span><span class="p">,</span><span class="n">yend</span><span class="o">=</span><span class="n">ys</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cv</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_segment</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlim</span><span class="p">(</span><span class="n">mn.x</span><span class="p">,</span><span class="n">mx.x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Population mean&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">n.samples</span><span class="p">,</span><span class="n">vjust</span><span class="o">=</span><span class="m">-1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;outside&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;inside&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">sim.t</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Intervals&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">sim.ci.plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/352b53f430a46b09513d92e40b15c901d0b114c451351ca08f1f2e9fe32a104b.png" src="_images/352b53f430a46b09513d92e40b15c901d0b114c451351ca08f1f2e9fe32a104b.png" />
</div>
</div>
<div class="section" id="id7">
<h5><span style="color:green;">Questions</span><a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h5>
<p><span style="color:green">Based on this plot, answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">Which proportion of “correct” intervals would you expect to observe?</span></p></li>
<li><p><span style="color:green">If you repeat this procedure with different samples (by running again the preceding cell), does the proportion of “correct” intervals change by much?</span></p></li>
<li><p><span style="color:green">Why would you think that the proportion of correct intervals observed may differ from the value indicated by the theory?</span></p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-definition-of-confidence-intervals-a-general-procedure-span">
<h3><span style="color:brown">Definition of confidence intervals: a general procedure</span><a class="headerlink" href="#span-style-color-brown-definition-of-confidence-intervals-a-general-procedure-span" title="Permalink to this headline">#</a></h3>
<p>We wish to derive a general procedure, following an scheme based on the one presented in the preceding example, but applicable to any parameter and any sample/population properties which might hold for our data. In this cell we describe the general steps we would need to follow to obtain our estimate for a confidence interval in this general setting.</p>
<ol class="arabic">
<li><p>We start by identifying <span style="color:brown">the parameter of interest <span class="math notranslate nohighlight">\(\theta\)</span></span>, that is, the population value we would like to approximate. For example, we might be interested in approximating the population mean, the population proportion, the population variance, etc.</p></li>
<li><p>Identify an <span style="color:brown">estimator <span class="math notranslate nohighlight">\(V\)</span> </span> for the parameter <span class="math notranslate nohighlight">\(\theta\)</span>, with good properties of bias and efficiency as commented in our discussion for point estimators. For example, the sample proportion to approximate the population proportion.</p>
<ul class="simple">
<li><p>You must <span style="color:brown">know the distribution</span> of this estimator</p></li>
</ul>
</li>
<li><p>Define a statistic as a function of this estimator, with the property that the statistic <span class="math notranslate nohighlight">\(T\)</span> depends on the value of the parameter <span class="math notranslate nohighlight">\(\theta\)</span>, <span class="math notranslate nohighlight">\(T = T(\theta;V)\)</span>, but its distribution <span class="math notranslate nohighlight">\(F\)</span> (related to the distribution of <span class="math notranslate nohighlight">\(V\)</span>) does not depend on it</p>
<ul class="simple">
<li><p>The estimator <span class="math notranslate nohighlight">\(T\)</span> must have an inverse with respect to <span class="math notranslate nohighlight">\(\theta\)</span>, to ensure that we can solve for <span class="math notranslate nohighlight">\(\theta\)</span> any condition we impose on the value of the estimator.</p></li>
</ul>
</li>
<li><p>Select a <span style="color:brown">confidence level, <span class="math notranslate nohighlight">\(1 - \alpha\)</span>,</span> for the interval. This confidence level will introduce a condition on the probability of the estimator for the interval containing the correct value of the parameter.</p></li>
<li><p>From the distribution of the estimator, <span style="color:brown">find two right quantiles, <span class="math notranslate nohighlight">\(w_{\alpha/2}\)</span> and <span class="math notranslate nohighlight">\(w_{1 - \alpha/2}\)</span>,</span> defined as <span class="math notranslate nohighlight">\(F(w_{\alpha/2}) = 1 - \alpha/2\)</span> and <span class="math notranslate nohighlight">\(F(w_{1-\alpha/2}) = \alpha/2\)</span>.</p>
<ul class="simple">
<li><p>These quantiles will be used to define an <span style="color:brown">interval for the estimator with the desired coverage</span>, that is, these values define an interval <span class="math notranslate nohighlight">\([w_{1 - \alpha/2} ; w_{\alpha/2}]\)</span> with the property that <span class="math notranslate nohighlight">\(\Pr(w_{1 - \alpha/2} &lt; T(\theta;V) \leq w_{\alpha/2}) = 1 - \alpha)\)</span>.</p></li>
</ul>
</li>
<li><p>From this interval for the estimator we <span style="color:brown">compute an interval for the parameter</span>.</p>
<p>If <span class="math notranslate nohighlight">\(T^{-1}(w)\)</span> denotes the inverse of <span class="math notranslate nohighlight">\(T(\theta)\)</span> with respect to <span class="math notranslate nohighlight">\(\theta\)</span>, that is, <span class="math notranslate nohighlight">\(w = T(\theta)\)</span>, then if <span class="math notranslate nohighlight">\(T\)</span> were a decreasing function of <span class="math notranslate nohighlight">\(\theta\)</span> we could obtain the endpoints of the confidence interval from <span class="math notranslate nohighlight">\(w_{1 - \alpha/2} &lt; T(\theta) \leq w_{\alpha/2}\)</span> as <span class="math notranslate nohighlight">\(T^{-1} (w_{1-\alpha/2})\)</span> and <span class="math notranslate nohighlight">\(T^{-1} (w_{\alpha/2})\)</span>.</p>
<p>The confidence interval would then be given by</p>
</li>
</ol>
<div class="math notranslate nohighlight">
\[
\mbox{CI}_{1-\alpha}(\theta) = \left[ T^{-1} (w_{\alpha/2}) \; ;\; T^{-1} (w_{1-\alpha/2}) \right] .
\]</div>
<p>As an example of the construction of this interval based on the use of the inverse function <span class="math notranslate nohighlight">\(T^{-1}\)</span>, if <span class="math notranslate nohighlight">\(T(\mu) = (\bar X - \mu)/(S_X/\sqrt{n})\)</span> then <span class="math notranslate nohighlight">\(T(\mu)\)</span> in this case is a decreasing function of <span class="math notranslate nohighlight">\(\mu\)</span> and we have <span class="math notranslate nohighlight">\(T^{-1} (w) = \bar X - w S_X / \sqrt{n}\)</span>. As a consequence, we obtain the interval</p>
<div class="math notranslate nohighlight">
\[
\mbox{CI}_{1-\alpha}(\theta) = \left[ \bar X - w_{\alpha/2} \frac{S_X}{\sqrt{n}} \; ;\; \bar X - w_{1-\alpha/2} \frac{S_X}{\sqrt{n}} \right] .
\]</div>
</div>
<div class="section" id="span-style-color-brown-confidence-intervals-for-the-population-mean-span">
<h3><span style="color:brown">Confidence intervals for the population mean</span><a class="headerlink" href="#span-style-color-brown-confidence-intervals-for-the-population-mean-span" title="Permalink to this headline">#</a></h3>
<p>Consider the case when <span class="math notranslate nohighlight">\(\theta = \mu\)</span>, that is, when we are interested in a confidence interval for the population mean (step 1 of the general procedure). We will work with a confidence level of <span class="math notranslate nohighlight">\(1 - \alpha\)</span>, and our reference estimator will be the sample mean.</p>
<p>We will consider two cases for which we have a known distribution for the sample mean <span class="math notranslate nohighlight">\(\bar X\)</span>:</p>
<ol class="arabic simple">
<li><p>When we have a sample that is large enough to allow for the application of the Central Limit Theorem.</p></li>
<li><p>When we have normal data.</p></li>
</ol>
<div class="section" id="span-style-color-brown-central-limit-theorem-approximation-span">
<h4><span style="color:brown">Central limit theorem approximation</span><a class="headerlink" href="#span-style-color-brown-central-limit-theorem-approximation-span" title="Permalink to this headline">#</a></h4>
<p>To simplify the characterizaton of its distribution, we start by rewriting out estimator. From the CLT we have that</p>
<div class="math notranslate nohighlight">
\[
    T \equiv \frac{\bar X - \mu}{S/\sqrt{n}} \sim_{\scriptsize \text{approx.}} N(0,1)
\]</div>
<p>For step 5 in the general procedure, we compute the quantiles <span class="math notranslate nohighlight">\(z_{\alpha/2}\)</span> and <span class="math notranslate nohighlight">\(z_{1-\alpha/2}\)</span> from a standard normal distribution. For this distribution (and in general for symmetric distributions with zero mean) it holds that <span class="math notranslate nohighlight">\(z_{1-\alpha/2} = - z_{\alpha/2}\)</span>, so we only need to compute one of the two quantiles. For a confidence level of <span class="math notranslate nohighlight">\(1 - \alpha\)</span> the condition in step 5 would be</p>
<div class="math notranslate nohighlight">
\[
\Pr \left( -z_{\alpha/2} &lt; \frac{\bar X - \mu}{s/\sqrt{n}} \leq z_{\alpha/2} \right) \approx 1 - \alpha 
\]</div>
<p>For example, if <span class="math notranslate nohighlight">\(1-\alpha = 0.95\)</span> then <span class="math notranslate nohighlight">\(z_{0.025} = 1.96\)</span> and <span class="math notranslate nohighlight">\(z_{0.975} = -1.96\)</span>.</p>
<p>Finally, step 6 requires that we solve the inequalities for <span class="math notranslate nohighlight">\(\mu\)</span>, the parameter of interest. Using the values in the sample to obtain the corresponding point estimates we have,</p>
<div class="math notranslate nohighlight">
\[
    -z_{\alpha/2} &lt; \frac{\bar x - \mu}{s/\sqrt{n}} \leq z_{\alpha/2} \ \Leftrightarrow \ \bar x - z_{\alpha/2} \frac{s}{\sqrt{n}} &lt; \mu \leq \bar x + z_{\alpha/2} \frac{s}{\sqrt{n}}
\]</div>
<p>That is,</p>
<div class="math notranslate nohighlight">
\[
    \mbox{CI}_{1-\alpha}(\mu) = \left[ \bar x - z_{\alpha/2} \frac{s}{\sqrt{n}} \; ; \; \bar x + z_{\alpha/2} \frac{s}{\sqrt{n}} \right]
\]</div>
</div>
<div class="section" id="span-style-color-blue-central-limit-theorem-approximation-numerical-example-span">
<h4><span style="color:blue;">Central limit theorem approximation. Numerical example</span><a class="headerlink" href="#span-style-color-blue-central-limit-theorem-approximation-numerical-example-span" title="Permalink to this headline">#</a></h4>
<p>Assume that the data we have considered in this lesson satisfies the assumptions we have specified, that is, that we wish to determine a confidence interval for the population mean based on <span style="color:blue">sz.smp</span> randomly selected observations in our sample, and that this sample size is large enough to apply the CLT.</p>
<p>The following cell illustrates the computations required to obtain this confidence interval, providing the values of the confidence intervals for different confidence levels. The red line in the plot indicates the value of the sample mean (the center of the confidence interval).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confidence interval based on the Central Limit Theorem</span>

<span class="c1">## These values can be modified</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span>

<span class="c1">## Parameters</span>

<span class="n">sz.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="m">30</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">)</span>

<span class="n">cf.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">0.925</span><span class="p">,</span><span class="m">0.95</span><span class="p">,</span><span class="m">0.975</span><span class="p">,</span><span class="m">0.99</span><span class="p">,</span><span class="m">0.999</span><span class="p">)</span>
<span class="n">sim.nq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="m">0.5</span><span class="o">+</span><span class="n">cf.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="c1">## Compute relevant sample summaries</span>

<span class="n">ix.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">smp0.sz</span><span class="p">,</span><span class="n">sz.smp</span><span class="p">)</span>

<span class="n">data.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">[</span><span class="n">ix.smp</span><span class="p">]</span>
<span class="n">smp.sm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">smp.sm2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">data.smp</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="n">smp.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">smp.sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">Sum.fr.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">sz.smp</span><span class="p">,</span><span class="n">smp.sm</span><span class="p">,</span><span class="n">smp.sm2</span><span class="p">,</span><span class="n">smp.mn</span><span class="p">,</span><span class="n">smp.sd</span><span class="p">),</span><span class="m">5</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>

<span class="n">Data.hux.4</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr.4</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Sample size&quot;</span><span class="p">,</span><span class="s">&quot;Sum of values&quot;</span><span class="p">,</span><span class="s">&quot;Sum of squares&quot;</span><span class="p">,</span><span class="s">&quot;Sample mean&quot;</span><span class="p">,</span><span class="s">&quot;Sample quasi-std dev&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Sample summary&quot;</span><span class="p">)</span>

<span class="n">lim.low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.mn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sim.nq</span><span class="o">*</span><span class="n">smp.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sz.smp</span><span class="p">)</span>
<span class="n">lim.high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.mn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sim.nq</span><span class="o">*</span><span class="n">smp.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sz.smp</span><span class="p">)</span>
<span class="n">val.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">cf.lvl</span><span class="p">,</span><span class="n">lim.low</span><span class="p">,</span><span class="n">lim.high</span><span class="p">)</span>
<span class="n">Sum.fr.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">val.5</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Sum.fr.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;CL&quot;</span><span class="p">,</span><span class="s">&quot;Llim&quot;</span><span class="p">,</span><span class="s">&quot;Hlim&quot;</span><span class="p">)</span>

<span class="n">Data.hux.5</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr.5</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;CI 1&quot;</span><span class="p">,</span><span class="s">&quot;CI 2&quot;</span><span class="p">,</span><span class="s">&quot;CI 3&quot;</span><span class="p">,</span><span class="s">&quot;CI 4&quot;</span><span class="p">,</span><span class="s">&quot;CI 5&quot;</span><span class="p">,</span><span class="s">&quot;CI 6&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Confidence level&quot;</span><span class="p">,</span><span class="s">&quot;Lower limit&quot;</span><span class="p">,</span><span class="s">&quot;Higher limit&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Confidence intervals&quot;</span><span class="p">)</span>

<span class="c1">## Plot the intervals</span>

<span class="n">Sum.fr.5</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">sim.ci.plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Sum.fr.5</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Llim</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">CL</span><span class="p">,</span><span class="n">xend</span><span class="o">=</span><span class="n">Hlim</span><span class="p">,</span><span class="n">yend</span><span class="o">=</span><span class="n">CL</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_segment</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp.mn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Confidence intervals using the CLT&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Intervals&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">sim.ci.plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Sample summary

                            Values
---------------------  -----------
Sample size                     50
Sum of values             3591.323
Sum of squares          315308.317
Sample mean                 71.826
Sample quasi-std dev        34.213
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Confidence intervals

        Confidence level   Lower limit   Higher limit
-----  -----------------  ------------  -------------
CI 1                 0.9        63.868         79.785
CI 2               0.925        63.212         80.441
CI 3                0.95        62.343          81.31
CI 4               0.975        60.981         82.671
CI 5                0.99        59.363          84.29
CI 6               0.999        55.905         87.748
</pre></div>
</div>
<img alt="_images/64179cdb3370791a7b7ad2209c8e8a225c09e4ce993db8b4564e6b1bef456f9a.png" src="_images/64179cdb3370791a7b7ad2209c8e8a225c09e4ce993db8b4564e6b1bef456f9a.png" />
</div>
</div>
<div class="section" id="id8">
<h5><span style="color:green;">Questions</span><a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h5>
<p><span style="color:green">From the values indicated in the preceding cell:</span></p>
<ul class="simple">
<li><p><span style="color:green">Repeat the computations by hand based on the first <span class="math notranslate nohighlight">\(n\)</span> observations in our data</span></p></li>
</ul>
<blockquote>
<div><p>To do this, you can replace the instruction <span style="color:blue;font-family:monospace;font-size:90%;">ix.smp = sample(<a class="reference external" href="http://smp0.sz">smp0.sz</a>,sz.smp)</span> in the preceding cell with <span style="color:blue;font-family:monospace;font-size:90%;">ix.smp = 1:sz.smp</span></p>
</div></blockquote>
<ul class="simple">
<li><p><span style="color:green">What is the relationship between the size of the confidence interval and the confidence level?</span></p></li>
<li><p><span style="color:green">Are the confidence intervals reasonable for the data we are considering?</span></p></li>
<li><p><span style="color:green">Can you suggest an explanation for any discrepancies?</span></p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-brown-central-limit-theorem-approximation-for-the-population-proportion-span">
<h4><span style="color:brown">Central limit theorem approximation for the population proportion</span><a class="headerlink" href="#span-style-color-brown-central-limit-theorem-approximation-for-the-population-proportion-span" title="Permalink to this headline">#</a></h4>
<p>We are now interested in approximating a population proportion using a confidence interval. As our statistic we will use the sample proportion.</p>
<p>To obtain a distribution for this statistic, we observe that the proportion of observations in a sample that satisfy a certain condition can be obtained as the mean of a collection of Bernoulli random variables <span class="math notranslate nohighlight">\(Y_k\)</span> that take the value 1 when an individual in the sample satisfies the condition. Note that this mean is the same as the number of individuals satisfying the condition in the sample divided by the total number of individuals, that is, the proportion of interest. Also, the population proportion is the value of the parameter for this Bernoulli random variable, which is also the mean of this random variable.</p>
<p>Thus, the sample proportion is the sample mean of the Bernoulli random variables, and if the sample size is large enough we can apply the CLT to have that</p>
<div class="math notranslate nohighlight">
\[
T \equiv \frac{\hat P - p}{s_Y/\sqrt{n}} \sim_{\scriptsize \text{approx.}} N(0,1) ,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat P\)</span> denotes the sample proportion, <span class="math notranslate nohighlight">\(p\)</span> is the population proportion (the parameter of the Bernoulli random variable) and <span class="math notranslate nohighlight">\(s_Y\)</span> is the sample estimate for the standard deviation of one of the Bernoulli random variables <span class="math notranslate nohighlight">\(Y_k\)</span>. One last observation is that in a Bernoulli random variable the values of the mean and the standard deviation are related, as the distribution has only one parameter and both values depend on it. In particular, if <span class="math notranslate nohighlight">\(Y \sim \mbox{Ber} (p)\)</span> then <span class="math notranslate nohighlight">\(E[Y] = p\)</span> and <span class="math notranslate nohighlight">\(\mbox{SD}(Y) = p(1-p)\)</span>. One consequence is that we can write <span class="math notranslate nohighlight">\(s_Y\)</span>, the estimate for the sample standard deviation of <span class="math notranslate nohighlight">\(Y\)</span>, in terms of the estimated parameter <span class="math notranslate nohighlight">\(\hat p\)</span> as <span class="math notranslate nohighlight">\(\sqrt{\hat p (1 - \hat p)}\)</span>. The statistic we will use is</p>
<div class="math notranslate nohighlight">
\[
T \equiv \frac{\hat P - p}{\sqrt{\hat P(1 - \hat P)/n}} \sim_{\scriptsize \text{approx.}} N(0,1) ,
\]</div>
<p>The remaining steps are similar to those we followed in the preceding case. From step 5 in the general procedure, we compute the quantiles <span class="math notranslate nohighlight">\(z_{\alpha/2}\)</span> and <span class="math notranslate nohighlight">\(z_{1-\alpha/2}\)</span> for a standard normal distribution, with <span class="math notranslate nohighlight">\(z_{1-\alpha/2} = - z_{\alpha/2}\)</span>. For a confidence level of <span class="math notranslate nohighlight">\(1 - \alpha\)</span> the condition in step 5 would be</p>
<div class="math notranslate nohighlight">
\[
\Pr \left( -z_{\alpha/2} &lt; \frac{\hat P - p}{\sqrt{\hat P(1 - \hat P)/n}} \leq z_{\alpha/2} \right) \approx 1 - \alpha 
\]</div>
<p>For example, if <span class="math notranslate nohighlight">\(1-\alpha = 0.90\)</span> then <span class="math notranslate nohighlight">\(z_{0.05} = 1.645\)</span> and <span class="math notranslate nohighlight">\(z_{0.95} = -1.645\)</span>.</p>
<p>Finally, to apply step 6 we solve for <span class="math notranslate nohighlight">\(p\)</span>, the parameter of interest. Using the values in the sample to obtain the corresponding point estimates we have,</p>
<div class="math notranslate nohighlight">
\[
    -z_{\alpha/2} &lt; \frac{\hat p - p}{\sqrt{\hat p(1-\hat p)/n}} \leq z_{\alpha/2} \ \Leftrightarrow \ \hat p - z_{\alpha/2} \sqrt{\frac{\hat p(1 - \hat p)}{n}} &lt; p \leq \hat p + z_{\alpha/2} \sqrt{\frac{\hat p(1 - \hat p)}{n}}
\]</div>
<p>That is, the confidence interval is given by</p>
<div class="math notranslate nohighlight">
\[
    \mbox{CI}_{1-\alpha}(p) = \left[ \hat p - z_{\alpha/2} \sqrt{\frac{\hat p(1 - \hat p)}{n}} \; ; \; \hat p + z_{\alpha/2} \sqrt{\frac{\hat p(1 - \hat p)}{n}} \right]
\]</div>
<p>As a final comment, the usual criteria used to assume that a sample is large enough to apply the CLT  in the case of Bernoulli r.v.’s is that <span class="math notranslate nohighlight">\(n \geq 30\)</span>. But we also require that <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(1-p\)</span> are not too small. In addition to the preceding condition, we also ask that both <span class="math notranslate nohighlight">\(np \geq 5\)</span> and <span class="math notranslate nohighlight">\(n(1-p) \geq 5\)</span> should hold. These criteria are empirical ones, based on the practical results obtained in these cases; the specific reference values would depend on the desired quality of the approximation.</p>
</div>
<div class="section" id="id9">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h4>
<p><em>In 2019 the Internal Revenue Service (IRS) reviewed a random sample of 2000 companies and their balance sheets and found that 58 of them had some sort of miscalculation error.</em></p>
<p><em>Estimate a confidence interval for the population proportion of companies with miscalculation errors, using a significance level of 99%.</em></p>
<div class="section" id="id10">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h5>
<p>Our population will be the companies that reported to the IRS in 2019, and we define a Bernoulli random variable <span class="math notranslate nohighlight">\(X\)</span> taking the value 1 if a company made a miscalculation error in their report, and 0 otherwise.</p>
<p>We will compute the confidence interval for the population proportion based on the statistic</p>
<div class="math notranslate nohighlight">
\[
T = \frac{\hat P - p}{\sqrt{\hat P(1 - \hat P)/n}} \sim_{\scriptsize\text{approx.}} N(0,1)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat P\)</span> denotes the sample proportion (the sample mean of the <span class="math notranslate nohighlight">\(X\)</span> variables), our estimator for the population proportion. We have selected this statistic as we wish to approximate a population proportion from information collected from a large sample (<span class="math notranslate nohighlight">\(n = 2000\)</span>).</p>
<p>For this statistic, the confidence interval corresponding to a confidence level <span class="math notranslate nohighlight">\(1 - \alpha\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
\text{CI}_{1-\alpha} (p) = \left[ \hat p - z_{\alpha/2} \sqrt{\frac{\hat p(1-\hat p)}{n}} \; ; \; \hat p + z_{\alpha/2} \sqrt{\frac{\hat p(1-\hat p)}{n}} \right]
\]</div>
<p>For our sample we have <span class="math notranslate nohighlight">\(\hat p = 58/2000 = 0.026\)</span> and <span class="math notranslate nohighlight">\(n = 2000\)</span>. Also, from the normal tables (or from R) we have that <span class="math notranslate nohighlight">\(z_{\alpha/2} = z_{0.005} = 2.576\)</span>. Replacing these values we obtain the interval</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\text{CI}_{0.99} (p) &amp; = &amp; \left[ 0.026 - 2.576 \sqrt{\frac{0.026\times 0.974}{2000}} \; ; \; 0.026 + 2.576 \sqrt{\frac{0.026\times 0.974}{2000}} \right] \\
&amp; = &amp; \left[ 0.0168 \; ; \; 0.0352 \right]
\end{array}
\end{split}\]</div>
</div>
</div>
<div class="section" id="span-style-color-blue-population-proportion-numerical-example-span">
<h4><span style="color:blue;">Population proportion. Numerical example</span><a class="headerlink" href="#span-style-color-blue-population-proportion-numerical-example-span" title="Permalink to this headline">#</a></h4>
<p>We wish to determine a confidence interval for the population proportion of the observations in our data that are above a certain value, <span style="color:blue">ref.val</span>, based on <span style="color:blue">sz.smp</span> random observations selected from our sample. We assume that the data we are considering satisfies the assumptions we have specified before.</p>
<p>The following cell carries out the computations to obtain this confidence interval. It presents the values we have used to conduct these computations, as well as the results obtained for different confidence levels. The red line represents the value of the sample proportion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confidence interval for a proportion based on the Central Limit Theorem</span>

<span class="c1">## These values can be modified</span>

<span class="n">pct.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.75</span>
<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span>

<span class="c1">## Parameters</span>

<span class="n">ref.val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">quantile</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="n">pct.val</span><span class="p">)</span>
<span class="n">sz.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="m">30</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">)</span>

<span class="n">cf.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">0.925</span><span class="p">,</span><span class="m">0.95</span><span class="p">,</span><span class="m">0.975</span><span class="p">,</span><span class="m">0.99</span><span class="p">,</span><span class="m">0.999</span><span class="p">)</span>
<span class="n">sim.nq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="m">0.5</span><span class="o">+</span><span class="n">cf.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="c1">## Compute relevant sample summaries</span>

<span class="n">ix.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">smp0.sz</span><span class="p">,</span><span class="n">sz.smp</span><span class="p">)</span>

<span class="n">data.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">[</span><span class="n">ix.smp</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">ref.val</span><span class="p">)</span>
<span class="n">smp.ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">smp.pr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">smp.sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.pr</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">smp.pr</span><span class="p">)</span>
<span class="n">Sum.fr.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">sz.smp</span><span class="p">,</span><span class="n">ref.val</span><span class="p">,</span><span class="n">smp.ct</span><span class="p">,</span><span class="n">smp.pr</span><span class="p">,</span><span class="n">smp.sd</span><span class="p">),</span><span class="m">5</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>

<span class="n">Data.hux.4</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr.4</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Sample size&quot;</span><span class="p">,</span><span class="s">&quot;Reference value&quot;</span><span class="p">,</span><span class="s">&quot;Count of values&quot;</span><span class="p">,</span><span class="s">&quot;Sample proportion&quot;</span><span class="p">,</span><span class="s">&quot;Sample quasi-std dev&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Sample summary&quot;</span><span class="p">)</span>

<span class="n">lim.low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.pr</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sim.nq</span><span class="o">*</span><span class="n">smp.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sz.smp</span><span class="p">)</span>
<span class="n">lim.high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.pr</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sim.nq</span><span class="o">*</span><span class="n">smp.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sz.smp</span><span class="p">)</span>
<span class="n">val.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">cf.lvl</span><span class="p">,</span><span class="n">lim.low</span><span class="p">,</span><span class="n">lim.high</span><span class="p">)</span>
<span class="n">Sum.fr.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">val.5</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Sum.fr.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;CL&quot;</span><span class="p">,</span><span class="s">&quot;Llim&quot;</span><span class="p">,</span><span class="s">&quot;Hlim&quot;</span><span class="p">)</span>

<span class="n">Data.hux.5</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr.5</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;CI 1&quot;</span><span class="p">,</span><span class="s">&quot;CI 2&quot;</span><span class="p">,</span><span class="s">&quot;CI 3&quot;</span><span class="p">,</span><span class="s">&quot;CI 4&quot;</span><span class="p">,</span><span class="s">&quot;CI 5&quot;</span><span class="p">,</span><span class="s">&quot;CI 6&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Confidence level&quot;</span><span class="p">,</span><span class="s">&quot;Lower limit&quot;</span><span class="p">,</span><span class="s">&quot;Higher limit&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Confidence intervals&quot;</span><span class="p">)</span>

<span class="c1">## Plot the intervals</span>

<span class="n">Sum.fr.5</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">sim.ci.plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Sum.fr.5</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Llim</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">CL</span><span class="p">,</span><span class="n">xend</span><span class="o">=</span><span class="n">Hlim</span><span class="p">,</span><span class="n">yend</span><span class="o">=</span><span class="n">CL</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_segment</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp.pr</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Confidence intervals for a proportion&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Intervals&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">sim.ci.plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Sample summary

                        Values
---------------------  -------
Sample size                 50
Reference value         99.348
Count of values             15
Sample proportion          0.3
Sample quasi-std dev      0.21
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Confidence intervals

        Confidence level   Lower limit   Higher limit
-----  -----------------  ------------  -------------
CI 1                 0.9         0.251          0.349
CI 2               0.925         0.247          0.353
CI 3                0.95         0.242          0.358
CI 4               0.975         0.233          0.367
CI 5                0.99         0.224          0.376
CI 6               0.999         0.202          0.398
</pre></div>
</div>
<img alt="_images/70df31b09906c5dcc0e2574f7bfa5c8a1f08d36727029b2a9e75d9a1125c6806.png" src="_images/70df31b09906c5dcc0e2574f7bfa5c8a1f08d36727029b2a9e75d9a1125c6806.png" />
</div>
</div>
<div class="section" id="id11">
<h5><span style="color:green;">Questions</span><a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h5>
<p><span style="color:green">From the values indicated in the preceding cell:</span></p>
<ul class="simple">
<li><p><span style="color:green">Repeat the computations by hand based on the first <span class="math notranslate nohighlight">\(n\)</span> observations in our data</span></p></li>
<li><p><span style="color:green">Are these confidence intervals reasonable for the data we are considering?</span></p></li>
<li><p><span style="color:green">Can you suggest an explanation for any discrepancies?</span></p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-brown-normal-data-span">
<h4><span style="color:brown">Normal data</span><a class="headerlink" href="#span-style-color-brown-normal-data-span" title="Permalink to this headline">#</a></h4>
<p>In the preceding cases we have made use of the CLT to derive an estimator with a known distribution that we used to apply the general procedure. But the CLT requires that we have a sufficiently large sample, and in some practical cases the size of the available sample might be small.</p>
<p>Under certain assumptions on our data, there exist estimators with known distributions, even for small samples. The most common situation when this is possible corresponds to normal data, that is, if we can assume that the population we are studying follows a normal distribution. In this case it can be shown that</p>
<div class="math notranslate nohighlight">
\[
T \equiv \frac{\bar X - \mu}{S/\sqrt{n}} \sim t_{n-1} ,
\]</div>
<p>where <span class="math notranslate nohighlight">\(t_{n-1}\)</span> denotes a Student t distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom. This distribution is described in some detail in <span class="xref myst">Appendix 1</span>, and the theoretical results justifying that our estimator follows this distribution are given in <span class="xref myst">Appendix 2</span>.</p>
<p>This estimator is defined in a way that is very similar to the ones we have introduced for the preceding cases, with the main difference being the distribution of the estimator.</p>
<p>We will use the property that the Student t distribution is symmetric around zero. We will need to compute its quantiles, and this can be done using the R function <span style="color:blue;font-family:monospace;font-size:90%;">qt</span>, as we will see in the following code cell.</p>
<p>To follow the general procedure, in step 5 we compute the quantiles <span class="math notranslate nohighlight">\(t_{n-1;\alpha/2}\)</span> and <span class="math notranslate nohighlight">\(t_{n-1;1-\alpha/2}\)</span> from a Student t distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom, <span class="math notranslate nohighlight">\(T_{n-1}\)</span>, where <span class="math notranslate nohighlight">\(\Pr(T_{n-1} &gt; t_{n-1;\alpha/2}) = \alpha/2\)</span>. From the symmetry of the distribution it holds that <span class="math notranslate nohighlight">\(t_{n-1;1-\alpha/2} = - t_{n-1;\alpha/2}\)</span>, so we only need to compute one of the two quantiles. For a confidence level of <span class="math notranslate nohighlight">\(1 - \alpha\)</span> the condition in step 5 would be</p>
<div class="math notranslate nohighlight">
\[
\Pr \left( -t_{n-1;\alpha/2} &lt; \frac{\bar X - \mu}{s/\sqrt{n}} \leq t_{n-1;\alpha/2} \right) = 1 - \alpha 
\]</div>
<p>For example, if <span class="math notranslate nohighlight">\(n = 15\)</span> and <span class="math notranslate nohighlight">\(1-\alpha = 0.95\)</span> then <span class="math notranslate nohighlight">\(t_{14;0.025} = 2.145\)</span>.</p>
<p>As our last step, we solve for <span class="math notranslate nohighlight">\(\mu\)</span>, the parameter of interest. Using the values in the sample to obtain the corresponding point estimates we have,</p>
<div class="math notranslate nohighlight">
\[
-t_{n-1;\alpha/2} &lt; \frac{\bar x - \mu}{s/\sqrt{n}} \leq t_{n-1;\alpha/2} \ \Leftrightarrow \ \bar x - t_{n-1;\alpha/2} \frac{s}{\sqrt{n}} &lt; \mu \leq \bar x + t_{n-1;\alpha/2} \frac{s}{\sqrt{n}}
\]</div>
<p>That is,</p>
<div class="math notranslate nohighlight">
\[
\mbox{CI}_{1-\alpha}(\mu) = \left[ \bar x - t_{n-1;\alpha/2} \frac{s}{\sqrt{n}} \; ; \; \bar x + t_{n-1;\alpha/2} \frac{s}{\sqrt{n}} \right]
\]</div>
</div>
<div class="section" id="id12">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h4>
<p><em>The time required to process the purchases of a client in a supermarket follows a normal distribution. For a simple random sample of 15 clients, the following processing times (in minutes) were recorded:</em></p>
<div class="math notranslate nohighlight">
\[
\begin{array}{ccccccccccccccc}
5 &amp; 6.2 &amp; 4.8 &amp; 5.2 &amp; 5.2 &amp; 6.4 &amp; 4.9 &amp; 5.3 &amp; 4.2 &amp; 5 &amp; 5.9 &amp; 5.1 &amp; 6 &amp; 4.9 &amp; 5
\end{array}
\]</div>
<p><em>Find a confidence interval at 95% for the population mean time required to process one client.</em></p>
<div class="section" id="id13">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h5>
<p>For the population of packages produced in this line, we define the continuous random variable <span class="math notranslate nohighlight">\(X =\)</span> “processing time of one client (in minutes)”.</p>
<p>We will compute the confidence interval for the population mean based on the statistic</p>
<div class="math notranslate nohighlight">
\[
T = \frac{\bar X - \mu}{S/\sqrt{n}} \sim t_{n-1}
\]</div>
<p>We have selected it as we wish to approximate a population mean when our population is assumed to follow a normal distribution.</p>
<p>For this statistic, the confidence interval corresponding to a confidence level <span class="math notranslate nohighlight">\(1 - \alpha\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
\text{CI}_{1-\alpha} (\mu) = \left[ \bar x - t_{n-1;\alpha/2} \frac{s}{\sqrt{n}} \; ; \; \bar x + t_{n-1;\alpha/2} \frac{s}{\sqrt{n}} \right]
\]</div>
<p>For the given sample we have <span class="math notranslate nohighlight">\(\bar x = 5.2733\)</span>, <span class="math notranslate nohighlight">\(s^2 = 0.35495\)</span> and <span class="math notranslate nohighlight">\(n = 15\)</span>. Also, from the tables for the Student t distribution (or from R) we have that <span class="math notranslate nohighlight">\(t_{n-1;\alpha/2} = t_{14;0.025} = 2.145\)</span>. Replacing these values we obtain the interval</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\text{CI}_{0.95} (\mu) &amp; = &amp; \displaystyle \left[ 5.2733 - 2.145 \sqrt{\frac{0.35495}{15}} \; ; \; 5.2733 + 2.145 \sqrt{\frac{0.35495}{15}} \right] \\
&amp; = &amp; \left[ 4.9433  \; ; \; 5.6033 \right]
\end{array}
\end{split}\]</div>
</div>
</div>
<div class="section" id="span-style-color-blue-mean-of-normal-data-numerical-example-span">
<h4><span style="color:blue;">Mean of normal data. Numerical example</span><a class="headerlink" href="#span-style-color-blue-mean-of-normal-data-numerical-example-span" title="Permalink to this headline">#</a></h4>
<p>We wish to determine a confidence interval for the population mean of the values in the sample, based on <span style="color:blue;font-family:monospace;font-size:90%;">sz.smp</span> random observations in our sample. We assume that the data we are considering satisfies the assumptions we have specified before, and in particular that the population follows a normal distribution.</p>
<p>The following cell carries out the computations to obtain this confidence interval. We show the value of the quantities required to obtain a confidence interval for the selected sample, as well as the confidence intervals for several confidence levels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confidence interval for the mean for normal data</span>

<span class="c1">## These values can be modified</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>

<span class="c1">## Parameters</span>

<span class="n">cf.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">0.925</span><span class="p">,</span><span class="m">0.95</span><span class="p">,</span><span class="m">0.975</span><span class="p">,</span><span class="m">0.99</span><span class="p">,</span><span class="m">0.999</span><span class="p">)</span>
<span class="n">sim.nq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="m">0.5</span><span class="o">+</span><span class="n">cf.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="c1">## Compute relevant sample summaries</span>

<span class="n">ix.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">smp0.sz</span><span class="p">,</span><span class="n">sz.smp</span><span class="p">)</span>

<span class="n">data.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">[</span><span class="n">ix.smp</span><span class="p">]</span>
<span class="n">smp.sm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">smp.sm2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">data.smp</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="n">smp.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">smp.sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">Sum.fr.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">,</span><span class="n">smp.sm</span><span class="p">,</span><span class="n">smp.sm2</span><span class="p">,</span><span class="n">smp.mn</span><span class="p">,</span><span class="n">smp.sd</span><span class="p">),</span><span class="m">5</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>

<span class="n">Data.hux.4</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr.4</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Sample size&quot;</span><span class="p">,</span><span class="s">&quot;Sum of values&quot;</span><span class="p">,</span><span class="s">&quot;Sum of squares&quot;</span><span class="p">,</span><span class="s">&quot;Sample mean&quot;</span><span class="p">,</span><span class="s">&quot;Sample quasi-std dev&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Sample summary&quot;</span><span class="p">)</span>

<span class="n">lim.low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.mn</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sim.nq</span><span class="o">*</span><span class="n">smp.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sz.smp</span><span class="p">)</span>
<span class="n">lim.high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.mn</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sim.nq</span><span class="o">*</span><span class="n">smp.sd</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sz.smp</span><span class="p">)</span>
<span class="n">val.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">cf.lvl</span><span class="p">,</span><span class="n">lim.low</span><span class="p">,</span><span class="n">lim.high</span><span class="p">)</span>
<span class="n">Sum.fr.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">val.5</span><span class="p">,</span><span class="m">3</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Sum.fr.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;CL&quot;</span><span class="p">,</span><span class="s">&quot;Llim&quot;</span><span class="p">,</span><span class="s">&quot;Hlim&quot;</span><span class="p">)</span>

<span class="n">Data.hux.5</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr.5</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;CI 1&quot;</span><span class="p">,</span><span class="s">&quot;CI 2&quot;</span><span class="p">,</span><span class="s">&quot;CI 3&quot;</span><span class="p">,</span><span class="s">&quot;CI 4&quot;</span><span class="p">,</span><span class="s">&quot;CI 5&quot;</span><span class="p">,</span><span class="s">&quot;CI 6&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Confidence level&quot;</span><span class="p">,</span><span class="s">&quot;Lower limit&quot;</span><span class="p">,</span><span class="s">&quot;Higher limit&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Confidence intervals&quot;</span><span class="p">)</span>

<span class="c1">## Plot the intervals</span>

<span class="n">Sum.fr.5</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">sim.ci.plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Sum.fr.5</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Llim</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">CL</span><span class="p">,</span><span class="n">xend</span><span class="o">=</span><span class="n">Hlim</span><span class="p">,</span><span class="n">yend</span><span class="o">=</span><span class="n">CL</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_segment</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp.mn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Confidence intervals using the CLT&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Intervals&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">sim.ci.plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Sample summary

                            Values
---------------------  -----------
Sample size                     20
Sum of values             3629.928
Sum of squares          316703.658
Sample mean                 72.599
Sample quasi-std dev        32.943
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Confidence intervals

        Confidence level   Lower limit   Higher limit
-----  -----------------  ------------  -------------
CI 1                 0.9        64.543         80.654
CI 2               0.925        63.823         81.374
CI 3                0.95        62.848          82.35
CI 4               0.975        61.262         83.936
CI 5                0.99         59.27         85.927
CI 6               0.999        54.506         90.691
</pre></div>
</div>
<img alt="_images/a548664f9a7ca9b560d2fec32d5f5b38547c861f0a41897a03cef9b023df7ff6.png" src="_images/a548664f9a7ca9b560d2fec32d5f5b38547c861f0a41897a03cef9b023df7ff6.png" />
</div>
</div>
<div class="section" id="id14">
<h5><span style="color:green;">Questions</span><a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h5>
<p><span style="color:green">From the values indicated in the preceding cell:</span></p>
<ul class="simple">
<li><p><span style="color:green">Repeat the computations by hand based on the first <span class="math notranslate nohighlight">\(n\)</span> observations in our data</span></p></li>
<li><p><span style="color:green">Are these confidence intervals reasonable for the data we are considering?</span></p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-blue-mean-of-normal-data-numerical-example-ii-span">
<h4><span style="color:blue;">Mean of normal data. Numerical example (ii)</span><a class="headerlink" href="#span-style-color-blue-mean-of-normal-data-numerical-example-ii-span" title="Permalink to this headline">#</a></h4>
<p>In the following cell we show different confidence intervals for the mean of the population, obtained from different samples randomly selected from our data and using the formula based on the assumption of normality. The intervals are plotted in different colors, depending on the interval containing the correct value (a blue interval) or not (a red interval).</p>
<p>In order to compute these intervals we have assumed that we have normal data, but this assumption may not hold for real data. We also check, using a QQ-plot, if this normality assumption is reasonable in our case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confidence interval for the mean for normal data</span>

<span class="c1">## These values can be modified</span>

<span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span>
<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<span class="n">cf.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span>

<span class="c1">## Parameters</span>

<span class="n">sim.nq.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qnorm</span><span class="p">(</span><span class="m">0.5</span><span class="o">+</span><span class="n">cf.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="c1">## Generate samples and estimates</span>

<span class="n">sim.ci</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n.samples</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">,</span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span>
<span class="w">    </span><span class="n">sd.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span>
<span class="w">    </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sim.nq.1</span><span class="o">*</span><span class="n">sd.smp</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="w">    </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mn.smp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sim.nq.1</span><span class="o">*</span><span class="n">sd.smp</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="w">    </span><span class="nf">if </span><span class="p">((</span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">smp0.mn</span><span class="p">))</span><span class="w"> </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mn.smp</span>
<span class="p">}</span>
<span class="w">    </span>
<span class="c1">## Generate the resulting intervals</span>

<span class="nf">names</span><span class="p">(</span><span class="n">sim.ci</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;xs&quot;</span><span class="p">,</span><span class="s">&quot;xe&quot;</span><span class="p">,</span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="s">&quot;center&quot;</span><span class="p">)</span>
<span class="n">sim.ci</span><span class="o">$</span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">n.samples</span><span class="p">)</span>
<span class="n">aux.lbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">sim.ci</span><span class="o">$</span><span class="n">c</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;outside&quot;</span><span class="p">,</span><span class="s">&quot;inside&quot;</span><span class="p">))</span>
<span class="n">sim.ci</span><span class="o">$</span><span class="n">cv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aux.lbl</span><span class="p">[</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">)]</span>
<span class="w">  </span>
<span class="c1">## Plot the intervals using a color code</span>

<span class="n">mn.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.95</span><span class="o">*</span><span class="nf">min</span><span class="p">(</span><span class="n">sim.ci</span><span class="o">$</span><span class="n">xs</span><span class="p">)</span>
<span class="n">mx.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.05</span><span class="o">*</span><span class="nf">max</span><span class="p">(</span><span class="n">sim.ci</span><span class="o">$</span><span class="n">xe</span><span class="p">)</span>

<span class="n">sim.t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Confidence intervals for the mean. Level %5.2f&quot;</span><span class="p">,</span><span class="n">cf.lvl</span><span class="p">)</span>

<span class="n">sim.ci.plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sim.ci</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">,</span><span class="n">xend</span><span class="o">=</span><span class="n">xe</span><span class="p">,</span><span class="n">yend</span><span class="o">=</span><span class="n">ys</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cv</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_segment</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlim</span><span class="p">(</span><span class="n">mn.x</span><span class="p">,</span><span class="n">mx.x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Population mean&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">smp0.mn</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">n.samples</span><span class="p">,</span><span class="n">vjust</span><span class="o">=</span><span class="m">-1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;outside&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;inside&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">sim.t</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Intervals&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">sim.ci.plot</span><span class="p">)</span>

<span class="c1">## Are the observations normal?</span>

<span class="n">data.sel</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Val</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">stat_qq_band</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">stat_qq_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">stat_qq_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Normal QQ-plot&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Theoretical quantiles&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Sample quantiles&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">13</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/70379a04be505bec11f79de2467abaf342d03891408fa2572db51cbba33f60fa.png" src="_images/70379a04be505bec11f79de2467abaf342d03891408fa2572db51cbba33f60fa.png" />
<img alt="_images/a7a43640cbbe7685f504e5104fa4b4f72e75ad094d75d9e148b88d616cbe980e.png" src="_images/a7a43640cbbe7685f504e5104fa4b4f72e75ad094d75d9e148b88d616cbe980e.png" />
</div>
</div>
<div class="section" id="id15">
<h5><span style="color:green;">Questions</span><a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h5>
<p><span style="color:green">From the plots shown in the preceding cell:</span></p>
<ul class="simple">
<li><p><span style="color:green">Are the confidence levels shown for these confidence intervals close to the theoretical ones?</span></p></li>
<li><p><span style="color:green">Would you think it would be reasonable to consider this data as normal?</span></p></li>
<li><p><span style="color:green">Can you suggest an explanation for any differences between the theoretical and the observed confidence levels?</span></p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-confidence-intervals-for-the-population-variance-span">
<h3><span style="color:brown">Confidence intervals for the population variance</span><a class="headerlink" href="#span-style-color-brown-confidence-intervals-for-the-population-variance-span" title="Permalink to this headline">#</a></h3>
<p>We now consider the case when <span class="math notranslate nohighlight">\(\theta = \sigma^2\)</span>, that is, we are interested in a confidence interval for the population variance (step 1 of the general procedure). Our estimator will be the sample quasivariance <span class="math notranslate nohighlight">\(S^2\)</span>, which is an unbiased estimator for the population variance.</p>
<p>In this case, the CLT is not very useful to derive a distribution for our estimator <span class="math notranslate nohighlight">\(S^2\)</span>, and we will only consider the particular case when we have normal data.</p>
<h4 style="color:brown">Normal data</h4>
<p>To derive its distribution, we rewrite out estimator <span class="math notranslate nohighlight">\(S^2\)</span> as</p>
<div class="math notranslate nohighlight">
\[
T \equiv \frac{(n-1)S^2}{\sigma^2} \sim \chi^2_{n-1}
\]</div>
<p>where under the assumption that <span class="math notranslate nohighlight">\(X \sim N(\mu,\sigma)\)</span> it holds that <span class="math notranslate nohighlight">\(T\)</span> follows a chi squared distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom. This distribution is described in some detail in <span class="xref myst">Appendix 1</span>, and the theoretical results justifying that our estimator follows this distribution are given in <span class="xref myst">Appendix 2</span>.</p>
<p>Assume we are given a confidence level <span class="math notranslate nohighlight">\(1 - \alpha\)</span>. We note that this distribution takes only nonnegative values and it is not symmetric. Thus, we will need to compute two quantiles for this confidence level, which can be done by using the R function <span style="color:blue;font-family:monospace;font-size:90%;">qchisq</span>.</p>
<p>For step 5 in the general procedure, as the distribution is not symmetric, for a confidence level of <span class="math notranslate nohighlight">\(1 - \alpha\)</span> we need to obtain the quantiles <span class="math notranslate nohighlight">\(\chi^2_{n-1;\alpha/2}\)</span> and <span class="math notranslate nohighlight">\(\chi^2_{n-1;1-\alpha/2}\)</span> from a chi squared distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom, that is, we need to find two values satisfying <span class="math notranslate nohighlight">\(\Pr (\chi^2_{n-1} &gt; \chi^2_{n-1;\alpha/2} ) = \alpha/2\)</span> and <span class="math notranslate nohighlight">\(\Pr (\chi^2_{n-1} &gt; \chi^2_{n-1;1-\alpha/2} ) = 1-\alpha/2\)</span>, so that</p>
<div class="math notranslate nohighlight">
\[
\Pr \left( \chi^2_{n-1;1-\alpha/2} &lt; \frac{(n-1)S^2}{\sigma^2} \leq \chi^2_{n-1;\alpha/2} \right) = 1 - \alpha 
\]</div>
<p>Then, in step 6 we solve for <span class="math notranslate nohighlight">\(\sigma^2\)</span>, the parameter of interest. Using the values in the sample to obtain the corresponding point estimates we have,</p>
<div class="math notranslate nohighlight">
\[
\chi^2_{n-1;1-\alpha/2} &lt; \frac{(n-1)s^2}{\sigma^2} \leq \chi^2_{n-1;\alpha/2} \ \Leftrightarrow \ \frac{(n-1)s^2}{\chi^2_{n-1;\alpha/2} } &lt; \sigma^2 \leq \frac{(n-1)s^2}{\chi^2_{n-1;1-\alpha/2} }
\]</div>
<p>That is,</p>
<div class="math notranslate nohighlight">
\[
\mbox{CI}_{1-\alpha}(\sigma^2) = \left[ \frac{(n-1)s^2}{\chi^2_{n-1;\alpha/2}} \; ; \; \frac{(n-1)s^2}{\chi^2_{n-1;1-\alpha/2}} \right]
\]</div>
<div class="section" id="id16">
<h4><span style="color:red">Exercise</span><a class="headerlink" href="#id16" title="Permalink to this headline">#</a></h4>
<p><em>A survey was conducted to determine the variability in the number of study hours per week required by the students of a certain course. We assume this number follows a normal distribution. A simple random sample of 10 students provided the following values:</em></p>
<div class="math notranslate nohighlight">
\[
\begin{array}{cccccccccc}
28 &amp; 5 &amp; 6 &amp; 30 &amp; 25 &amp; 15 &amp; 12 &amp; 25 &amp; 20 &amp; 18
\end{array}
\]</div>
<p><em>Construct a confidence interval at the 95% level for the standard deviation of the weekly study hours.</em></p>
<div class="section" id="id17">
<h5><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id17" title="Permalink to this headline">#</a></h5>
<p>Define the continuous random variable <span class="math notranslate nohighlight">\(X =\)</span> “weekly study hours of a student”. We will compute the requested confidence interval for the population standard deviation by obtaining first the corresponding interval for the population variance. We will use the statistic</p>
<div class="math notranslate nohighlight">
\[
T = \frac{(n-1)S^2}{\sigma^2} \sim \chi^2_{n-1}
\]</div>
<p>We have selected it as we wish to approximate a population variance when we assume that we have normal data.</p>
<p>From the sample data we compute the sample mean <span class="math notranslate nohighlight">\(\bar{x} = (28 + \cdots + 18)/10 = 18.4\)</span>, and estimate the population variance <span class="math notranslate nohighlight">\(\sigma^2\)</span> using its unbiased estimator, the sample quasi-variance. We obtain
$<span class="math notranslate nohighlight">\(
s^2 = \frac{1}{n-1} \left( \sum_{i=1}^n x_i^2 - n \bar x^2 \right) = \frac{1}{9} \left( 28^2 + \cdots + 18 - 10\times 18.4^2 \right) = 78.044.
\)</span>$</p>
<p>A confidence interval at the <span class="math notranslate nohighlight">\(1-\alpha\)</span> level for <span class="math notranslate nohighlight">\(\sigma^2\)</span> will be given by</p>
<div class="math notranslate nohighlight">
\[
\text{CI}_{1-\alpha} (\sigma^2) = \left[ \frac{(n-1) s^2}{\chi_{n-1, \alpha/2}^2}, \frac{(n-1) s^2}{\chi_{n-1, 1-\alpha/2}^2} \right].
\]</div>
<p>Replacing the values <span class="math notranslate nohighlight">\(n = 10\)</span>, <span class="math notranslate nohighlight">\(s^2 = 78.044\)</span>, <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>, and obtaining the values <span class="math notranslate nohighlight">\(\chi_{9; 0.025}^2 = 19.023\)</span> and <span class="math notranslate nohighlight">\(\chi_{9; 0.975}^2 = 2.70\)</span> from R (or from the chi squared table), we compute the following confidence interval for <span class="math notranslate nohighlight">\(\sigma^2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\text{CI}_{1-\alpha} (\sigma^2) &amp; = &amp; \left[ \displaystyle \frac{9\times 78.044}{19.023}, \frac{9\times 78.044}{2.70} \right] \\
&amp; = &amp; [36.924 \, ; \, 260.11]
\end{array}
\end{split}\]</div>
<p>Taking the square roots of the end points for the preceding interval, we obtain the following interval for <span class="math notranslate nohighlight">\(\sigma\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\text{CI}_{1-\alpha} (\sigma) = [6.077 \, ; \, 16.128].
\]</div>
</div>
</div>
<div class="section" id="span-style-color-blue-variance-of-normal-data-numerical-example-span">
<h4><span style="color:blue;">Variance of normal data - Numerical example</span><a class="headerlink" href="#span-style-color-blue-variance-of-normal-data-numerical-example-span" title="Permalink to this headline">#</a></h4>
<p>We wish to determine a confidence interval for the population variance of the values in the sample, based on the first <span style="color:blue;font-family:monospace;font-size:90%;">sz.smp</span> observations in our sample. We assume that the data we are considering satisfies the assumptions we have specified before, and in particular that the population follows a normal distribution.</p>
<p>The following cell carries out the computations to obtain this confidence interval. We show the values required to obtain a confidence interval for the selected sample, as well as the confidence intervals for several confidence levels. Observe the assymmetry of the intervals in this case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confidence interval for the variance for normal data</span>

<span class="c1">## These values can be modified</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>

<span class="c1">## Parameters</span>

<span class="n">cf.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">0.925</span><span class="p">,</span><span class="m">0.95</span><span class="p">,</span><span class="m">0.975</span><span class="p">,</span><span class="m">0.99</span><span class="p">,</span><span class="m">0.999</span><span class="p">)</span>
<span class="n">sim.nq1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="m">0.5</span><span class="o">-</span><span class="n">cf.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="n">sim.nq2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="m">0.5</span><span class="o">+</span><span class="n">cf.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="n">smp.sz</span><span class="m">-1</span><span class="p">,</span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="c1">## Compute relevant sample summaries</span>

<span class="n">ix.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">smp0.sz</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">)</span>

<span class="n">data.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">[</span><span class="n">ix.smp</span><span class="p">]</span>
<span class="n">smp.sm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">smp.sm2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">data.smp</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="n">smp.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">smp.var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="n">Sum.fr.4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">,</span><span class="n">smp.sm</span><span class="p">,</span><span class="n">smp.sm2</span><span class="p">,</span><span class="n">smp.mn</span><span class="p">,</span><span class="n">smp.sd</span><span class="p">),</span><span class="m">5</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="m">3</span><span class="p">))</span>

<span class="n">Data.hux.4</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr.4</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;Sample size&quot;</span><span class="p">,</span><span class="s">&quot;Sum of values&quot;</span><span class="p">,</span><span class="s">&quot;Sum of squares&quot;</span><span class="p">,</span><span class="s">&quot;Sample mean&quot;</span><span class="p">,</span><span class="s">&quot;Sample quasi-std dev&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.4</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Sample summary&quot;</span><span class="p">)</span>

<span class="n">lim.low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">smp.sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="n">smp.var</span><span class="o">/</span><span class="n">sim.nq2</span>
<span class="n">lim.high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">smp.sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="n">smp.var</span><span class="o">/</span><span class="n">sim.nq1</span>
<span class="n">val.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">cf.lvl</span><span class="p">,</span><span class="n">lim.low</span><span class="p">,</span><span class="n">lim.high</span><span class="p">)</span>
<span class="n">Sum.fr.5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="n">val.5</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Sum.fr.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;CL&quot;</span><span class="p">,</span><span class="s">&quot;Llim&quot;</span><span class="p">,</span><span class="s">&quot;Hlim&quot;</span><span class="p">)</span>

<span class="n">Data.hux.5</span><span class="w"> </span><span class="o">&lt;-</span>
<span class="w">  </span><span class="nf">hux</span><span class="p">(</span><span class="n">Sum.fr.5</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_bold</span><span class="p">(</span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">set_all_borders</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">)</span>

<span class="nf">rownames</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;CI 1&quot;</span><span class="p">,</span><span class="s">&quot;CI 2&quot;</span><span class="p">,</span><span class="s">&quot;CI 3&quot;</span><span class="p">,</span><span class="s">&quot;CI 4&quot;</span><span class="p">,</span><span class="s">&quot;CI 5&quot;</span><span class="p">,</span><span class="s">&quot;CI 6&quot;</span><span class="p">)</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Confidence level&quot;</span><span class="p">,</span><span class="s">&quot;Lower limit&quot;</span><span class="p">,</span><span class="s">&quot;Higher limit&quot;</span><span class="p">)</span>
<span class="nf">table_prnt</span><span class="p">(</span><span class="n">Data.hux.5</span><span class="p">[</span><span class="m">-1</span><span class="p">,],</span><span class="s">&quot;Confidence intervals&quot;</span><span class="p">)</span>

<span class="c1">## Plot the intervals</span>

<span class="n">Sum.fr.5</span><span class="o">$</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">sim.ci.plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Sum.fr.5</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Llim</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">CL</span><span class="p">,</span><span class="n">xend</span><span class="o">=</span><span class="n">Hlim</span><span class="p">,</span><span class="n">yend</span><span class="o">=</span><span class="n">CL</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_segment</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp.var</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Confidence intervals using the CLT&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Intervals&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">sim.ci.plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Sample summary

                            Values
---------------------  -----------
Sample size                     20
Sum of values             1363.536
Sum of squares          116449.019
Sample mean                 68.177
Sample quasi-std dev        32.943
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Table: Confidence intervals

        Confidence level   Lower limit   Higher limit
-----  -----------------  ------------  -------------
CI 1                 0.9       779.191       2321.591
CI 2               0.925      750.6165      2451.0383
CI 3                0.95      714.9438      2637.1215
CI 4               0.975      663.5175      2967.2444
CI 5                0.99       608.766      3431.8621
CI 6               0.999      510.8978      4781.3396
</pre></div>
</div>
<img alt="_images/dfbdcd3f9487549dd6d106e594d053c3da7e881d9db7ff402a749eab9edc41fb.png" src="_images/dfbdcd3f9487549dd6d106e594d053c3da7e881d9db7ff402a749eab9edc41fb.png" />
</div>
</div>
<div class="section" id="id18">
<h5><span style="color:green;">Questions</span><a class="headerlink" href="#id18" title="Permalink to this headline">#</a></h5>
<p><span style="color:green">From the values indicated in the preceding cell:</span></p>
<ul class="simple">
<li><p><span style="color:green">Repeat the computations by hand based on the first <span class="math notranslate nohighlight">\(n\)</span> observations in the data</span></p></li>
<li><p><span style="color:green">Are these confidence intervals reasonable for the data we are considering?</span></p></li>
<li><p><span style="color:green">Can you suggest an explanation for any discrepancies?</span></p></li>
</ul>
</div>
</div>
<div class="section" id="span-style-color-blue-variance-of-normal-data-numerical-example-ii-span">
<h4><span style="color:blue;">Variance of normal data - Numerical example (ii)</span><a class="headerlink" href="#span-style-color-blue-variance-of-normal-data-numerical-example-ii-span" title="Permalink to this headline">#</a></h4>
<p>In the following cell we compute different confidence intervals for the variance of the population, obtained from different samples randomly selected from our data and assuming that we have normal data. The intervals are plotted in different colors, depending on the interval containing the correct value (a blue interval) or not (a red interval).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">## Confidence intervals for the variance assuming normal data</span>

<span class="c1">## These values can be modified</span>

<span class="n">n.samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span>
<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span>
<span class="n">cf.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span>

<span class="c1">## Parameters</span>

<span class="n">sim.nq.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="m">0.5</span><span class="o">-</span><span class="n">cf.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="n">sim.nq.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="m">0.5</span><span class="o">+</span><span class="n">cf.lvl</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">smp.sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="c1">## Generate samples and estimates</span>

<span class="n">sim.ci</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">matrix</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">n.samples</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">n.samples</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">v.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">,</span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">    </span><span class="n">var.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">v.smp</span><span class="p">)</span>
<span class="w">    </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">smp.sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="n">var.smp</span><span class="o">/</span><span class="n">sim.nq.2</span>
<span class="w">    </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">smp.sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="n">var.smp</span><span class="o">/</span><span class="n">sim.nq.1</span>
<span class="w">    </span><span class="nf">if </span><span class="p">((</span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">smp0.var</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">smp0.var</span><span class="p">))</span><span class="w"> </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="n">sim.ci</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">var.smp</span>
<span class="p">}</span>
<span class="w">    </span>
<span class="c1">## Generate the resulting intervals</span>

<span class="nf">names</span><span class="p">(</span><span class="n">sim.ci</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;xs&quot;</span><span class="p">,</span><span class="s">&quot;xe&quot;</span><span class="p">,</span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="s">&quot;center&quot;</span><span class="p">)</span>
<span class="n">sim.ci</span><span class="o">$</span><span class="n">ys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="n">n.samples</span><span class="p">)</span>
<span class="n">aux.lbl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="n">sim.ci</span><span class="o">$</span><span class="n">c</span><span class="p">),</span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;outside&quot;</span><span class="p">,</span><span class="s">&quot;inside&quot;</span><span class="p">))</span>
<span class="n">sim.ci</span><span class="o">$</span><span class="n">cv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aux.lbl</span><span class="p">[</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">)]</span>
<span class="w">  </span>
<span class="c1">## Plot the intervals using a color code</span>

<span class="n">mn.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.95</span><span class="o">*</span><span class="nf">min</span><span class="p">(</span><span class="n">sim.ci</span><span class="o">$</span><span class="n">xs</span><span class="p">)</span>
<span class="n">mx.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.05</span><span class="o">*</span><span class="nf">max</span><span class="p">(</span><span class="n">sim.ci</span><span class="o">$</span><span class="n">xe</span><span class="p">)</span>

<span class="n">sim.t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&quot;Confidence intervals for the variance. Level %5.2f&quot;</span><span class="p">,</span><span class="n">cf.lvl</span><span class="p">)</span>

<span class="n">sim.ci.plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sim.ci</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xs</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">ys</span><span class="p">,</span><span class="n">xend</span><span class="o">=</span><span class="n">xe</span><span class="p">,</span><span class="n">yend</span><span class="o">=</span><span class="n">ys</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cv</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_segment</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">smp0.var</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlim</span><span class="p">(</span><span class="n">mn.x</span><span class="p">,</span><span class="n">mx.x</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Population variance&quot;</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">smp0.var</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">n.samples</span><span class="p">,</span><span class="n">vjust</span><span class="o">=</span><span class="m">-1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;brown&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;outside&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;inside&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">sim.t</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Values&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Intervals&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">sim.ci.plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/98aca243dbc3fb0a897e44defa196f50fed64617043859b65552429c55b44b02.png" src="_images/98aca243dbc3fb0a897e44defa196f50fed64617043859b65552429c55b44b02.png" />
</div>
</div>
<div class="section" id="id19">
<h5><span style="color:green;">Questions</span><a class="headerlink" href="#id19" title="Permalink to this headline">#</a></h5>
<p><span style="color:green">Based on this plot, answer the following questions:</span></p>
<ul class="simple">
<li><p><span style="color:green">If you repeat this procedure with different samples (by running again the preceding cell), does the proportion of “correct” intervals change in a noticeable manner?</span></p></li>
<li><p><span style="color:green">Why would you think that the proportion of correct intervals observed may differ from the value indicated by the theory?</span></p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-confidence-interval-length-and-sample-sizes-span">
<h2><span style="color:brown">Confidence interval length and sample sizes</span><a class="headerlink" href="#span-style-color-brown-confidence-interval-length-and-sample-sizes-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>In general, we would prefer to obtain shorter confidence intervals, which would imply a smaller error in our estimates. The length of a confidence interval in general will depend on:</p>
<ul class="simple">
<li><p>The <span style="color:brown">variability in our data:</span> the larger it is, the longer the confidence interval.</p></li>
<li><p>The <span style="color:brown">confidence level:</span> the higher the confidence level, the longer the confidence interval.</p></li>
<li><p>The <span style="color:brown">sample size:</span> the larger the sample size, the shorter the confidence interval.</p></li>
</ul>
<p>In the preceding comments we assume all other values remain the same.</p>
<p>In practice, the only value we can change to obtain a meaningful reduction in the confidence interval length is the sample size, as the variability is a property of the data and decreases in the confidence level imply both a reduction of the length of the interval and a decrease in our confidence on getting the correct value in the interval. In the particular case of confidence intervals for the population mean, the length of the interval depends (mostly) on the square root of the sample size. We could use the formulas for these confidence intervals to obtain a sample size that would yield a desired interval length.</p>
<p>For example, if <span class="math notranslate nohighlight">\(L\)</span> denotes this desired interval (half) length, and we consider the case of a confidence interval for the population mean obtained using the CLT, the value of the sample size <span class="math notranslate nohighlight">\(n\)</span> that would provide the desired interval length would be given by</p>
<div class="math notranslate nohighlight">
\[
\text{Interval length} = 2 z_{\alpha/2} \frac{s}{\sqrt{n}} = 2L \quad \Rightarrow \quad n = \left( \frac{z_{\alpha/2} s}{L} \right)^2
\]</div>
<p>It is important to note that this sample size will only be approximate, as the value of <span class="math notranslate nohighlight">\(s\)</span> depends on the sample.</p>
<p>The following cell presents two plots of the confidence interval lengths associated to different sample sizes, for the cases when we have normal data and we wish to approximate the population mean or the population variance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confidence intervals for different sample sizes</span>

<span class="c1">## These values can be modified</span>

<span class="n">smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">15</span><span class="p">,</span><span class="m">120</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">cf.lvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="m">0.95</span><span class="p">,</span><span class="m">0.99</span><span class="p">)</span>

<span class="c1">## Interval sizes</span>

<span class="n">l.smp.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="n">cil.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cil.var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cil.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cil.cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NULL</span>
<span class="nf">for </span><span class="p">(</span><span class="n">cf.v</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">cf.lvl</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">for </span><span class="p">(</span><span class="n">s.sz</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">smp.sz</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">q.t.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="m">0.5</span><span class="o">+</span><span class="n">cf.v</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="w">        </span><span class="n">q.chi.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="m">0.5</span><span class="o">-</span><span class="n">cf.v</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="w">        </span><span class="n">q.chi.2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qchisq</span><span class="p">(</span><span class="m">0.5</span><span class="o">+</span><span class="n">cf.v</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s.sz</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">lower.tail</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="w">        </span><span class="n">data.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="n">data.sel</span><span class="o">$</span><span class="n">Val</span><span class="p">,</span><span class="n">s.sz</span><span class="p">,</span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="w">        </span><span class="n">s.smp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">data.smp</span><span class="p">)</span>
<span class="w">        </span><span class="n">cil.mn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">cil.mn</span><span class="p">,</span><span class="m">2</span><span class="o">*</span><span class="n">q.t.1</span><span class="o">*</span><span class="n">s.smp</span><span class="o">/</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">s.sz</span><span class="p">))</span>
<span class="w">        </span><span class="n">cil.var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">cil.var</span><span class="p">,(</span><span class="n">s.sz</span><span class="m">-1</span><span class="p">)</span><span class="o">*</span><span class="n">s.smp</span><span class="o">^</span><span class="m">2</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="o">/</span><span class="n">q.chi.1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="o">/</span><span class="n">q.chi.2</span><span class="p">))</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">cil.sz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">cil.sz</span><span class="p">,</span><span class="n">smp.sz</span><span class="p">)</span>
<span class="w">    </span><span class="n">cil.cl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">cil.cl</span><span class="p">,</span><span class="nf">rep</span><span class="p">(</span><span class="n">cf.v</span><span class="p">,</span><span class="n">l.smp.sz</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">cil.df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">valm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cil.mn</span><span class="p">,</span><span class="w"> </span><span class="n">vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cil.var</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cil.sz</span><span class="p">,</span><span class="w"> </span><span class="n">conflvl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">cil.cl</span><span class="p">))</span>

<span class="c1">## Generate plots</span>

<span class="n">cil.plot.m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cil.df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valm</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conflvl</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conflvl</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conflvl</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Confidence interval lengths for the mean (normal data)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Length&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Sample size&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>
<span class="n">cil.plot.s</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cil.df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vals</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conflvl</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conflvl</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conflvl</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme_bw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Confidence interval lengths for the variance (normal data)&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Length&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Sample size&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">cil.plot.m</span><span class="p">,</span><span class="n">cil.plot.s</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Lengths of confidence intervals&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/be69e2e0043780a96fdb65a58344964a960b63fc6ba03ef8ba8a09b7e8f57548.png" src="_images/be69e2e0043780a96fdb65a58344964a960b63fc6ba03ef8ba8a09b7e8f57548.png" />
</div>
</div>
<div class="section" id="id20">
<h3><span style="color:green;">Questions</span><a class="headerlink" href="#id20" title="Permalink to this headline">#</a></h3>
<p><span style="color:green">Comment on these statements regarding the length of confidence intervals and its relationship to sample sizes:</span></p>
<ul class="simple">
<li><p><span style="color:green">Are the preceding formulas for sample sizes applicable to all the cases considered in the lesson? For example, what would be the formula for the sample size required to attain a certain confidence interval length in the case of intervals for population proportions?</span></p></li>
<li><p><span style="color:green">Given a desired interval length, how could you compute a value for <span class="math notranslate nohighlight">\(n\)</span> in the case of normal data and an interval for the population mean? And for the population variance?</span></p></li>
</ul>
</div>
<div class="section" id="id21">
<h3><span style="color:red">Exercise</span><a class="headerlink" href="#id21" title="Permalink to this headline">#</a></h3>
<p><em>In 2019 the Internal Revenue Service (IRS) looked at a random sample of 2000 companies and their balance sheets and found that 58 of them had some sort of miscalculation error.</em></p>
<p><em>Assuming that the value of the sample proportion would not change significantly when the sample size is increased, determine the smallest sample size ensuring that the half-length of the confidence interval for the population proportion, at a significance level of 99%, would be smaller than <span class="math notranslate nohighlight">\(0.005\)</span>.</em></p>
<div class="section" id="id22">
<h4><span style="color:red">Exercise. Solution</span><a class="headerlink" href="#id22" title="Permalink to this headline">#</a></h4>
<p>Our population will be the companies that reported to the IRS in 2019, and we define a Bernoulli random variable <span class="math notranslate nohighlight">\(X\)</span> taking the value 1 if a company made a miscalculation error in their report, and 0 otherwise. Our statistic to obtain a confidence interval for the population proportion will be</p>
<div class="math notranslate nohighlight">
\[
T = \frac{\hat P - p}{\sqrt{\hat P(1 - \hat P)/n}} \sim_{\scriptsize\text{approx.}} N(0,1)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat P\)</span> denotes the sample proportion.</p>
<p>For this statistic, the confidence interval corresponding to a confidence level <span class="math notranslate nohighlight">\(1 - \alpha\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
\text{CI}_{1-\alpha} (p) = \left[ \hat p - z_{\alpha/2} \sqrt{\frac{\hat p(1-\hat p)}{n}} \; ; \; \hat p + z_{\alpha/2} \sqrt{\frac{\hat p(1-\hat p)}{n}} \right]
\]</div>
<p>For our sample we have <span class="math notranslate nohighlight">\(\hat p = 58/2000 = 0.026\)</span> and <span class="math notranslate nohighlight">\(n = 2000\)</span>. Also, from the normal tables (or from R) we have that <span class="math notranslate nohighlight">\(z_{\alpha/2} = z_{0.005} = 2.576\)</span>. Replacing these values we obtain the interval</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
\text{CI}_{0.99} (p) &amp; = &amp; \displaystyle \left[ 0.026 - 2.576 \sqrt{\frac{0.026\times 0.974}{2000}} \; ; \; 0.026 + 2.576 \sqrt{\frac{0.026\times 0.974}{2000}} \right] \\
&amp; = &amp; \left[ 0.0168 \; ; \; 0.0352 \right]
\end{array}
\end{split}\]</div>
<p>In general, the half-length of this interval is the difference between its upper limit and its center,</p>
<div class="math notranslate nohighlight">
\[
\text{half-length} = \hat p + z_{\alpha/2} \sqrt{\frac{\hat p(1-\hat p)}{n}} - \hat p = z_{\alpha/2} \sqrt{\frac{\hat p(1-\hat p)}{n}}
\]</div>
<p>and for our particular sample this half-length takes the value <span class="math notranslate nohighlight">\(0.0352 - 0.026 = 0.0092\)</span>. As this value is larger than the requested size (<span class="math notranslate nohighlight">\(0.0092 &gt; 0.005\)</span>), we must increase the sample size to a new value <span class="math notranslate nohighlight">\(n'\)</span>.</p>
<p>Using a prime symbol to denote the values corresponding to the new sample, imposing the condition that the new half-length (as a function of <span class="math notranslate nohighlight">\(n'\)</span>) is equal to the desired value, and assuming that <span class="math notranslate nohighlight">\(\hat p' \approx \hat p\)</span>, we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{rcl}
&amp; &amp; \text{half-length} = \displaystyle z_{\alpha/2} \sqrt{\frac{\hat p'(1-\hat p')}{n'}} \approx \displaystyle z_{\alpha/2} \sqrt{\frac{\hat p(1-\hat p)}{n'}} = 0.005 \\
&amp; \Rightarrow &amp; n' = \displaystyle \left( z_{\alpha/2} \frac{\sqrt{\hat p(1-\hat p)}}{0.005} \right)^2 = \left( 2.576 \frac{\sqrt{0.026\times 0.974}}{0.005} \right)^2 = 6721.78
\end{array}
\end{split}\]</div>
<p>implying that for a sample size approximately equal to 6720 we should get a half-length of our confidence interval very close to <span class="math notranslate nohighlight">\(0.005\)</span>.</p>
</div>
</div>
</div>
<div class="section" id="span-style-color-brown-estimators-and-confidence-intervals-summary-span">
<h2><span style="color:brown">Estimators and confidence intervals. Summary</span><a class="headerlink" href="#span-style-color-brown-estimators-and-confidence-intervals-summary-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<ul class="simple">
<li><p>The confidence intervals we have introduced in the preceding paragraphs can be summarized as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\small
\begin{array}{llccc}
\text{Parameter} &amp; \text{Estimator} &amp; \text{Statistic} &amp; \text{Distribution} &amp; \text{Confidence interval} \\[3pt]
\hline
\text{Mean } \mu &amp; \text{Sample mean } \bar X &amp; \frac{\bar X - \mu}{S/\sqrt{n}} &amp; N(0,1) &amp; \left[ \bar x - z_{\alpha/2} \frac{s}{\sqrt{n}} \; ; \; \bar x + z_{\alpha/2} \frac{s}{\sqrt{n}} \right] \\
&amp; &amp; \frac{\bar X - \mu}{S/\sqrt{n}} &amp; t_{n-1} &amp; \left[ \bar x - t_{n-1;\alpha/2} \frac{s}{\sqrt{n}} \; ; \; \bar x + t_{n-1;\alpha/2} \frac{s}{\sqrt{n}} \right] \\[3pt]
\hline
\text{Proportion } p &amp; \text{Sample proportion } \hat P &amp; \frac{\hat P - p}{\sqrt{\hat P(1 - \hat P)/n}} &amp; N(0,1) &amp; \left[ \hat p - z_{\alpha/2} \sqrt{\frac{\hat p(1 - \hat p)}{n}} \; ; \; \hat p + z_{\alpha/2} \sqrt{\frac{\hat p(1 - \hat p)}{n}} \right] \\[3pt]
\hline
\text{Variance } \sigma^2 &amp; \text{Sample quasivariance } S^2 &amp; \frac{(n-1)S^2}{\sigma^2} &amp; \chi^2_{n-1} &amp; \left[ \frac{(n-1)s^2}{\chi^2_{n-1;\alpha/2}} \; ; \; \frac{(n-1)s^2}{\chi^2_{n-1;1-\alpha/2}} \right] \\[3pt]
\hline
\end{array}
\end{split}\]</div>
<ul class="simple">
<li><p>The assumptions we require to hold in order to use the preceding formulas are:</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Assumptions</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mean</p></td>
<td><p>Large sample size</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Normal data</p></td>
</tr>
<tr class="row-even"><td><p>Proportion</p></td>
<td><p>Large sample size</p></td>
</tr>
<tr class="row-odd"><td><p>Variance</p></td>
<td><p>Normal data</p></td>
</tr>
</tbody>
</table>
<hr class="docutils" />
</div>
<hr class="docutils" />
<div class="section" id="span-style-color-orange-appendix-1-distributions-associated-to-the-normal-span">
<h2><span style="color:orange">Appendix 1: Distributions associated to the normal</span><a class="headerlink" href="#span-style-color-orange-appendix-1-distributions-associated-to-the-normal-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>In the preceding results, and in particular in those based on the assumption of normal data, we have used statistics that follow distributions different from, although related to, the normal distribution. In the following paragraphs we provide some descriptive information about these distributions.</p>
<p><a id='App1_1_Csq'></a></p>
<div class="section" id="span-style-color-orange-the-chi-squared-distribution-span">
<h3><span style="color:orange">The chi squared distribution</span><a class="headerlink" href="#span-style-color-orange-the-chi-squared-distribution-span" title="Permalink to this headline">#</a></h3>
<p>The variance and quasivariance of a sample are defined as a sum (an average) of squares of the differences between the values of the observations and the sample mean. When the data follow a normal distribution, each of these differences is also normal, and it can be shown that (a certain number of) these variables are independent. We define the chi squared distribution as the distribution of the sum of the squares of <span class="math notranslate nohighlight">\(n\)</span> independent standard normal random variables. Assume that <span class="math notranslate nohighlight">\(X_1,\ldots,X_n\)</span> are independent standard normal random variables, then we define</p>
<div class="math notranslate nohighlight">
\[
   Y \equiv X_1^2 + \cdots + X_n^2 ,
\]</div>
<p>and we say that <span class="math notranslate nohighlight">\(Y\)</span>, the sum of the squares of the <span class="math notranslate nohighlight">\(X_i\)</span> variables, follows a chi squared distribution with <span class="math notranslate nohighlight">\(n\)</span> degrees of freedom, <span class="math notranslate nohighlight">\(Y \sim \chi^2_n\)</span>. This distribution is useful for example when studying the variance of a sample of normal random variables.</p>
<p>As this distribution is defined from a sum of squares, it takes values in <span class="math notranslate nohighlight">\([0,\infty)\)</span>. Also, it is not symmetric around its mean and, due to this asymmetry, its median is smaller than its mean.</p>
<p><a id='App1_1_Std'></a></p>
</div>
<div class="section" id="span-style-color-orange-the-student-t-distribution-span">
<h3><span style="color:orange">The Student t distribution</span><a class="headerlink" href="#span-style-color-orange-the-student-t-distribution-span" title="Permalink to this headline">#</a></h3>
<p>The estimator for the mean of a normal population, based on the sample mean, is defined as the ratio of two random variables, the sample mean and the sample quasi-standard deviation. This ratio is commonly found when working with normal random variables, as it is associated with the standardization of a normal random variable. A specific distribution has been introduced to represent this ratio of random variables. If we have <span class="math notranslate nohighlight">\(Y\)</span> defined as before, following a chi squared distribution with <span class="math notranslate nohighlight">\(n\)</span> degrees of freedom, and <span class="math notranslate nohighlight">\(X\)</span> is a standard normal random variable independent of the variables <span class="math notranslate nohighlight">\(X_1,\ldots,X_n\)</span> used in the definition of <span class="math notranslate nohighlight">\(Y\)</span>, then we define</p>
<div class="math notranslate nohighlight">
\[
   W \equiv \frac{X}{\sqrt{Y/n}} ,
\]</div>
<p>and we say that <span class="math notranslate nohighlight">\(W\)</span>, given by the ratio of these two variables, follows a Student t distribution with <span class="math notranslate nohighlight">\(n\)</span> degrees of freedom, <span class="math notranslate nohighlight">\(W \sim t_n\)</span>. This distribution is particularly useful when working with the mean of a sample of normal random variables with unknown population variance, which we approximate using the sample quasivariance, for example.</p>
<p>It corresponds to a normal random variable scaled using a positive random value, so it takes values in <span class="math notranslate nohighlight">\([-\infty,\infty)\)</span>. It is symmetric around its mean, equal to the mean of <span class="math notranslate nohighlight">\(X\)</span>, which is 0. Its appearance is very similar to that of a standard normal distribution, but with heavier tails. When <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span>, a Student t distribution converges to a standard normal distribution.</p>
</div>
<div class="section" id="span-style-color-orange-summary-of-statistics-for-these-distributions-span">
<h3><span style="color:orange">Summary of statistics for these distributions</span><a class="headerlink" href="#span-style-color-orange-summary-of-statistics-for-these-distributions-span" title="Permalink to this headline">#</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
\small
\begin{array}{lcccccc}
\text{Distribution} &amp; \text{Deg freedom} &amp; \text{Domain} &amp; \text{Mean} &amp; \text{Median} &amp; \text{Variance} &amp; \text{Asymmetry} \\
\hline
\text{Student t} &amp; n &amp; (-\infty , \infty) &amp; 0 &amp; 0 &amp; \frac{n}{n-2}, \text{ for } n &gt; 2 &amp; 0, \text{ for } n &gt; 3 \\
\text{Chi squared} &amp; n &amp; [0 , \infty) &amp; n &amp; \approx n\left( 1 - \frac{2}{9n} \right)^3 &amp; 2n &amp; \sqrt{\frac{8}{n}}
\end{array}
\end{split}\]</div>
<div class="section" id="span-style-color-orange-graphical-representation-of-their-density-functions-span">
<h4><span style="color:orange;">Graphical representation of their density functions</span><a class="headerlink" href="#span-style-color-orange-graphical-representation-of-their-density-functions-span" title="Permalink to this headline">#</a></h4>
<p>The following cell shows some plots with the densities for these two distributions, for different values of their degrees of freedom. You can select these numbers of degrees of freedom used in the plots by modifying the values of the variable <span style="color:blue;font-family:monospace;font-size:90%;">deg.fr</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Graphical representations of the Student t and chi squared densities</span>

<span class="c1">## These values can be modified</span>
<span class="c1">## Numbers of degrees of freedom for the densities to be plotted (include between 1 and 6 values)</span>

<span class="n">deg.fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">15</span><span class="p">)</span>

<span class="c1">## Plot the densities</span>

<span class="n">mx.df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span>
<span class="n">l.df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">deg.fr</span><span class="p">)</span>
<span class="nf">if </span><span class="p">(</span><span class="n">l.df</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">mx.df</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">deg.fr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deg.fr</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">mx.df</span><span class="p">]</span>
<span class="w">    </span><span class="n">l.df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mx.df</span>
<span class="p">}</span>

<span class="n">col.v.gen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;#619CFF&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#00BFC4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#00BF7D&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#33CCCC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#33FFCC&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#99CCFF&quot;</span><span class="p">)</span>
<span class="n">col.v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v.gen</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="n">l.df</span><span class="p">]</span>

<span class="n">xlm.u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.5</span>
<span class="n">xlm.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">xlm.u</span>

<span class="n">plot.f1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">xlm.l</span><span class="p">,</span><span class="w"> </span><span class="n">xlm.u</span><span class="p">),</span><span class="w"> </span><span class="n">c.fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>

<span class="n">plt.t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c.fn</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot.f1</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">deg.fr</span><span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot.f1</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dnorm</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Normal density&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">xlm.l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0.8</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.02</span><span class="p">),</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Density of a Student t distribution&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Value&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Density&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="s">&quot;df&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deg.fr</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;df&quot;</span><span class="p">)</span>

<span class="nf">if </span><span class="p">(</span><span class="n">l.df</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="n">l.df</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">plot.fi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">xlm.l</span><span class="p">,</span><span class="w"> </span><span class="n">xlm.u</span><span class="p">),</span><span class="w"> </span><span class="n">c.fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">        </span><span class="n">plt.t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt.t</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot.fi</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">deg.fr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">xlm.l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="n">xlm.u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="o">*</span><span class="nf">max</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="nf">max</span><span class="p">(</span><span class="n">deg.fr</span><span class="p">))</span>

<span class="n">plot.f1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">xlm.l</span><span class="p">,</span><span class="w"> </span><span class="n">xlm.u</span><span class="p">),</span><span class="w"> </span><span class="n">c.fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="m">1</span><span class="p">))</span>

<span class="n">plt.c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="kc">NULL</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">c.fn</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot.f1</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dchisq</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">deg.fr</span><span class="p">[</span><span class="m">1</span><span class="p">]))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot.f1</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dchisq</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">annotate</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s">&quot;text&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;ChiSq 10 df&quot;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span>
<span class="w">             </span><span class="n">x</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">xlm.l</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0.01</span><span class="p">),</span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Density of a Chi squared distribution&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Value&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Density&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_colour_manual</span><span class="p">(</span><span class="s">&quot;df&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">col.v</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">deg.fr</span><span class="p">,</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">face</span><span class="o">=</span><span class="s">&quot;bold.italic&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="o">=</span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;df&quot;</span><span class="p">)</span>

<span class="nf">if </span><span class="p">(</span><span class="n">l.df</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="n">l.df</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">plot.fi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">xlm.l</span><span class="p">,</span><span class="w"> </span><span class="n">xlm.u</span><span class="p">),</span><span class="w"> </span><span class="n">c.fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">        </span><span class="n">plt.c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt.c</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">stat_function</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plot.fi</span><span class="p">,</span><span class="w"> </span><span class="n">fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dchisq</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">deg.fr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="nf">suppressWarnings</span><span class="p">(</span><span class="nf">grid.arrange</span><span class="p">(</span><span class="n">plt.t</span><span class="p">,</span><span class="n">plt.c</span><span class="p">,</span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">                              </span><span class="n">top</span><span class="o">=</span><span class="nf">textGrob</span><span class="p">(</span><span class="s">&quot;Densities of normal related distributions&quot;</span><span class="p">,</span><span class="n">gp</span><span class="o">=</span><span class="nf">gpar</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e7c5f05268d2d3260a7c1cc60def60aba0b13df25bc191b246824467edbff017.png" src="_images/e7c5f05268d2d3260a7c1cc60def60aba0b13df25bc191b246824467edbff017.png" />
</div>
</div>
<p><a id='App1_2'></a></p>
</div>
</div>
</div>
<div class="section" id="span-style-color-orange-appendix-2-justification-of-test-statistics-distributions-span">
<h2><span style="color:orange;">Appendix 2: Justification of test statistics distributions</span><a class="headerlink" href="#span-style-color-orange-appendix-2-justification-of-test-statistics-distributions-span" title="Permalink to this headline">#</a></h2>
<hr class="docutils" />
<p>In this appendix we present results to justify some of the distributions we have introduced in this lesson, for the case of <span style="color:brown">normal populations.</span> In what follows we will assume that <span class="math notranslate nohighlight">\(X_i \sim N(\mu , \sigma^2)\)</span> and all the <span class="math notranslate nohighlight">\(X_i\)</span> are independent.</p>
<div class="section" id="span-style-color-orange-distribution-of-the-statistic-for-the-population-variance-span">
<h3><span style="color:orange;">Distribution of the statistic for the population variance</span><a class="headerlink" href="#span-style-color-orange-distribution-of-the-statistic-for-the-population-variance-span" title="Permalink to this headline">#</a></h3>
<p><span style="color:brown">The following derivation makes use of results from matrix algebra and multivariate statistics.</span></p>
<p>We wish to study the distribution of the statistic</p>
<div class="math notranslate nohighlight">
\[
T_{\sigma^2} = \frac{(n-1) S^2}{\sigma^2}
\]</div>
<p>Using matrix notation, we can write the sample quasivariance <span class="math notranslate nohighlight">\(S^2\)</span> as</p>
<div class="math notranslate nohighlight">
\[
S^2 = \frac{1}{n-1} \sum_{i=1}^n (X_i - \bar X) = \frac{1}{n-1} Y^T Y , \qquad Y \equiv (I - \frac{1}{n} e e^T ) X \equiv M X
\]</div>
<p>where <span class="math notranslate nohighlight">\(X\)</span> denotes the vector with components <span class="math notranslate nohighlight">\((X_i)\)</span>, and <span class="math notranslate nohighlight">\(e\)</span> denotes the vector with all components equal to 1.</p>
<p>The covariance of <span class="math notranslate nohighlight">\(Y\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
\text{Var}(Y) = \text{Var}(M X) = M \text{Var}(X) M^T = \left( I - \frac{1}{n} e e^T \right) \sigma^2 I \left( I - \frac{1}{n} e e^T \right)^T = \sigma^2 \left( I - \frac{1}{n} e e^T \right)
\]</div>
<p>But note that the variables <span class="math notranslate nohighlight">\(Y\)</span> are not independent, as the elements outside the diagonal of their covariance matrix (the covariances between pairs of variables) are not equal to zero. Note that for pairs of normal random variables a necessary and sufficient condition for them to be independent is that they are uncorrelated.</p>
<p>Define an orthogonal matrix <span class="math notranslate nohighlight">\(Q \in \mathbb{R}^{n\times (n-1)}\)</span> with columns corresponding to an orthonormal basis for the subspace of dimension <span class="math notranslate nohighlight">\(n-1\)</span> orthogonal to <span class="math notranslate nohighlight">\(e\)</span> (such that <span class="math notranslate nohighlight">\(Q^T e = 0\)</span>). Also, let <span class="math notranslate nohighlight">\(\hat Q = \left( \begin{array}{cc} Q &amp; e/\sqrt{n} \end{array} \right)\)</span>.</p>
<p>Define a new set of <span class="math notranslate nohighlight">\(n-1\)</span> variables <span class="math notranslate nohighlight">\(W_i\)</span> as the components of <span class="math notranslate nohighlight">\(W \equiv Q^T Y \in \mathbb{R}^{n-1}\)</span>; these variables are linear combinations of the normal random variables <span class="math notranslate nohighlight">\(Y_i\)</span>, and as a consequence they follow a normal distribution. we have <span class="math notranslate nohighlight">\(\text{Var} (W) = \text{Var} (Q^T Y) = Q^T \text{Var} (Y) Q = \sigma^2 I\)</span>. Also, as <span class="math notranslate nohighlight">\(E[Y_i] = \mu - \mu = 0\)</span>, <span class="math notranslate nohighlight">\(W_i \sim N(0,\sigma^2)\)</span>. Finally, these variables <span class="math notranslate nohighlight">\(W_i\)</span> are independent of each other, as their covariance matrix is diagonal.</p>
<p>It holds that</p>
<div class="math notranslate nohighlight">
\[
e^T Y = \sum_i Y_i = \sum_i X_i - n \bar X = 0
\]</div>
<p>and as <span class="math notranslate nohighlight">\(\hat Q \hat Q^T = I\)</span>, we have that</p>
<div class="math notranslate nohighlight">
\[
Y^T Y = Y^T \hat Q \hat Q^T Y = Y^T Q Q^T Y + Y^T \frac{1}{\sqrt{n}} e \frac{1}{\sqrt{n}} e^T Y = Y^T Q Q^T Y = W^T W 
\]</div>
<p>Thus, as our statistic is given by a sum of squares of <span class="math notranslate nohighlight">\(n-1\)</span> independent standard normal random variables,</p>
<div class="math notranslate nohighlight">
\[
S^2 = \frac{1}{n-1} W^T W = \frac{1}{n-1} \sum_{i=1}^{n-1} W_i^2 , \quad \Rightarrow \quad T_{\sigma^2} = \frac{(n-1) S^2}{\sigma^2} = \sum_{i=1}^{n-1} \frac{W_i^2}{\sigma^2} \sim \chi^2_{n-1}
\]</div>
</div>
<div class="section" id="span-style-color-orange-distribution-of-the-statistic-for-the-population-mean-span">
<h3><span style="color:orange;">Distribution of the statistic for the population mean</span><a class="headerlink" href="#span-style-color-orange-distribution-of-the-statistic-for-the-population-mean-span" title="Permalink to this headline">#</a></h3>
<p>We wish to justify the distribution for the statistic we use to conduct inference on the population mean,</p>
<div class="math notranslate nohighlight">
\[
T_{\mu} = \frac{\bar X - \mu}{S/\sqrt{n}}
\]</div>
<p>We have that <span class="math notranslate nohighlight">\(\bar X \sim N(\mu , \sigma^2/n )\)</span>, and we can write</p>
<div class="math notranslate nohighlight">
\[
T_{\mu} = \frac{\displaystyle \frac{\bar X - \mu}{\sigma/\sqrt{n}}}{\displaystyle \sqrt{\frac{(n-1)S^2/\sigma^2}{n-1}}}
\]</div>
<p>which is a ratio of a standard normal random variable and the square root of a chi squared distribution with <span class="math notranslate nohighlight">\(n-1\)</span> degrees of freedom, implying that</p>
<div class="math notranslate nohighlight">
\[
T_{\mu} \sim t_{n-1}
\]</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="L0Intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Statistics II Course Book</p>
      </div>
    </a>
    <a class="right-next"
       href="L2HypTest.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span style="color:brown">Hypothesis testing on one population</span></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-contents-span"><span style="color:brown;">Contents</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-introduction-span"><span style="color:brown;">Introduction</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-goals-i-span"><span style="color:brown;">Goals (i)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-goals-ii-span"><span style="color:brown;">Goals (ii)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-keywords-in-statistics-and-statistical-inference-span"><span style="color:brown;">Keywords in statistics and statistical inference</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-point-estimators-span"><span style="color:brown;">Point estimators</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-selecting-a-good-point-estimator-span"><span style="color:brown;">Selecting a good point estimator</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-theoretical-properties-of-point-estimators-span"><span style="color:brown">Theoretical properties of point estimators</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-bias-of-an-estimator-span"><span style="color:brown">Bias of an estimator</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-efficiency-of-an-estimator-span"><span style="color:brown">Efficiency of an estimator</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-mean-squared-error-of-an-estimator-span"><span style="color:brown">Mean squared error of an estimator</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-red-exercise-span"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-red-exercise-solution-span"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-preparing-r-and-the-data-span"><span style="color:blue;">Preparing R and the data</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-based-on-selected-data-sets-span"><span style="color:blue;">Examples based on selected data sets</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-selecting-and-displaying-the-data-set-and-the-variable-of-interest-span"><span style="color:blue;">Selecting and displaying the data set and the variable of interest</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-summaries-for-the-sample-data-span"><span style="color:blue;">Summaries for the sample data</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-estimating-parameters-from-the-data-span"><span style="color:blue">Estimating parameters from the data</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-comparing-different-estimators-span"><span style="color:blue;">Comparing different estimators</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-green-questions-span"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-of-estimator-bias-span"><span style="color:blue;">Examples of estimator bias</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-examples-of-estimator-efficiency-span"><span style="color:blue;">Examples of estimator efficiency</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-defining-good-estimators-span"><span style="color:brown;">Defining good estimators</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-examples-of-estimators-with-good-properties-span"><span style="color:brown;">Examples of estimators with good properties</span></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-confidence-intervals-span"><span style="color:brown">Confidence intervals</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-definition-of-confidence-intervals-a-theoretical-example-span"><span style="color:brown">Definition of confidence intervals: a theoretical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-definition-of-confidence-intervals-numerical-example-span"><span style="color:blue;">Definition of confidence intervals: numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-definition-of-confidence-intervals-a-general-procedure-span"><span style="color:brown">Definition of confidence intervals: a general procedure</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-confidence-intervals-for-the-population-mean-span"><span style="color:brown">Confidence intervals for the population mean</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-central-limit-theorem-approximation-span"><span style="color:brown">Central limit theorem approximation</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-central-limit-theorem-approximation-numerical-example-span"><span style="color:blue;">Central limit theorem approximation. Numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-central-limit-theorem-approximation-for-the-population-proportion-span"><span style="color:brown">Central limit theorem approximation for the population proportion</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-population-proportion-numerical-example-span"><span style="color:blue;">Population proportion. Numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-normal-data-span"><span style="color:brown">Normal data</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-mean-of-normal-data-numerical-example-span"><span style="color:blue;">Mean of normal data. Numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-mean-of-normal-data-numerical-example-ii-span"><span style="color:blue;">Mean of normal data. Numerical example (ii)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-confidence-intervals-for-the-population-variance-span"><span style="color:brown">Confidence intervals for the population variance</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-variance-of-normal-data-numerical-example-span"><span style="color:blue;">Variance of normal data - Numerical example</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id18"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-blue-variance-of-normal-data-numerical-example-ii-span"><span style="color:blue;">Variance of normal data - Numerical example (ii)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19"><span style="color:green;">Questions</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-confidence-interval-length-and-sample-sizes-span"><span style="color:brown">Confidence interval length and sample sizes</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20"><span style="color:green;">Questions</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21"><span style="color:red">Exercise</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22"><span style="color:red">Exercise. Solution</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-brown-estimators-and-confidence-intervals-summary-span"><span style="color:brown">Estimators and confidence intervals. Summary</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-appendix-1-distributions-associated-to-the-normal-span"><span style="color:orange">Appendix 1: Distributions associated to the normal</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-the-chi-squared-distribution-span"><span style="color:orange">The chi squared distribution</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-the-student-t-distribution-span"><span style="color:orange">The Student t distribution</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-summary-of-statistics-for-these-distributions-span"><span style="color:orange">Summary of statistics for these distributions</span></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-graphical-representation-of-their-density-functions-span"><span style="color:orange;">Graphical representation of their density functions</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-appendix-2-justification-of-test-statistics-distributions-span"><span style="color:orange;">Appendix 2: Justification of test statistics distributions</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-distribution-of-the-statistic-for-the-population-variance-span"><span style="color:orange;">Distribution of the statistic for the population variance</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#span-style-color-orange-distribution-of-the-statistic-for-the-population-mean-span"><span style="color:orange;">Distribution of the statistic for the population mean</span></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Department of Statistics UC3M
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>